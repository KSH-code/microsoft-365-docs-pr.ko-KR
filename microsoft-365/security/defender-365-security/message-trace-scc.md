---
title: 보안 및 준수 센터의 메시지 추적
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: 3e64f99d-ac33-4aba-91c5-9cb4ca476803
ms.custom:
- seo-marvel-apr2020
description: 관리자는 보안 및 준수 센터에서 메시지 추적을 & 메시지에 대해 어떤 일이 벌어졌다는 것을 알 수 있습니다.
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: 78a7a2bda41f721b9e2084615b9eca1e70cf1f35
ms.sourcegitcommit: 956176ed7c8b8427fdc655abcd1709d86da9447e
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/23/2021
ms.locfileid: "51071319"
---
# <a name="message-trace-in-the-security--compliance-center"></a>보안 및 준수 센터의 메시지 추적

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]

**적용 대상**
- [Exchange Online Protection](exchange-online-protection-overview.md)
- [Office 365용 Microsoft Defender 플랜 1 및 플랜 2](defender-for-office-365.md)
- [Microsoft 365 Defender](../defender/microsoft-365-defender.md)

## <a name="message-trace-features"></a>메시지 추적 기능

보안 및 준수 & 메시지 추적은 Exchange Online 조직을 통과하는 전자 메일 메시지를 추적합니다. 서비스에서 메시지를 수신, 거부, 지연 또는 배달할지 여부를 확인할 수 있습니다. 또한 최종 상태에 도달하기 전에 메시지에 대해 수행된 작업도 보여 주며,

보안 및 준수 & 메시지 추적은 EAC(Exchange 관리 센터)에서 사용할 수 있는 원래 메시지 추적을 개선합니다. 메시지 추적의 정보를 사용하여 메시지에 대해 진행된 문제에 대한 사용자 질문에 효율적으로 답변하고, 메일 흐름 문제를 해결하고, 정책 변경의 유효성을 검사할 수 있습니다.

> [!NOTE]
>
> - 메시지 추적을 사용하려면 조직 관리, 규정 준수 관리 또는 Help Desk 역할 그룹의 구성원이 해야 합니다. 자세한 내용은 [보안 및 준수 센터의 사용 권한](permissions-in-the-security-and-compliance-center.md)을 참조하세요.
>
> - 결과에 표시되는 최대 메시지 수는 선택한 보고서 유형에 따라 다릅니다(자세한 [](#choose-report-type) 내용은 보고서 유형 선택 섹션 참조). Exchange Online PowerShell 또는 독립 실행형 EOP PowerShell의 [Get-HistoricalSearch](/powershell/module/exchange/get-historicalsearch) cmdlet은 결과에 모든 메시지를 반환합니다.

## <a name="open-message-trace"></a>메시지 추적 열기

1. 에서 보안 & 준수 센터를 열 수 <https://protection.office.com> 있습니다.

2. 메일 **흐름을 확장한** 다음 메시지 추적 **을 선택합니다.**

## <a name="message-trace-page"></a>메시지 추적 페이지

여기에서 추적 시작 단추를 클릭하여 새 기본 **추적을 시작할 수** 있습니다. 이렇게 하면 지난 2일 동안의 모든 보낸 사람 및 받는 사람에 대한 모든 메시지가 검색됩니다. 또는 사용 가능한 쿼리 범주에서 저장된 쿼리 중 하나를 사용하여 현재 쿼리를 실행하거나 자체 쿼리의 시작점으로 사용할 수 있습니다.

- **기본 쿼리:** Microsoft 365에서 제공하는 기본 제공 쿼리입니다.

- **사용자 지정 쿼리:** 향후 사용을 위해 조직의 관리자가 저장한 쿼리입니다.

- **자동 검색 쿼리:** 최근 10개가 실행된 쿼리입니다. 이 목록을 사용하면 벗어났을 때 쉽게 선택할 수 있습니다.

또한 이 페이지에는  제출한 요청에 대한 다운로드 가능한 보고서 섹션과 다운로드 가능한 보고서가 있는 경우 보고서 자체도 있습니다.

## <a name="options-for-a-new-message-trace"></a>새 메시지 추적에 대한 옵션

### <a name="filter-by-senders-and-recipients"></a>보낸 사람 및 받는 사람에 따라 필터링

기본값은 **모든** 보낸 사람 및 모든 받는 사람이지만 다음 필드를 사용하여 결과를 필터링할 수 있습니다.

- **사용자:** 이 필드를 클릭하여 조직에서 보낸 사람 한명 이상을 선택합니다. 또한 이름을 입력하기 시작하면 검색 페이지가 어떻게 행동하는지와 마찬가지로 목록의 항목이 입력한 항목별로 필터링됩니다.

- **받는 사람:** 이 필드를 클릭하여 조직에서 하나 이상의 받는 사람을 선택합니다.

> [!NOTE]
>
> - 외부 보낸 사람 및 받는 사람의 전자 메일 주소를 입력할 수도 있습니다. 와일드카드는 지원되지만(예: ) 같은 필드에 여러 와일드카드 항목을 동시에 사용할 `*@contoso.com` 수 없습니다.
>
> - 여러 보낸 사람 또는 받는 사람 목록을 세미코론()으로 구분하여 붙여넣을 수 `;` 있습니다. 공백( `\s` ), 캐리지 리턴( `\r` ) 또는 다음 `\n` 줄()을 반환합니다.

### <a name="time-range"></a>시간 범위

기본값은 **2일이지만** 날짜/시간 범위를 최대 90일로 지정할 수 있습니다. 날짜/시간 범위를 사용하는 경우 다음 문제를 고려합니다.

- 기본적으로 시간 줄을 사용하여 **슬라이더** 보기에서 시간 범위를 선택합니다. 표시되는 일 또는 시간 설정만 선택할 수 있습니다. 사이 값을 선택하려고 하면 시작/끝 거품이 가장 가까운 표시된 설정에 맞추게 됩니다.

  ![보안 및 준수 센터의 새 메시지 추적에 있는 & 시간 범위](../../media/55a9e9c1-f7d5-4047-b217-824e8b976bcb.png)

  그러나 시작 날짜 및  종료 날짜 값(시간 포함)을 지정할 수 있는 사용자 지정  보기로 전환할 수도 있으며, 날짜/시간 범위의 표준 시간대를 선택할 수도 있습니다.   표준 시간대 **설정은** 쿼리 입력과 쿼리 결과에 모두 적용됩니다.

  ![보안 및 준수 센터의 새 메시지 추적에 & 시간 범위](../../media/ed4c8d50-9ea5-4694-93f9-ee3ab6660b4f.png)

  10일 이하의 경우 결과를 요약 보고서로 즉시 사용할 **수** 있습니다. 10일보다 약간 더 큰 시간 범위를 지정하면 다운로드 가능한 CSV 파일(확장된 요약 또는 확장  보고서)로만  사용할 수 있는 결과가 지연됩니다.

  다양한 보고서 유형에 대한 자세한 내용은 이 문서의 보고서 유형 선택 [섹션을](#choose-report-type) 참조하십시오.

  > [!NOTE]
  > 향상된 요약 및 확장된 보고서는 보관된 메시지 추적 데이터를 사용하여 준비됩니다. 보고서를 다운로드할 수 있는 데 최대 몇 시간이 걸릴 수 있습니다. 동시에 보고서 요청을 제출한 다른 관리자의 수에 따라 대기 중인 요청에 대한 처리가 시작되기 전에 지연이 확인될 수도 있습니다.

- 쿼리를 **슬라이더** 보기에 저장하면 상대 시간 범위(예: 오늘부터 3일)가 절약됩니다. 쿼리를 **사용자** 지정 보기에 저장하면 절대 날짜/시간 범위가 저장됩니다(예: 2018-05-06 13:00 ~ 2018-05-08 18:00).

### <a name="more-search-options"></a>추가 검색 옵션

#### <a name="delivery-status"></a>배달 상태

기본값 모두를 **선택된** 그대로 두거나 다음 값 중 하나를 선택하여 결과를 필터링할 수 있습니다.

- **배달된** 메시지: 메시지가 의도한 대상에 배달된 경우

- **보류 중:** 메시지 배달을 시도하거나 다시 시도 중입니다.

- **확장:** 그룹의 개별 구성원에게 배달하기 전에 메일 그룹 받는 사람이 확장됩니다.

- **실패:** 메시지가 배달되지 않습니다.

- **Quarantined**: 메시지가 스팸, 대량 메일 또는 피싱으로 확인되었습니다. 자세한 내용은 [EOP에서 Quarantined email messages를 참조하세요.](quarantine-email-messages.md)

- **스팸으로 필터링:** 메시지가 스팸으로 식별되어 거부되거나 차단되었습니다(고지되지 않은 경우).

- **상태 확인:** 메시지는 최근에 Microsoft 365에서 수신했지만 다른 상태 데이터를 아직 사용할 수 없습니다. 몇 분 후에 다시 확인 합니다.

> [!NOTE]
> **Pending,** **Quarantined** 및 **Filter as spam** 값은 10일 미만의 검색에만 사용할 수 있습니다. 또한 실제 상태와 보고된 배달 상태 간에는 5~10분이 지연될 수 있습니다.

#### <a name="message-id"></a>메시지 ID

이 ID는 메시지 헤더의 **Message-ID:** 헤더 필드에 있는 인터넷 메시지 ID(클라이언트 ID라고도 합니다. 사용자는 이 값을 제공하여 특정 메시지를 조사할 수 있습니다.

이 값은 메시지 수명을 나타내는 상수입니다. Microsoft 365 또는 Exchange에서 만든 메시지의 경우 값은 형식입니다(앵글 `<GUID@ServerFQDN>` 괄호( \< \> ). 예를 들면 `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`와 같습니다. 다른 메시징 시스템에서는 다른 구문이나 값을 사용할 수 있습니다. 이 값은 고유해야 하지만 모든 전자 메일 시스템이 이 요구 사항을 엄격하게 따르는 것은 아닙니다. **Message-ID:** 헤더 필드가 존재하지 않는 경우 또는 외부 원본에서 들어오는 메시지에 대해 비어 있으면 임의의 값이 할당됩니다.

메시지 **ID를** 사용하여 결과를 필터링하는 경우 괄호를 포함하여 전체 문자열을 포함해야 합니다.

#### <a name="direction"></a>Direction

기본값 모두를 선택된 그대로 두거나  인바운드(조직의 받는 사람에게 보낸 메시지) 또는  아웃바운드(조직의 사용자가 보낸 메시지)를 선택하여 결과를 필터링할 수 있습니다. 

#### <a name="original-client-ip-address"></a>원래 클라이언트 IP 주소

클라이언트 IP 주소로 결과를 제출하여 많은 양의 스팸 또는 맬웨어를 전송하는 해킹된 컴퓨터를 조사할 수 있습니다. 메시지가 보낸 사람이 여러 명인 것 같지만 같은 컴퓨터에서 모든 메시지를 생성하고 있을 가능성이 습니다.

> [!NOTE]
> 클라이언트 IP 주소 정보는 10일 동안만 사용할 수  있으며 고급 요약  또는 확장 보고서(다운로드 가능한 CSV 파일)에서만 사용할 수 있습니다.

### <a name="choose-report-type"></a>보고서 유형 선택

사용 가능한 보고서 유형은 다음입니다.

- **요약:** 시간 범위가 10일 미만으로 추가 필터링 옵션이 필요 없는 경우 사용할 수 있습니다. 검색을 클릭한 직후에 결과를 사용할 수 **있습니다.** 보고서는 최대 20000개 결과를 반환합니다.

- **확장된** 요약 또는 **확장:** 이러한 보고서는 다운로드 가능한 CSV 파일로만 사용할 수 있으며 시간 범위에 관계없이 하나 이상의 필터링 옵션이 필요 **합니다.** 이러한 사용자에 의해 **,** 다음 사용자 또는 메시지 **ID**. 보낸 사람 또는 받는 사람에 대해 와일드카드를 사용할 수 \* 있습니다(예: @contoso.com). 고급 요약 보고서는 최대 50000개 결과를 반환합니다. Extended 보고서는 최대 1,000개 결과를 반환합니다.

> [!NOTE]
>
> - 향상된 요약 및 확장된 보고서는 보관된 메시지 추적 데이터를 사용하여 준비됩니다. 보고서를 다운로드할 수 있는 데 최대 몇 시간이 걸릴 수 있습니다. 동시에 보고서 요청을 제출한 다른 관리자의 수에 따라 대기 중인 요청이 처리되기 전에 지연이 확인될 수도 있습니다.
>
> - 날짜/시간 범위에 대해 고급 요약 또는 확장 보고서를 선택할 수 있는 반면 일반적으로 보관된 데이터의 최근 4시간은 이러한 두 가지 유형의 보고서에 아직 제공되지 않습니다.
>
> - 다운로드 가능한 보고서의 최대 크기는 500MB입니다. 다운로드 가능한 보고서가 500MB를 초과하면 Excel 또는 메모장에서 보고서를 열 수 없습니다.

다음을 클릭하면 선택한 필터링 옵션, 보고서의 고유한 제목(편집 가능) 제목 및 메시지 추적이 완료될 때 알림을 받는 전자 메일 주소(편집 가능하고 조직의 허용 도메인 중 하나에 있어야 합니다)가 나열되는 요약 페이지가 표시됩니다. 보고서 **준비를** 클릭하여 메시지 추적을 제출합니다. 기본 메시지 추적 **페이지에서** 다운로드 가능한 보고서 섹션에서 보고서의 **상태를 확인할 수** 있습니다.

다양한 보고서 유형에서 반환되는 정보에 대한 자세한 내용은 다음 섹션을 참조하세요.

## <a name="message-trace-results"></a>메시지 추적 결과

각 보고서 유형은 서로 다른 수준의 정보를 반환합니다. 다양한 보고서에서 사용할 수 있는 정보는 다음 섹션에 설명되어 있습니다.

### <a name="summary-report-output"></a>요약 보고서 출력

메시지 추적을 실행하고 나면 결과가 나열되고, 내선 날짜/시간(가장 최근에 먼저)별로 정렬됩니다.

![보안 및 준수 센터의 메시지 추적에 대한 & 보고서 결과](../../media/0664bafe-0b03-477b-b571-0b046ac8c977.png)

요약 보고서에는 다음 정보가 포함되어 있습니다.

- **날짜:** 구성된 UTC 표준 시간대를 사용하여 서비스에서 메시지를 받은 날짜 및 시간입니다.

- **보낸 사람**: 보낸 사람(별칭 도메인)의 *전자 메일* @ *주소입니다.*

- **받는** 사람: 받는 사람 또는 받는 사람의 전자 메일 주소입니다. 여러 받는 사람에게 보낸 메시지의 경우 받는 사람당 한 줄이 있습니다. 받는 사람이 메일 그룹, 동적 메일 그룹 또는 메일 사용이 가능한 보안 그룹인 경우 그룹이 첫 번째 받는 사람이 되거나 그룹의 각 구성원이 별도의 줄에 있습니다.

- **제목:** 메시지의 제목: 필드의 처음  256자입니다.

- **상태:** 이러한 값은 배달 상태 [섹션에 설명되어](#delivery-status) 있습니다.

기본적으로 처음 250개 결과가 로드되어 쉽게 사용할 수 있습니다. 아래로 스크롤하면 다음 결과 일괄 처리가 로드될 때 약간의 일시 중지가 있습니다. 스크롤하는 대신 모두 로드를  클릭하여 최대 10,000개까지 모든 결과를 로드할 수 있습니다.

열 헤더를 클릭하여 결과를 해당 열의 값에 따라 오차 또는 내선 순서로 정렬할 수 있습니다.

결과 **필터링을 클릭하여** 결과를 하나 이상의 열로 필터링할 수 있습니다.

결과 내보내기, 모든 결과 내보내기, 로드된 결과  내보내기 또는 선택한 내보내기 를 선택하여 하나 이상의 행을 선택한 후 결과를 내보낼 **수 있습니다.**

#### <a name="find-related-records-for-this-message"></a>이 메시지에 대한 관련 레코드 찾기

관련 메시지 레코드는 동일한 메시지 ID를 공유하는 레코드입니다. 두 사용자 간에 전송된 단일 메시지라도 여러 레코드를 생성할 수 있습니다. 메일 그룹 확장, 전달, 메일 흐름 규칙(전송 규칙) 등의 영향을 받는 경우 레코드 수가 증가합니다.

행의 확인란을 선택한 후 나타나는 관련 찾기 단추를 클릭하거나  기타 옵션 이 메시지에 대한  기타 관련 레코드 찾기를 선택하여 메시지에 대한 관련 레코드를 찾을 ![ 수 ](../../media/1ea52bbf-9d00-48ce-9362-307f7f6fb7fe.png) \> **있습니다.**

메시지 ID에 대한 자세한 내용은 이 문서 앞부분의 메시지 ID 섹션을 참조하십시오.

#### <a name="message-trace-details"></a>메시지 추적 세부 정보

요약 보고서 출력에서는 다음 방법 중 하나를 사용하여 메시지에 대한 세부 정보를 볼 수 있습니다.

- 행을 선택합니다. 확인란을 제외한 행의 아무 곳이나 클릭합니다.

- 행의 확인란을 선택하고 **추가 옵션 추가 메시지** 세부 정보 ![ 보기 ](../../media/1ea52bbf-9d00-48ce-9362-307f7f6fb7fe.png) \> **를 클릭합니다.**

   ![요약 보고서 메시지 추적 결과에서 행을 두 번 클릭한 후의 세부 정보 보안 & 준수 센터](../../media/e50ee7cd-810a-4c06-8b58-e56ffd7028d1.png)

메시지 추적 세부 정보에는 요약 보고서에 없는 다음과 같은 추가 정보가 포함되어 있습니다.

- **메시지 이벤트:** 이 섹션에는 서비스에서 메시지에 대해 수행한 작업을 분류하는 데 도움이 되는 분류가 포함되어 있습니다. **발생할 수 있는** 몇 가지 흥미로운 이벤트는 다음입니다.

  - **수신:** 서비스에서 메시지를 수신했습니다.

  - **보내기**: 서비스가 메시지를 보냈습니다.

  - **실패:** 메시지를 배달하지 못했습니다.

  - **배달:** 메시지가 사서함에 배달된 경우

  - **확장:** 메시지가 확장된 메일 그룹으로 전송됩니다.

  - **전송:** 콘텐츠 변환, 메시지 받는 사람 제한 또는 에이전트로 인하여 받는 사람이 전환된 메시지로 이동했습니다.

  - **지연:** 메시지 배달이 연기된 후 나중에 다시 시도할 수 있습니다.

  - **해결된 메시지:** Active Directory 검색을 기반으로 메시지가 새 받는 사람 주소로 리디렉션되었습니다. 이 경우 원본 받는 사람 주소가 메시지 추적에 별도의 행으로 표시되고 메시지의 최종 배달 상태가 표시됩니다.

  > [!NOTE]
  > 
  > - 배달되지 않은 메시지가 배달된 경우 메시지 추적에 여러 **Event** 항목이 생성됩니다.
  > 
  > - 이 목록은 전체 목록으로만 사용되지는 않습니다. 추가 이벤트에 대한 자세한 내용은 메시지 추적 로그의 이벤트 [유형을 참조하세요.](/Exchange/mail-flow/transport-logs/message-tracking#event-types-in-the-message-tracking-log) 이 링크는 Exchange Server(Exchange Server Exchange) 항목입니다.

- **추가 정보:** 이 섹션에는 다음과 같은 세부 정보가 포함되어 있습니다.

  - **메시지 ID:** 이 값은 이 문서 앞부분의 메시지 [ID](#message-id) 섹션에서 설명합니다. 예를 들면 `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`와 같습니다.

  - **메시지 크기**   첨부 파일 등을 비롯한 메시지 크기(KB)입니다.

  - **보낸 IP:** 메시지를 보낸 컴퓨터의 IP 주소입니다. Exchange Online에서 전송되는 아웃바운드 메시지의 경우 이 값은 비어 있습니다.

  - **TO IP:** 서비스에서 메시지를 배달하려고 시도한 IP 주소 또는 주소입니다. 메시지에 받는 사람이 여러 명인 경우 이러한 받는 사람이 표시됩니다. Exchange Online으로 전송되는 인바운드 메시지의 경우 이 값은 비어 있습니다.

### <a name="enhanced-summary-reports"></a>향상된 요약 보고서

사용 가능(완료) 향상된 요약 보고서는  다운로드 가능한 보고서 섹션의 시작 메시지 추적에서 사용할 수 있습니다. 보고서에서 사용할 수 있는 정보는 다음과 같습니다.

- **origin_timestamp**: 구성된 UTC 표준 시간대를 사용하여 서비스에서 메시지를 처음 수신한 날짜 및 <sup>*</sup> 시간입니다.

- **sender_address**: 보낸 사람 전자 메일 주소(*별칭* @ *도메인 )입니다.*

- **Recipient_status**: 받는 사람에게 메시지를 배달한 상태입니다. 메시지가 여러 받는 사람에게 전송된 경우 모든 받는 사람 및 각 받는 사람에 대한 해당 상태가 다음 형식으로 \<*email address*\> ## \<*status*\> 표시됩니다. 예시:

  - **##Receive 보내기란** 서비스에 의해 메시지가 수신되어 의도한 대상에 전송된 것일 수 있습니다.

  - **##Receive 실패는** 서비스에서 메시지를 받았지만 의도한 대상으로의 배달이 실패했다는 의미입니다.

  - **##Receive 배달은** 서비스에 의해 메시지가 수신되어 받는 사람의 사서함으로 배달된 것입니다.

- **message_subject**: 메시지의 제목 필드의 처음 256자입니다. 

- **total_bytes**: 첨부 파일을 포함하여 메시지의 크기(bytes)입니다.

- **message_id**: 이 값은 이 문서 앞부분의 메시지 [ID](#message-id) 섹션에서 설명합니다. 예를 들면 `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`와 같습니다.

- **network_message_id**: 순환 또는 메일 그룹 확장으로 인해 만들어질 수 있는 메시지의 모든 복사본에서 유지되는 고유한 메시지 ID 값입니다. 값의 예로는 를 들 수 `1341ac7b13fb42ab4d4408cf7f55890f` 있습니다.

- **original_client_ip**: 보낸 사람 클라이언트의 IP 주소입니다.

- **directionality:** 메시지가 조직에 전송된 인바운드 메시지(1)인지 또는 조직에서 보낸 아웃바운드 메시지(2)를 나타냅니다.

- **connector_id**: 원본 또는 대상 커넥터의 이름입니다. Exchange Online의 커넥터에 대한 자세한 내용은 [Office 365에서](/Exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/use-connectors-to-configure-mail-flow)커넥터를 사용하여 메일 흐름 구성을 참조하세요.

- **delivery_priority**: 메시지가 높음, 낮음 또는 보통 우선 순위로 <sup>*</sup>   **전송된지 여부입니다.**

<sup>*</sup> 이러한 속성은 고급 요약 보고서에서만 사용할 수 있습니다.

### <a name="extended-reports"></a>확장 보고서

사용 가능(완료) 확장 보고서는  메시지 추적 시작 부분의 다운로드 가능한 보고서 섹션에서 사용할 수 있습니다. 확장 요약 보고서의 모든 정보는 확장된 보고서에서 사용할 수 있습니다(확장된 보고서와 origin_timestamp **delivery_priority).** 다음 추가 정보는 확장 보고서에서만 사용할 수 있습니다.

- **client_ip**: 메시지를 전송한 전자 메일 서버 또는 메시징 클라이언트의 IP 주소입니다.

- **client_hostname**: 메시지를 전송한 전자 메일 서버 또는 메시징 클라이언트의 호스트 이름 또는 FQDN입니다.

- **server_ip**: 원본 또는 대상 서버의 IP 주소입니다.

- **server_hostname**: 대상 서버의 호스트 이름 또는 FQDN입니다.

- **source_context**: 원본 필드와 관련된 추가 **정보입니다.** 예시:

  - `Protocol Filter Agent`

  - `3489061114359050000`

- **source**: 이벤트를 담당하는 Exchange Online 구성 요소입니다. 예시:

  - `AGENT`

  - `MAILBOXRULE`

  - `SMTP`

- **event_id**: 이 메시지에 대한 관련 레코드 찾기 섹션에 설명된 **Message** 이벤트 [값에 해당합니다.](#find-related-records-for-this-message)

- **internal_message_id**: 현재 메시지를 처리 중인 Exchange Online 서버에서 할당한 메시지 식별자입니다.

- **recipient_address**: 메시지 받는 사람의 전자 메일 주소입니다. 전자 메일 주소가 여러 개인 경우 세미콜론(;)으로 구분합니다.

- **recipient_count**: 메시지의 총 받는 사람 수입니다.

- **related_recipient_address**: , 및 이벤트와 함께 메시지와 연결된 다른 받는 사람 전자 메일 주소를 표시하는 데 `EXPAND` `REDIRECT` `RESOLVE` 사용됩니다.

- **reference**: 이 필드에는 특정 유형의 이벤트에 대한 추가 정보가 포함되어 있습니다. 예시:

  - **DSN:** 이 이벤트 이후에 DSN이 생성된 경우 연결된 배달 상태 알림의 message_id 값(DSN, 배달하지 않은 보고서, NDR 또는 반송 메시지라고도 알려지기)의 보고서 링크가 들어 있습니다.  DSN 메시지인 경우 이 필드에는  DSN이 message_id 원래 메시지의 message_id 값이 들어 있습니다.

  - **EXPAND**: 관련 **related_recipient_address** 값 포함

  - **RECEIVE**: 받은 **편지함 message_id** 같은 다른 프로세스에서 메시지를 생성한 경우 관련 메시지의 message_id 값을 포함할 수 있습니다.

  - **SEND**: DSN **internal_message_id** 값 포함

  - **TRANSFER**:  internal_message_id 변환, 메시지 받는 사람 제한 또는 에이전트와 같은 포크되는 메시지의 값입니다.

  - **MAILBOXRULE**:  internal_message_id 인바운드 메시지를 생성하는 인바운드 메시지의 값입니다.

    다른 유형의 이벤트의 경우 일반적으로 이 필드는 비어 있습니다.

- **return_path**: 메시지를 보낸 **MAIL FROM** 명령으로 지정된 반환 전자 메일 주소입니다. 이 필드는 비어 있는 것이 아니라 로 나타내는 null 보낸 사람 주소 값을 사용할 수 `<>` 있습니다.

- **message_info**: 메시지에 대한 추가 정보입니다. 예시:

  - 메시지 발신 날짜-시간(UTC for `DELIVER` and `SEND` events)입니다. 원본 날짜-시간은 메시지가 Exchange Online 조직에 처음 들어온 시간입니다. UTC 날짜-시간은 ISO 8601 날짜-시간 형식으로 표시됩니다. 여기서 = 년, = 월, 일은 시간 구성 요소의 시작을 `yyyy-mm-ddThh:mm:ss.fffZ` 나타내며, 시간, = 분, = 초, = 초의 분수 및 UTC를 나타내는 또 다른 `yyyy` `mm` `dd` `T` `hh` `mm` `ss` `fff` `Z` `Zulu` 방법인 을 나타냅니다.

  - 인증 오류입니다. 예를 들어 인증 오류가 발생할 때 사용된 인증의 값과 유형이 표시될 `11a` 수 있습니다.

- **tenant_id**: Exchange Online 조직(예: )을 나타내는 GUID `39238e87-b5ab-4ef6-a559-af54c6b07b42` 값입니다.

- **original_server_ip**: 원본 서버의 IP 주소입니다.

- **custom_data**: 특정 이벤트 유형과 관련된 데이터가 들어 있습니다. 자세한 내용은 다음 섹션을 참조하세요.

#### <a name="custom_data-values"></a>custom_data 값

**이벤트의** custom_data 필드는 다양한 Exchange Online 에이전트가 메시지 처리 세부 정보를 `AGENTINFO` 기록하는 데 사용됩니다. 다음 섹션에서는 좀 더 흥미로운 에이전트에 대해 설명합니다.

#### <a name="spam-filter-agent"></a>스팸 필터 에이전트

시작 **custom_data** 스팸 필터 에이전트의 `S:SFA` 값입니다. 다음 표에는 주요 세부 정보가 설명되어 있습니다.

****

|값|설명|
|---|---|
|`SFV=NSPM`|메시지가 스팸이 아닌 것으로 표시되었으며 받는 사람에게 전송되었습니다.|
|`SFV=SPM`|메시지가 스팸 방지 필터링(콘텐츠 필터링)에 의해 스팸으로 표시되었습니다.|
|`SFV=BLK`|수신 거부된 보낸 사람이 보낸 메시지이므로 필터링을 건너뛰었으며 메시지가 차단되었습니다.|
|`SFV=SKS`|스팸 방지 필터링에서 처리하기 전에 메시지가 스팸으로 표시되었습니다. 메일 흐름 규칙(전송 규칙이라고도 함)과 일치하여 스팸으로 자동 표시되고 모든 추가 필터링을 무시하는 메시지가 여기에 포함됩니다.|
|`SCL=<number>`|다양한 SCL 값 및 해당 값의 의미에 대한 자세한 내용은 스팸 지수 [를 참조하세요.](spam-confidence-levels.md)|
|`PCL=<number>`|메시지의 PCL(피싱 지수) 값입니다. 이러한 값은 스팸 지수 에 설명된 SCL 값과 동일한 [방식으로 해석될 수 있습니다.](spam-confidence-levels.md)|
|`DI=SB`|메시지의 보낸 사람이 차단되었습니다.|
|`DI=SQ`|메시지가 격리되었습니다.|
|`DI=SD`|메시지가 삭제되었습니다.|
|`DI=SJ`|메시지가 받는 사람의 정크 메일 폴더로 전송되었습니다.|
|`DI=SN`|메시지가 일반 아웃바운드 배달 풀을 통해 라우팅되었습니다.|
|`DI=SO`|메시지가 위험 수준이 높은 배달 풀을 통해 라우팅되었습니다. 자세한 내용은 [아웃바운드 메시지의 고위험 전송 풀](high-risk-delivery-pool-for-outbound-messages.md)을 참조하세요.|
|`SFS=[a]|SFS=[b]`|스팸 규칙이 일치했음을 나타냅니다.|
|`IPV=CAL`|연결 필터의 IP 허용 목록에 IP 주소가 지정되어 있어 메시지가 스팸 필터를 통과하도록 허용되었습니다.|
|`H=<EHLOstring>`|연결 전자 메일 서버의 HELO 또는 EHLO 문자열입니다.|
|`PTR=<ReverseDNS>`|보내는 IP 주소의 PTR 레코드로, 역방향 DNS 주소라고도 합니다.|
|

스팸으로 **custom_data** 메시지의 값을 다음과 같이 설정하는 예는 다음과 같습니다.

`S:SFA=SUM|SFV=SPM|IPV=CAL|SRV=BULK|SFS=470454002|SFS=349001|SCL=9|SCORE=-1|LIST=0|DI=SN|RD=ftmail.inc.com|H=ftmail.inc.com|CIP=98.129.140.74|SFP=1501|ASF=1|CTRY=US|CLTCTRY=|LANG=en|LAT=287|LAT=260|LAT=18;`

#### <a name="malware-filter-agent"></a>맬웨어 필터 에이전트

시작 **custom_data** 맬웨어 필터 `S:AMA` 에이전트의 값입니다. 다음 표에는 주요 세부 정보가 설명되어 있습니다.

****

|값|설명|
|---|---|
|`AMA=SUM|v=1|` 또는 `AMA=EV|v=1`|메시지에 맬웨어가 포함된 것으로 확인되었습니다. `SUM` 은 맬웨어를 검색할 수 있는 엔진 수를 나타냅니다. `EV` 맬웨어가 특정 엔진에 의해 검색된 것일 수 있습니다. 맬웨어가 엔진에서 검색되면 후속 작업이 트리거됩니다.|
|`Action=r`|메시지가 대체되었습니다.|
|`Action=p`|메시지가 무시되었습니다.|
|`Action=d`|메시지가 지연되었습니다.|
|`Action=s`|메시지가 삭제되었습니다.|
|`Action=st`|메시지가 무시되었습니다.|
|`Action=sy`|메시지가 무시되었습니다.|
|`Action=ni`|메시지가 거부되었습니다.|
|`Action=ne`|메시지가 거부되었습니다.|
|`Action=b`|메시지가 차단되었습니다.|
|`Name=<malware>`|검색된 맬웨어의 이름입니다.|
|`File=<filename>`|맬웨어가 포함된 파일의 이름입니다.|
|

**맬웨어가 custom_data** 메시지의 값에 대한 예는 다음과 같습니다.

`S:AMA=SUM|v=1|action=b|error=|atch=1;S:AMA=EV|engine=M|v=1|sig=1.155.974.0|name=DOS/Test_File|file=filename;S:AMA=EV|engine=A|v=1|sig=201707282038|name=Test_File|file=filename`

#### <a name="transport-rule-agent"></a>전송 규칙 에이전트

시작 **custom_data** 값은 메일 흐름 규칙(전송 규칙)에 대한 전송 규칙 `S:TRA` 에이전트의 값입니다. 다음 표에는 주요 세부 정보가 설명되어 있습니다.

****

|값|설명|
|---|---|
|`ETR|ruleId=<guid>`|일치된 규칙 ID입니다.|
|`St=<datetime>`|규칙 일치가 발생한 날짜 및 시간(UTC)입니다.|
|`Action=<ActionDefinition>`|적용된 작업입니다. 사용 가능한 작업 목록은 [Exchange Online의 메일 흐름 규칙 작업을 참조하세요.](/exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)|
|`Mode=<Mode>`|규칙의 모드입니다. 유효한 값은 다음과 같습니다.<ul><li>**적용**: 규칙에 대한 모든 작업이 적용됩니다.</li><li>**정책 팁을 통해 테스트:** 모든 정책 팁 작업이 전송되지만 다른 적용 작업은 실행되지 않습니다.</li><li>**정책 팁이** 없는 테스트: 작업이 로그 파일에 나열되지만 보낸 사람이 어떤 식으로도 알림을 보내지 않고 적용 작업이 실행되지 않습니다.</li></ul>|
|

메일 **custom_data** 조건과 일치하는 메시지의 값을 설정하는 예는 다음과 같습니다.

`S:TRA=ETR|ruleId=19a25eb2-3e43-4896-ad9e-47b6c359779d|st=7/17/2017 12:31:25 AM|action=ApplyHtmlDisclaimer|sev=1|mode=Enforce`