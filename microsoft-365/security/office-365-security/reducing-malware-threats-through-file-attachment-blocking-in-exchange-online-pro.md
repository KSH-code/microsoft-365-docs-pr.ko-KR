---
title: 메일 흐름 규칙을 사용하여 실행 가능한 첨부 파일이 있는 메시지 차단
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: 관리자는 메일 흐름 규칙(전송 규칙)을 만들어 실행 파일이 포함된 메시지를 차단하는 방법을 배울 수 있습니다.
ms.openlocfilehash: 4552cb76238ad995bab04a9ac50873bc22115ce4
ms.sourcegitcommit: ee39faf3507d0edc9497117b3b2854955c959c6c
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/10/2020
ms.locfileid: "49615915"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>메일 흐름 규칙을 사용하여 EOP에서 실행 파일이 첨부된 메시지 차단

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


Exchange Online 사서함이 없는 Microsoft 365 조직 또는 Exchange Online 사서함이 없는 독립 실행형 EOP(Exchange Online Protection) 조직에서 EOP는 맬웨어 방지 정책을 사용하여 실행 파일이 첨부된 메시지를 포함하여 유해한 메시지를 차단합니다. 자세한 내용은 [EOP의 맬웨어 방지 보호 기능을 참조하세요.](anti-malware-protection.md)

보호를 강화하기 위해 이 항목에 설명된 바와 같이 메일 흐름 규칙(전송 규칙)을 사용하여 실행 파일이 포함된 메시지를 식별하고 차단할 수 있습니다.

예를 들어 맬웨어가 발생하면 영향을 받는 사용자가 지정된 시간 후에 첨부 파일을 다시 보낼 수 있도록 회사에서 시간 제한을 사용하여 이 규칙을 적용할 수 있습니다.

## <a name="what-do-you-need-to-know-before-you-begin"></a>시작하기 전에 알아야 할 내용은 무엇인가요?

- 다음 절차를 수행하려면 먼저 사용 권한을 할당해야 합니다.

  - Exchange Online에서 Exchange Online의 기능 사용 권한에서 "메일 흐름" [항목을 참조하세요.](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions)

  - 독립 실행형 EOP에는 기본적으로 OrganizationManagement, ComplianceManagement 및 RecordsManagement 역할에 할당되는 전송 규칙 역할이 필요합니다. 자세한 내용은 독립 실행형 [EOP의](feature-permissions-in-eop.md) 사용 권한을 참조하고 EAC를 사용하여 역할 그룹의 구성원 목록을 [수정합니다.](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- Exchange Online에서 EAC를 열하려면 [Exchange Online의 Exchange 관리 센터를 참조하세요.](https://docs.microsoft.com/Exchange/exchange-admin-center) 독립 실행형 EOP에서 EAC를 열하려면 독립 실행형 [EOP의 Exchange 관리 센터를 참조하세요.](exchange-admin-center-in-exchange-online-protection-eop.md)

- Exchange Online PowerShell에 연결하려면 [Exchange Online PowerShell에 연결](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)을 참조하세요. 독립 실행형 EOP PowerShell에 연결하려면 [Exchange Online Protection PowerShell에 연결](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell)을 참조하세요.

- Exchange Online 및 독립 실행형 EOP의 메일 흐름 규칙에 대한 자세한 내용은 다음 항목을 참조하세요.

  - [Exchange Online의 메일 흐름 규칙(전송 규칙)](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Exchange Online의 메일 흐름 규칙 조건 및 예외(조건자)](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Exchange Online의 메일 흐름 규칙 작업](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>EAC를 사용하여 실행 파일이 첨부된 메시지를 차단하는 규칙 만들기

1. EAC에서 **메일 흐름** \> **규칙** 으로 이동합니다.

2. 추가 **아이콘을** 클릭한 다음 새 규칙 ![ ](../../media/ITPro-EAC-AddIcon.png) **만들기를 선택합니다.**

3. 새 **규칙** 페이지가 열리면 다음 설정을 구성합니다.

   - **이름:** 규칙에 대해 설명하는 고유한 이름을 입력합니다.

   - 다른 **옵션을 클릭합니다.**

   - **다음의 경우 이 규칙을 적용합니다.** 첨부 **파일 선택에** \> **실행 가능한 콘텐츠가 있습니다.**

   - **다음을 수행하십시오.** **메시지** 차단을 선택하고 원하는 작업을 선택합니다.

     - **메시지를 거부하고** 설명 포함:  거부 이유 지정 대화 상자가 나타나면 배달되지 않는 보고서(NDR 또는 반송 메시지라고도 합니다)에 표시하려는 텍스트를 입력합니다. 사용되는 기본 확장 상태 코드는 5.7.1입니다.

     - **확장 상태** 코드가 있는 메시지를 거부합니다. 확장 상태 코드 입력 대화 상자가 나타나면 NDR에 표시하려는 확장 상태 코드를 입력합니다.  유효한 값은 5.7.1 또는 5.7.900에서 5.7.999까지의 값입니다. 기본 거부 텍스트는 배달이 승인되지 않은 경우 메시지가 거부됩니다.

     - **누구에게도 알리지 않고 메시지 거부**

4. 작업을 마쳤으면 **저장** 을 클릭합니다. 이제 첨부 파일 차단 규칙이 적용됩니다.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>PowerShell을 사용하여 실행 가능한 첨부 파일이 있는 메시지를 차단하는 규칙 만들기

다음 구문을 사용하여 실행 파일이 포함된 메시지를 차단하는 규칙을 만들 수 있습니다.

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**참고**:

- _RejectMessageEnhancedStatusCode_ 매개 변수를 _RejectMessageReasonText_ 매개 변수 없이 사용하는 경우 기본 텍스트는 배달 권한이 부여되지 않고 메시지가 거부됩니다.

- RejectMessageEnhancedStatusCode 매개 변수 없이 _RejectMessageReasonText_ 매개 변수를 사용하는 경우 기본 코드는 5.7.1입니다. 

이 예에서는 실행 파일이 포함된 메시지를 자동으로 삭제하는 Block Executable Attachments라는 새 규칙을 만듭니다.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

자세한 구문 및 매개변수 정보 [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule)을 참조하세요.

## <a name="how-do-you-know-this-worked"></a>작동 여부는 어떻게 확인하나요?

실행 가능한 첨부 파일이 포함된 메시지를 차단하는 메일 흐름 규칙을 성공적으로 만들 수 있는지 확인하기 위해 다음 단계를 수행합니다.

- EAC에서 메일 흐름 **규칙으로** 이동하여 편집 아이콘을 클릭하는 규칙을 선택하고 \>  \> 설정을 \>  ![ ](../../media/ITPro-EAC-EditIcon.png) 확인합니다.

- PowerShell에서 다음 명령을 실행하여 설정을 확인합니다.

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
