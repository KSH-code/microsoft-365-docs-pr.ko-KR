---
title: 악용 방지 사용자 지정
keywords: Exploit Protection, 완화, 사용, powershell, dep, cfg, emet, aslr
description: 앱 또는 PowerShell을 사용하여 악용 방지에 사용되는 특정 완화를 Windows 보안 수 있습니다. 또한 완화를 감사하고 구성을 내보낼 수 있습니다.
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.localizationpriority: medium
audience: ITPro
ms.topic: conceptual
author: dansimp
ms.author: dansimp
ms.reviewer: ''
manager: dansimp
ms.technology: mde
ms.collection: M365-security-compliance
ms.openlocfilehash: bc0bec7423c7bbb462bd4278bb58369f4f575e2a
ms.sourcegitcommit: d4b867e37bf741528ded7fb289e4f6847228d2c5
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2021
ms.locfileid: "60150273"
---
# <a name="customize-exploit-protection"></a>악용 방지 사용자 지정

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


**적용 대상:**
- [엔드포인트용 Microsoft Defender](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> Endpoint용 Defender를 경험하고 싶나요? [무료 평가판을 신청하세요.](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-assignaccess-abovefoldlink)

Exploit Protection은 운영 체제 프로세스와 개별 앱 모두에 다양한 악용 완화 기술을 자동으로 적용합니다.

개별 장치에서 Windows 보안 앱을 사용하여 이러한 설정을 구성합니다. 그런 다음 다른 장치에 배포할 수 있도록 구성을 XML 파일로 내보낼 수 있습니다. 그룹 정책을 사용하여 XML 파일을 여러 장치에 동시에 배포합니다. PowerShell을 사용하여 완화를 구성할 수 있습니다.

이 문서에는 Exploit Protection에서 사용할 수 있는 각 완화가 나열됩니다. 이는 완화를 시스템 전체에 적용할 수 있는지 개별 앱에 적용할 수 있는지를 나타내고 완화가 작동하는 방식에 대한 간략한 설명을 제공합니다.

또한 Windows 보안, PowerShell 및 MDM(모바일 장치 관리) CSP(구성 서비스 공급자)를 사용하여 완화를 사용하도록 설정하거나 구성하는 방법도 설명하고 있습니다. 이 단계는 네트워크를 통해 배포할 수 있는 구성을 만드는 첫 번째 단계입니다. 다음 단계에서는 구성을 [생성, 내보내기, 가져오기](import-export-exploit-protection-emet-xml.md)및 여러 장치에 배포합니다.

> [!WARNING]
> 일부 보안 완화 기술에는 일부 애플리케이션과의 호환성 문제가 있을 수 있습니다. 프로덕션 환경 또는 네트워크의 나머지 부분에 구성을 배포하기 전에 [감사 모드](evaluate-exploit-protection.md)를 사용하여 모든 대상 사용 시나리오에서 악용 방지 기능을 테스트해야 합니다.

## <a name="exploit-protection-mitigations"></a>Exploit Protection 완화

개별 앱에 대해 모든 완화를 구성할 수 있습니다. 일부 완화는 운영 체제 수준에서도 적용할 수 있습니다.

각 완화를 설정하거나 해제하거나 기본값으로 설정할 수 있습니다. 일부 완화에는 표의 설명에 표시된 추가 옵션이 있습니다.

기본값은 각 완화에 대한 기본  옵션 사용 옵션에서 항상 대괄호로 지정됩니다. 다음 예제에서 데이터 실행 방지의 기본값은 "On"입니다.

각 **완화 설정에** 기본 구성 사용은 가정용 사용자의 일상적인 사용에 대한 기본 보호 수준에 대한 권장을 나타냅니다. Enterprise 배포는 개별 요구에 필요한 보호를 고려해야 하며 기본값에서 구성을 수정해야 할 수 있습니다.

각 완화에 대해 연결된 PowerShell cmdlet에 대한 자세한 내용은 이 문서 아래쪽의 [PowerShell](#cmdlets-table) 참조 테이블을 참조하세요.

|완화|설명|적용할 수 있습니다.|사용 가능한 감사 모드|
|---|---|---|---|
|CFG(제어 흐름 보호)|간접 통화에 대한 제어 흐름 무결성을 보장합니다. 선택적으로 내보내기 기능을 표시하지 말고 엄격한 CFG를 사용할 수 있습니다.|시스템 및 앱 수준|아니요|
|데이터 실행 방지(DEP)|힙 및 스택과 같은 데이터 전용 메모리 페이지에서 코드를 실행할 수 없습니다. 32비트(x86) 앱에 대해 구성할 수 있으며 다른 모든 아키텍처에 대해 영구적으로 사용하도록 설정됩니다. 선택적으로 ATL unk 에뮬ation을 사용하도록 설정할 수 있습니다.|시스템 및 앱 수준|아니요|
|이미지에 대한 강제 임의 지정(필수 ASLR)|/DYNAMICBASE로 컴파일되지 않은 이미지를 강요하여 재배치합니다. 필요한 경우 재배치 정보가 없는 이미지 로드에 실패할 수 있습니다.|시스템 및 앱 수준|아니요|
|메모리 할당 임의 지정(상향식 ASLR)|가상 메모리 할당의 위치를 임의로 할당합니다. 여기에는 시스템 구조 힙, 스택, TEB 및 PEB가 포함됩니다. 선택적으로 64비트 프로세스에 대해 더 광범위한 임의 지정을 사용할 수 있습니다.|시스템 및 앱 수준|아니요|
|예외 체인 확인(SEHOP)|예외 디스패치 중에 예외 체인의 무결성을 보장합니다. 32비트(x86) 응용 프로그램에만 구성할 수 있습니다.|시스템 및 앱 수준|아니요|
|힙 무결성 확인|힙 손상이 감지되면 프로세스를 종료합니다.|시스템 및 앱 수준|아니요|
|임의 코드 가드(ACG)|이미지로 백업되지 않은 실행 코드가 도입되지 않도록 방지하고 코드 페이지가 수정되지 않도록 합니다. 선택적으로 스레드 옵트아웃을 허용하고 원격 다운그레이드를 허용할 수 있습니다(PowerShell에서만 구성 가능).|앱 수준만|예|
|낮은 무결성 이미지 차단|낮은 무결성으로 표시된 이미지의 로드를 방지합니다.|앱 수준만|예|
|원격 이미지 차단|원격 장치에서 이미지 로드를 방지합니다.|앱 수준만|아니요|
|신뢰할 수 없는 글꼴 차단|시스템 글꼴 디렉터리에 설치되지 않은 GDI 기반 글꼴(특히 웹의 글꼴)을 로드할 수 없습니다.|앱 수준만|예|
|코드 무결성 가드|Microsoft, WHQL 이상에서 서명한 이미지의 로드를 제한합니다. 선택적으로 서명된 이미지를 Microsoft Store 수 있습니다.|앱 수준만|예|
|확장 지점 사용 안 함|AppInit DLL, 창 후크 및 Winsock 서비스 공급자와 같은 모든 프로세스에 DLL 삽입을 허용하는 다양한 extensibility 메커니즘을 사용하지 않도록 합니다.|앱 수준만|아니요|
|Win32k 시스템 호출 사용 안 함|앱에서 Win32k 시스템 호출 테이블을 사용하지 못하게 합니다.|앱 수준만|예|
|자식 프로세스를 허용하지 않습니다.|앱에서 자식 프로세스를 만들 수 없습니다.|앱 수준만|예|
|주소 필터링 내보내기(EAF)|악성 코드로 해결되는 위험한 작업을 검색합니다. 선택적으로 악용에 일반적으로 사용되는 모듈의 액세스 유효성을 검사할 수 있습니다.|앱 수준만|예|
|주소 필터링 가져오기(IAF)|악성 코드로 해결되는 위험한 작업을 검색합니다.|앱 수준만|예|
|실행 시뮬레이션(SimExec)|중요한 API에 대한 호출이 합법적인 호출자에 반환되도록 합니다. 32비트(x86) 응용 프로그램에만 구성할 수 있습니다. ACG와 호환되지 않습니다.|앱 수준만|예|
|API 호출 확인(CallerCheck)|중요한 API가 합법적인 호출자에 의해 호출되도록 합니다. 32비트(x86) 응용 프로그램에만 구성할 수 있습니다. ACG와 호환되지 않습니다.|앱 수준만|예|
|핸들 사용 확인|잘못된 핸들 참조에서 예외가 발생합니다.|앱 수준만|아니요|
|이미지 종속성 무결성 확인|이미지 종속성 로드에 Windows 코드 서명을 적용합니다.|앱 수준만|아니요|
|스택 무결성 확인(StackPivot)|스택이 중요한 API에 대해 리디렉션되지 않은지 확인 ACG와 호환되지 않습니다.|앱 수준만|예|

> [!IMPORTANT]
> 프로그램 설정 섹션에  앱을 추가하고 여기에 개별 완화 설정을 구성하면 시스템 설정 섹션에 지정된 동일한 완화에 대한 구성 위에 앱이 **적용됩니다.** 다음 행렬과 예제는 기본값의 작동 방법을 보여 주는 데 도움이 됩니다.
>
>
> |프로그램 **설정에서 사용**|시스템 **설정에서 사용**|동작|
> |---|---|---|
> |예|아니요|프로그램 **설정에 정의된 경우**|
> |예|예|프로그램 **설정에 정의된 경우**|
> |아니요|예|시스템 **설정에 정의된 경우**|
> |아니요|예|기본 옵션 **사용에 정의된 기본값**|
>
>
> - **예 1**
>
>    Mikael은 시스템 설정 섹션에서 **DEP(데이터** 실행 방지)를 기본적으로 해제로 **구성합니다.** 
>
>    그런 다음 Mikael은 프로그램 설정 *섹션에* test.exe **앱을 추가합니다.** 해당 앱에 대한 **옵션에서 DEP(데이터** 실행 방지)에서 시스템 설정 다시 적용 옵션을 활성화하고 스위치를 켜기 로 **설정합니다.**  프로그램 설정 섹션에는 다른 **앱이 나열되지** 않습니다.
>
>    결과적으로 DEP만 에 대해 *test.exe.* 다른 모든 앱에는 DEP가 적용되지 않습니다.
>
>
> - **예 2**
>
>    Josie는 시스템 설정 섹션에서 **DEP(데이터** 실행 방지)를 기본적으로 해제로 **구성합니다.** 
>
>    그런 다음 Josie는 프로그램 설정test.exe앱 *앱을* **추가합니다.** 해당 앱에 대한 **옵션에서 DEP(데이터** 실행 방지)에서 시스템 설정 다시 설정 옵션을 활성화하고 스위치를 켜기 로 **설정합니다.** 
>
>    또한 Josie는 프로그램  설정 섹션에 miles.exe추가하고 **에 CFG(제어** 흐름 보호)를 **구성합니다.** DeP 또는 해당  앱에 대한 기타 완화에 대해 시스템 설정 다시 적용 옵션을 사용하도록 설정하지 않습니다.
>
>    결과적으로 에 대해 DEP가 *활성화됩니다test.exe.* DEP는 를 비롯한 다른 앱에 대해 *miles.exe.* CFG는 에 대해 *miles.exe.*

> [!NOTE]
> 이 문서에서 문제가 발견된 경우 Windows Server/Windows 클라이언트 파트너에게 직접 보고하거나 해당 국가의 Microsoft 기술 지원 번호를 사용할 수 있습니다.

### <a name="configure-system-level-mitigations-with-the-windows-security-app"></a>앱으로 시스템 수준 완화 Windows 보안 구성

1. 작업 표시줄에서 방패 아이콘을 선택하거나 **Defender의** 시작 메뉴를 검색하여 Windows 보안 앱을 열 수 있습니다.

2. App & **브라우저** 컨트롤 타일(또는 왼쪽 메뉴 표시줄의 앱 아이콘)을 선택한 다음 **Exploit Protection을 선택합니다.**

3. 시스템 **설정 섹션에서** 구성할 완화를 찾아 다음 중 하나를 선택합니다. 프로그램 설정 섹션에서 개별적으로 구성되지  않은 앱은 여기에 구성된 설정을 사용합니다.
   - **기본적으로 설정** - 이 완화가  앱 관련 프로그램 설정 섹션에 설정되지 않은 앱에 대해 완화가 **사용하도록 설정됩니다.**
   - **기본적으로 해제** - 앱 관련  프로그램 설정 섹션에서 이 완화가 설정되지 않은 앱에 대해 완화가 사용되지 **않도록 설정됩니다.**
   - **default** 사용 - 설치 시 설정한 기본 구성에 따라 완화가 사용되거나 Windows 10 있습니다. 기본값(**설정** 또는 해제)은 항상  각 완화에 대해 기본 레이블 사용 옆에 지정됩니다.

   > [!NOTE]
   > 일부 설정을 변경할 때 사용자 계정 컨트롤 창이 표시될 수 있습니다. 관리자 자격 증명을 입력하여 설정을 적용합니다.

   일부 설정을 변경하려면 다시 시작해야 할 수 있습니다.

4. 구성하려는 모든 시스템 수준 완화에 대해 이 작업을 반복합니다.

5. 프로그램 설정 **섹션으로 이동하여** 완화를 적용할 앱을 선택합니다.

   1. 구성할 앱이 이미 나열되어 있는 경우 해당 앱을 선택하고 **편집을 선택합니다.**
   2. 앱이 목록에 없는 경우 목록 맨 위에 있는  프로그램 추가를 선택하여 사용자 지정한 다음 앱을 추가할 방법을 선택합니다.
      - 프로그램 **이름으로 추가를** 사용하여 해당 이름을 사용하여 실행 중인 모든 프로세스에 완화를 적용합니다. 확장명을 사용하여 파일을 지정해야 합니다. 전체 경로를 입력하여 완화를 해당 위치에 있는 해당 이름의 앱으로만 제한할 수 있습니다.
      - 정확한 **파일 경로** 선택을 사용하여 표준 Windows 파일 선택기 창을 사용하여 원하는 파일을 찾아 선택합니다.

6. 앱을 선택하면 적용할 수 있는 모든 완화 목록이 표시됩니다. 완화를 사용하도록 설정하려면 확인란을 선택한 다음 슬라이더를 으로 **변경합니다.** 추가 옵션을 선택합니다. 감사를 **선택하면** 감사 모드에서만 완화가 적용됩니다. 프로세스 또는 앱을 다시 시작해야 하는 경우 또는 앱을 다시 시작해야 하는 경우 알림을 Windows.

7. 구성할 모든 앱 및 완화에 대해 이 단계를 반복합니다. 구성 **설정을** 완료하면 적용을 선택합니다.

이제 이러한 설정을 [XML](import-export-exploit-protection-emet-xml.md) 파일로 내보내거나 앱별 완화 구성을 계속할 수 있습니다.

구성을 XML 파일로 내보내면 한 장치에서 다른 장치로 구성을 복사할 수 있습니다.

## <a name="powershell-reference"></a>PowerShell 참조

Windows 보안 앱을 사용하여 Exploit Protection을 구성하거나 PowerShell cmdlet을 사용할 수 있습니다.

가장 최근에 수정된 구성 설정은 PowerShell 사용 여부에 관계없이 항상 Windows 보안. 즉, 앱을 사용하여 완화를 구성한 다음 PowerShell을 사용하여 동일한 완화를 구성하면 PowerShell에서 변경한 내용이 표시하도록 앱이 업데이트됩니다. 그런 다음 앱을 사용하여 완화를 다시 변경하는 경우 해당 변경이 적용됩니다.

> [!IMPORTANT]
> 그룹 정책을 통해 장치에 배포되는 모든 변경 내용은 로컬 구성을 다시 적용합니다. 초기 구성을 설정할 때 그룹 정책 구성이 적용되지 않은 장치를 사용하여 변경 내용이 다시 적용되지 않도록 합니다.

PowerShell 동사 또는 `Get` `Set` cmdlet과 함께 사용할 수 `ProcessMitigation` 있습니다. 를 사용하면 장치에서 활성화된 모든 완화의 현재 구성 상태가 나열됩니다. `Get` cmdlet 및 앱 exe를 추가하여 해당 앱에 대한 완화를 `-Name` 확인합니다.

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> 구성되지 않은 시스템 수준 완화의 상태가 `NOTSET` 표시됩니다.
>
> 시스템 수준 설정의 경우 해당 완화에 대한 기본 설정이 `NOTSET` 적용된 것입니다.
>
> 앱 수준 설정의 경우 완화에 대한 시스템 수준 설정이 `NOTSET` 적용됩니다.
>
> 각 시스템 수준 완화에 대한 기본 설정은 다음 Windows 보안.

각 완화를 다음과 같은 형식으로 `Set` 구성하는 데 사용할 수 있습니다.

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

여기서,

- \<Scope\>:
  - `-Name` 완화를 특정 앱에 적용해야 한다고 나타냅니다. 이 플래그 다음에 앱의 실행을 지정합니다.
  - `-System` 완화가 시스템 수준에서 적용될 것임
- \<Action\>:
  - `-Enable` 완화를 사용하도록 설정하려면
  - `-Disable` 완화를 사용하지 않도록 설정
- \<Mitigation\>:
  - 아래의 완화 cmdlet 표에 정의된 완화 [cmdlet과](#cmdlets-table) 모든 하위options(공백으로 둘러싸인)입니다. 각 완화는 0으로 구분됩니다.

예를 들어 ATL unk 에뮬션을 사용하여 DEP(데이터 실행 방지) 완화를 사용하도록 설정하고 *C:\Apps\LOB\tests* *폴더의testing.exe* 라는 실행 파일에서 이 실행 파일을 만들어 자식 프로세스를 만들지 못하도록 방지하려면 다음 명령을 사용합니다.

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> 각 완화 옵션을 콤보로 구분합니다.

시스템 수준에서 DEP를 적용하고 싶은 경우 다음 명령을 사용하게 됩니다.

```PowerShell
Set-Processmitigation -System -Enable DEP
```

완화를 사용하지 않도록 설정하기 위해 를 로 바꿀 수 `-Enable` `-Disable` 있습니다. 그러나 앱 수준 완화의 경우 해당 앱에만 완화를 사용하지 않도록 설정됩니다.

완화를 시스템 기본값으로 복원해야 하는 경우 다음 예와 같이 `-Remove` cmdlet도 포함해야 합니다.

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

일부 완화를 감사 모드로 설정할 수 있습니다. 완화를 위해 PowerShell cmdlet을 사용하는 대신 아래  완화 cmdlet 표에 지정된 감사 모드 [cmdlet을](#cmdlets-table) 사용합니다.

예를 들어 이전에 사용한 2013에 대해 감사 모드에서 ACG(임의 *코드testing.exe)를* 사용하도록 설정하려면 다음 명령을 사용하게 됩니다.

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable AuditDynamicCode
```

동일한 명령을 사용하지만 로 바꾸어 감사 모드를 사용하지 않도록 설정할 수 `-Enable` `-Disable` 있습니다.

### <a name="powershell-reference-table"></a>PowerShell 참조 테이블

이 표에는 각 완화를 구성하는 데 사용할 수 있는 PowerShell cmdlet 및 관련 감사 모드 cmdlet이 나열됩니다.

<a id="cmdlets-table"></a>

|완화|적용 대상|PowerShell cmdlet|감사 모드 cmdlet|
|---|---|---|---|
|CFG(제어 흐름 보호)|시스템 및 앱 수준|CFG, StrictCFG, SuppressExports|감사를 사용할 수 없습니다.|
|데이터 실행 방지(DEP)|시스템 및 앱 수준|DEP, EmulateAtlThunks|감사를 사용할 수 없습니다.|
|이미지에 대한 강제 임의 지정(필수 ASLR)|시스템 및 앱 수준|ForceRelocateImages|감사를 사용할 수 없습니다.|
|메모리 할당 임의 지정(상향식 ASLR)|시스템 및 앱 수준|BottomUp, HighEntropy|감사를 사용할 수 없습니다.|
|예외 체인 확인(SEHOP)|시스템 및 앱 수준|SEHOP, SEHOPTelemetry|감사를 사용할 수 없습니다.|
|힙 무결성 확인|시스템 및 앱 수준|TerminateOnError|감사를 사용할 수 없습니다.|
|임의 코드 가드(ACG)|앱 수준만|DynamicCode|AuditDynamicCode|
|낮은 무결성 이미지 차단|앱 수준만|BlockLowLabel|AuditImageLoad|
|원격 이미지 차단|앱 수준만|BlockRemoteImages|감사를 사용할 수 없습니다.|
|신뢰할 수 없는 글꼴 차단|앱 수준만|DisableNonSystemFonts|AuditFont, FontAuditOnly|
|코드 무결성 가드|앱 수준만|BlockNonMicrosoftSigned, AllowStoreSigned|AuditMicrosoftSigned, AuditStoreSigned|
|확장 지점 사용 안 함|앱 수준만|ExtensionPoint|감사를 사용할 수 없습니다.|
|Win32k 시스템 호출 사용 안 함|앱 수준만|DisableWin32kSystemCalls|AuditSystemCall|
|자식 프로세스 허용 안 함|앱 수준만|DisallowChildProcessCreation|AuditChildProcess|
|주소 필터링 내보내기(EAF)|앱 수준만|EnableExportAddressFilterPlus, EnableExportAddressFilter <a href="#r1" id="t1"> \[ 1 \] </a>|감사를 사용할 수<a href="#r2" id="t2"> \[ 없습니다 2 \] </a>|
|주소 필터링 가져오기(IAF)|앱 수준만|EnableImportAddressFilter|감사를 사용할 수<a href="#r2" id="t2"> \[ 없습니다 2 \] </a>|
|실행 시뮬레이션(SimExec)|앱 수준만|EnableRopSimExec|감사를 사용할 수<a href="#r2" id="t2"> \[ 없습니다 2 \] </a>|
|API 호출 확인(CallerCheck)|앱 수준만|EnableRopCallerCheck|감사를 사용할 수<a href="#r2" id="t2"> \[ 없습니다 2 \] </a>|
|핸들 사용 확인|앱 수준만|StrictHandle|감사를 사용할 수 없습니다.|
|이미지 종속성 무결성 확인|앱 수준만|EnforceModuleDepencySigning|감사를 사용할 수 없습니다.|
|스택 무결성 확인(StackPivot)|앱 수준만|EnableRopStackPivot|감사를 사용할 수<a href="#r2" id="t2"> \[ 없습니다 2 \] </a>|

<a href="#t1" id="r1"> \[ 1: \] </a>다음 형식을 사용하여 프로세스의 dll에 대해 EAF 모듈을 사용하도록 설정할 수 있습니다.

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```

<a href="#t2" id="r2"> \[ 2: \] </a>이 완화에 대한 감사는 PowerShell cmdlet을 통해 사용할 수 없습니다.

## <a name="customize-the-notification"></a>알림 사용자 지정

규칙이 트리거되어 앱 또는 파일을 차단할 때 알림을 [사용자](/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center)지정하는 자세한 내용은 Windows 보안.

## <a name="see-also"></a>참고 항목

- [악용으로부터 장치 보호](exploit-protection.md)
- [Exploit Protection 평가](evaluate-exploit-protection.md)
- [악용 방지 사용](enable-exploit-protection.md)
- [악용 보호 구성 가져오기, 내보내기 및 배포하기](import-export-exploit-protection-emet-xml.md)
