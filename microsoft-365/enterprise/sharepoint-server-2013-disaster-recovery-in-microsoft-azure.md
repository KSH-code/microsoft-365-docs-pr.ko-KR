---
title: Microsoft Azure에서 SharePoint Server 2013 재해 복구
ms.author: bcarter
author: brendacarter
manager: laurawi
ms.date: 04/17/2018
audience: ITPro
ms.topic: article
ms.service: o365-solutions
localization_priority: Normal
search.appverid:
- MET150
ms.collection: Ent_O365
f1.keywords:
- CSH
ms.custom:
- Ent_Deployment
- seo-marvel-apr2020
ms.assetid: e9d14cb2-ff28-4a18-a444-cebf891880ea
description: 이 문서에서는 Azure를 사용하여 사내 SharePoint 팜에 대한 재해 복구 환경을 만드는 방법을 설명합니다.
ms.openlocfilehash: 01a49cfa19711caa36190a795792635431dd7d04
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/19/2021
ms.locfileid: "50907435"
---
# <a name="sharepoint-server-2013-disaster-recovery-in-microsoft-azure"></a><span data-ttu-id="6c7a0-103">Microsoft Azure에서 SharePoint Server 2013 재해 복구</span><span class="sxs-lookup"><span data-stu-id="6c7a0-103">SharePoint Server 2013 Disaster Recovery in Microsoft Azure</span></span>

 <span data-ttu-id="6c7a0-104">Azure를 사용하여 사내 SharePoint 팜에 대한 재해 복구 환경을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-104">Using Azure, you can create a disaster-recovery environment for your on-premises SharePoint farm.</span></span> <span data-ttu-id="6c7a0-105">이 문서에서는 이 솔루션을 디자인하고 구현하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-105">This article describes how to design and implement this solution.</span></span>

 <span data-ttu-id="6c7a0-106">**SharePoint Server 2013 재해 복구 개요 비디오 시청**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-106">**Watch the SharePoint Server 2013 disaster recovery overview video**</span></span>
> [!VIDEO https://www.microsoft.com/videoplayer/embed/1b73ec8f-29bd-44eb-aa3a-f7932784bfd9?autoplay=false]
  
 <span data-ttu-id="6c7a0-107">재해로 SharePoint 사내 환경이 중단되는 경우 가장 우선 순위는 시스템을 빠르게 다시 실행하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-107">When disaster strikes your SharePoint on-premises environment, your top priority is to get the system running again quickly.</span></span> <span data-ttu-id="6c7a0-108">Microsoft Azure에서 백업 환경이 이미 실행되고 있는 경우 SharePoint를 사용하여 재해 복구를 더 빠르고 쉽게 진행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-108">Disaster recovery with SharePoint is quicker and easier when you have a backup environment already running in Microsoft Azure.</span></span> <span data-ttu-id="6c7a0-109">이 비디오에서는 SharePoint 웜 장애 조치(failover) 환경의 주요 개념을 설명하고 이 문서에서 사용할 수 있는 전체 세부 정보를 보완합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-109">This video explains the main concepts of a SharePoint warm failover environment and complements the full details available in this article.</span></span>
  
<span data-ttu-id="6c7a0-110">이 문서를 Microsoft **Azure의 SharePoint 재해 복구 솔루션 모델과 함께 사용하세요.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-110">Use this article with the following solution model: **SharePoint Disaster Recovery in Microsoft Azure**.</span></span>
  
<span data-ttu-id="6c7a0-111">[![Azure에 대한 SharePoint 재해 복구 프로세스](../media/SP-DR-Azure.png)](https://go.microsoft.com/fwlink/p/?LinkId=392555)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-111">[![SharePoint disaster-recovery process to Azure](../media/SP-DR-Azure.png)](https://go.microsoft.com/fwlink/p/?LinkId=392555)</span></span>
  
 <span data-ttu-id="6c7a0-112">[PDF](https://go.microsoft.com/fwlink/p/?LinkId=392555) |  [Visio](https://go.microsoft.com/fwlink/p/?LinkId=392554)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-112">[PDF](https://go.microsoft.com/fwlink/p/?LinkId=392555) |  [Visio](https://go.microsoft.com/fwlink/p/?LinkId=392554)</span></span>
  
## <a name="use-azure-infrastructure-services-for-disaster-recovery"></a><span data-ttu-id="6c7a0-113">재해 복구를 위해 Azure 인프라 서비스 사용</span><span class="sxs-lookup"><span data-stu-id="6c7a0-113">Use Azure Infrastructure Services for disaster recovery</span></span>

<span data-ttu-id="6c7a0-114">대부분의 조직에는 SharePoint에 대한 재해 복구 환경이 없습니다. 이 환경은 사내에서 빌드 및 유지 관리하기에 비용이 많이 들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-114">Many organizations do not have a disaster recovery environment for SharePoint, which can be expensive to build and maintain on-premises.</span></span> <span data-ttu-id="6c7a0-115">Azure 인프라 서비스는 재해 복구 환경에 대해 사내 대안보다 유연성이 높고 비용이 덜 드는 융통성 있는 옵션을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-115">Azure Infrastructure Services provides compelling options for disaster recovery environments that are more flexible and less expensive than the on-premises alternatives.</span></span>
  
<span data-ttu-id="6c7a0-116">Azure 인프라 서비스를 사용할 경우의 이점은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-116">The advantages for using Azure Infrastructure Services include:</span></span>
  
- <span data-ttu-id="6c7a0-117">**비용이 많이 드는 리소스 수 감소** 프레미스 재해 복구 환경보다 적은 수의 리소스를 유지 관리하고 비용을 지불합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-117">**Fewer costly resources** Maintain and pay for fewer resources than on-premises disaster recovery environments.</span></span> <span data-ttu-id="6c7a0-118">리소스 수는 콜드 대기, 웜 대기 또는 핫 대기 중 어떤 재해 복구 환경을 선택하는지에 따라 달라 집니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-118">The number of resources depends on which disaster-recovery environment you choose: cold standby, warm standby, or hot standby.</span></span>
    
- <span data-ttu-id="6c7a0-119">**더 나은 리소스 유연성** 재해가 발생하면 부하 요구 사항을 충족하기 위해 복구 SharePoint 팜을 쉽게 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-119">**Better resource flexibility** In the event of a disaster, easily scale out your recovery SharePoint farm to meet load requirements.</span></span> <span data-ttu-id="6c7a0-120">리소스가 더 이상 필요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-120">Scale in when you no longer need the resources.</span></span>
    
- <span data-ttu-id="6c7a0-121">**낮은 데이터 센터 약정** 다른 지역의 보조 데이터 센터에 투자하는 대신 Azure 인프라 서비스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-121">**Lower datacenter commitment** Use Azure Infrastructure Services instead of investing in a secondary datacenter in a different region.</span></span>
    
<span data-ttu-id="6c7a0-122">재해 복구를 시작하는 조직에는 덜 복잡한 옵션과 복구 요구 사항이 높은 조직을 위한 고급 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-122">There are less-complex options for organizations just getting started with disaster recovery and advanced options for organizations with high-resilience requirements.</span></span> <span data-ttu-id="6c7a0-123">콜드, 웜 및 핫 대기 환경에 대한 정의는 환경이 클라우드 플랫폼에서 호스팅된 경우 약간 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-123">The definitions for cold, warm, and hot standby environments are a little different when the environment is hosted on a cloud platform.</span></span> <span data-ttu-id="6c7a0-124">다음 표에서는 Azure에서 SharePoint 복구 팜을 구축하기 위한 이러한 환경에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-124">The following table describes these environments for building a SharePoint recovery farm in Azure.</span></span>
  
<span data-ttu-id="6c7a0-125">**표: 복구 환경**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-125">**Table: Recovery environments**</span></span>

|<span data-ttu-id="6c7a0-126">**복구 환경 유형**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-126">**Type of recovery environment**</span></span>|<span data-ttu-id="6c7a0-127">**설명**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c7a0-128">핫</span><span class="sxs-lookup"><span data-stu-id="6c7a0-128">Hot</span></span>  <br/> |<span data-ttu-id="6c7a0-129">완전히 크기의 팜이 프로비전, 업데이트 및 대기에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-129">A fully sized farm is provisioned, updated, and running on standby.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-130">웜</span><span class="sxs-lookup"><span data-stu-id="6c7a0-130">Warm</span></span>  <br/> |<span data-ttu-id="6c7a0-131">팜이 구축되고 가상 컴퓨터도 실행되고 업데이트됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-131">The farm is built and virtual machines are running and updated.</span></span>  <br/> <span data-ttu-id="6c7a0-132">복구에는 콘텐츠 데이터베이스 연결, 서비스 응용 프로그램 프로비전 및 콘텐츠 크롤링이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-132">Recovery includes attaching content databases, provisioning service applications, and crawling content.</span></span>  <br/> <span data-ttu-id="6c7a0-133">팜은 더 작은 버전의 프로덕션 팜이 될 수 있으며 전체 사용자 기반을 지원하도록 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-133">The farm can be a smaller version of the production farm and then scaled out to serve the full user base.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-134">콜드</span><span class="sxs-lookup"><span data-stu-id="6c7a0-134">Cold</span></span>  <br/> |<span data-ttu-id="6c7a0-135">팜이 완전히 구축되지만 가상 컴퓨터는 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-135">The farm is fully built, but the virtual machines are stopped.</span></span>  <br/> <span data-ttu-id="6c7a0-136">환경을 유지 관리하기 위해 가상 컴퓨터를 수시로 시작하고, 패치하고, 업데이트하고, 환경을 확인하는 작업도 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-136">Maintaining the environment includes starting the virtual machines from time to time, patching, updating, and verifying the environment.</span></span>  <br/> <span data-ttu-id="6c7a0-137">재해 발생 시 전체 환경을 시작하십시오.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-137">Start the full environment in the event of a disaster.</span></span>  <br/> |
   
<span data-ttu-id="6c7a0-138">조직의 복구 시간 목표(RTOS) 및 복구 지점 목표(RPOS)를 평가하는 것이 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-138">It's important to evaluate your organization's Recovery Time Objectives (RTOs) and Recovery Point Objectives (RPOs).</span></span> <span data-ttu-id="6c7a0-139">이러한 요구 사항에 따라 조직에 가장 적합한 투자 환경이 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-139">These requirements determine which environment is the most appropriate investment for your organization.</span></span>
  
<span data-ttu-id="6c7a0-140">이 문서의 지침에서는 웜 대기 환경을 구현하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-140">The guidance in this article describes how to implement a warm standby environment.</span></span> <span data-ttu-id="6c7a0-141">이러한 종류의 환경을 지원하려면 추가 절차를 따라야 하지만 콜드 대기 환경에 맞게 해당 환경을 적응할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-141">You can also adapt it to a cold standby environment, although you need to follow additional procedures to support this kind of environment.</span></span> <span data-ttu-id="6c7a0-142">이 문서에서는 핫 대기 환경을 구현하는 방법에 대해 설명하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-142">This article does not describe how to implement a hot standby environment.</span></span>
  
<span data-ttu-id="6c7a0-143">재해 복구 솔루션에 대한 자세한 내용은 [High availability and disaster recovery concepts in SharePoint 2013](/SharePoint/administration/high-availability-and-disaster-recovery-concepts) 및 Choose a disaster recovery [strategy for SharePoint 2013을 참조하세요.](/SharePoint/administration/plan-for-disaster-recovery)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-143">For more information about disaster recovery solutions, see [High availability and disaster recovery concepts in SharePoint 2013](/SharePoint/administration/high-availability-and-disaster-recovery-concepts) and [Choose a disaster recovery strategy for SharePoint 2013](/SharePoint/administration/plan-for-disaster-recovery).</span></span>
  
## <a name="solution-description"></a><span data-ttu-id="6c7a0-144">솔루션 설명</span><span class="sxs-lookup"><span data-stu-id="6c7a0-144">Solution description</span></span>

<span data-ttu-id="6c7a0-145">웜 대기 재해 복구 솔루션에는 다음 환경이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-145">The warm standby disaster-recovery solution requires the following environment:</span></span>
  
- <span data-ttu-id="6c7a0-146">사내 SharePoint 프로덕션 팜</span><span class="sxs-lookup"><span data-stu-id="6c7a0-146">An on-premises SharePoint production farm</span></span>
    
- <span data-ttu-id="6c7a0-147">Azure의 복구 SharePoint 팜</span><span class="sxs-lookup"><span data-stu-id="6c7a0-147">A recovery SharePoint farm in Azure</span></span>
    
- <span data-ttu-id="6c7a0-148">두 환경 간의 사이트 간 VPN 연결</span><span class="sxs-lookup"><span data-stu-id="6c7a0-148">A site-to-site VPN connection between the two environments</span></span>
    
<span data-ttu-id="6c7a0-149">다음 그림에서는 이러한 세 가지 요소를 보여 주었다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-149">The following figure illustrates these three elements.</span></span>
  
<span data-ttu-id="6c7a0-150">**그림: Azure의 웜 대기 솔루션 요소**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-150">**Figure: Elements of a warm standby solution in Azure**</span></span>

![Azure의 SharePoint 웜 대기 솔루션 요소](../media/AZarch-AZWarmStndby.png)
  
<span data-ttu-id="6c7a0-152">SQL Server DFSR(분산 파일 시스템 복제)을 사용한 로그 전달은 데이터베이스 백업 및 트랜잭션 로그를 Azure의 복구 팜에 복사하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-152">SQL Server log shipping with Distributed File System Replication (DFSR) is used to copy database backups and transaction logs to the recovery farm in Azure:</span></span> 
  
- <span data-ttu-id="6c7a0-153">DFSR은 프로덕션 환경에서 복구 환경으로 로그를 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-153">DFSR transfers logs from the production environment to the recovery environment.</span></span> <span data-ttu-id="6c7a0-154">WAN 시나리오에서 DFSR은 Azure의 보조 서버로 직접 로그를 전달하는 것보다 더 효율적입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-154">In a WAN scenario, DFSR is more efficient than shipping the logs directly to the secondary server in Azure.</span></span>
    
- <span data-ttu-id="6c7a0-155">로그는 Azure의 복구 SQL Server 로그에 재생됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-155">Logs are replayed to the SQL Server in the recovery environment in Azure.</span></span>
    
- <span data-ttu-id="6c7a0-156">복구 연습이 수행될 때까지 복구 환경에서 로그가 발송된 SharePoint 콘텐츠 데이터베이스를 연결하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-156">You don't attach log-shipped SharePoint content databases in the recovery environment until a recovery exercise is performed.</span></span>
    
<span data-ttu-id="6c7a0-157">다음 단계를 수행하여 팜을 복구합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-157">Perform the following steps to recover the farm:</span></span>
  
1. <span data-ttu-id="6c7a0-158">로그 전달을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-158">Stop log shipping.</span></span>
    
2. <span data-ttu-id="6c7a0-159">기본 팜에 대한 트래픽 허용을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-159">Stop accepting traffic to the primary farm.</span></span>
    
3. <span data-ttu-id="6c7a0-160">최종 트랜잭션 로그를 재생합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-160">Replay the final transaction logs.</span></span>
    
4. <span data-ttu-id="6c7a0-161">콘텐츠 데이터베이스를 팜에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-161">Attach the content databases to the farm.</span></span>
    
5. <span data-ttu-id="6c7a0-162">복제된 서비스 데이터베이스에서 서비스 응용 프로그램을 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-162">Restore service applications from the replicated services databases.</span></span>
    
6. <span data-ttu-id="6c7a0-163">복구 팜을 지점으로 DNS(Domain Name System) 레코드를 업데이트합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-163">Update Domain Name System (DNS) records to point to the recovery farm.</span></span>
    
7. <span data-ttu-id="6c7a0-164">전체 크롤링을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-164">Start a full crawl.</span></span>
    
<span data-ttu-id="6c7a0-165">라이브 복구가 원활하게 실행되도록 이러한 단계를 정기적으로 리허설하고 문서화하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-165">We recommend that you rehearse these steps regularly and document them to help ensure that your live recovery runs smoothly.</span></span> <span data-ttu-id="6c7a0-166">콘텐츠 데이터베이스를 연결하고 서비스 응용 프로그램을 복원하는 데는 시간이 걸릴 수 있으며 일반적으로 몇 가지 수동 구성이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-166">Attaching content databases and restoring service applications can take some time and typically involves some manual configuration.</span></span>
  
<span data-ttu-id="6c7a0-167">복구가 수행된 후 이 솔루션은 다음 표에 나열된 항목을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-167">After a recovery is performed, this solution provides the items listed in the following table.</span></span>
  
<span data-ttu-id="6c7a0-168">**표: 솔루션 복구 목표**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-168">**Table: Solution recovery objectives**</span></span>

|<span data-ttu-id="6c7a0-169">**항목**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-169">**Item**</span></span>|<span data-ttu-id="6c7a0-170">**설명**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-170">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c7a0-171">사이트 및 콘텐츠</span><span class="sxs-lookup"><span data-stu-id="6c7a0-171">Sites and content</span></span>  <br/> |<span data-ttu-id="6c7a0-172">사이트 및 콘텐츠는 복구 환경에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-172">Sites and content are available in the recovery environment.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-173">새 검색 인스턴스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-173">A new instance of search</span></span>  <br/> |<span data-ttu-id="6c7a0-174">이 웜 대기 솔루션에서는 검색 데이터베이스에서 검색이 복원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-174">In this warm standby solution, search is not restored from search databases.</span></span> <span data-ttu-id="6c7a0-175">복구 팜의 검색 구성 요소는 프로덕션 팜과 최대한 비슷하게 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-175">Search components in the recovery farm are configured as similarly as possible to the production farm.</span></span> <span data-ttu-id="6c7a0-176">사이트 및 콘텐츠가 복원되면 전체 크롤링이 시작되어 검색 인덱스가 다시 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-176">After the sites and content are restored, a full crawl is started to rebuild the search index.</span></span> <span data-ttu-id="6c7a0-177">사이트 및 콘텐츠를 사용할 수 있도록 만들기 위해 크롤링이 완료될 때까지 기다릴 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-177">You do not need to wait for the crawl to complete to make the sites and content available.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-178">서비스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-178">Services</span></span>  <br/> | <span data-ttu-id="6c7a0-179">데이터베이스에 데이터를 저장하는 서비스는 로그 제공 데이터베이스에서 복원됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-179">Services that store data in databases are restored from the log-shipped databases.</span></span> <span data-ttu-id="6c7a0-180">데이터베이스에 데이터를 저장하지 않는 서비스는 간단히 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-180">Services that do not store data in databases are simply started.</span></span> <br/>  <span data-ttu-id="6c7a0-181">데이터베이스가 있는 모든 서비스를 복원할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-181">Not all services with databases need to be restored.</span></span> <span data-ttu-id="6c7a0-182">다음 서비스는 데이터베이스에서 복원할 필요가 없습니다. 장애 조치(failover) 후 간단히 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-182">The following services do not need to be restored from databases and can simply be started after failover:</span></span> <br/>  <span data-ttu-id="6c7a0-183">Usage and Health Data Collection</span><span class="sxs-lookup"><span data-stu-id="6c7a0-183">Usage and Health Data Collection</span></span> <br/>  <span data-ttu-id="6c7a0-184">State Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-184">State service</span></span> <br/>  <span data-ttu-id="6c7a0-185">Word 자동화</span><span class="sxs-lookup"><span data-stu-id="6c7a0-185">Word automation</span></span> <br/>  <span data-ttu-id="6c7a0-186">데이터베이스를 사용하지 않는 다른 모든 서비스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-186">Any other service that doesn't use a database</span></span> <br/> |
   
<span data-ttu-id="6c7a0-187">MCS(Microsoft Consulting Services) 또는 파트너와 협력하여 보다 복잡한 복구 목표를 해결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-187">You can work with Microsoft Consulting Services (MCS) or a partner to address more-complex recovery objectives.</span></span> <span data-ttu-id="6c7a0-188">이러한 설명은 다음 표에 요약됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-188">These are summarized in the following table.</span></span>
  
<span data-ttu-id="6c7a0-189">**표: MCS 또는 파트너가 해결할 수 있는 기타 항목**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-189">**Table: Other items that can be addressed by MCS or a partner**</span></span>

|<span data-ttu-id="6c7a0-190">**항목**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-190">**Item**</span></span>|<span data-ttu-id="6c7a0-191">**설명**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c7a0-192">사용자 지정 팜 솔루션 동기화</span><span class="sxs-lookup"><span data-stu-id="6c7a0-192">Synchronizing custom farm solutions</span></span>  <br/> |<span data-ttu-id="6c7a0-193">이상적으로 복구 팜 구성은 프로덕션 팜과 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-193">Ideally, the recovery farm configuration is identical to the production farm.</span></span> <span data-ttu-id="6c7a0-194">컨설턴트 또는 파트너와 협력하여 사용자 지정 팜 솔루션을 복제할지 여부와 두 환경을 동기화된 환경에 유지하기 위한 프로세스가 있는지 여부를 평가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-194">You can work with a consultant or partner to evaluate whether custom farm solutions are replicated and whether the process is in place for keeping the two environments synchronized.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-195">데이터 원본에 대한 연결(사내 데이터 원본)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-195">Connections to data sources on-premises</span></span>  <br/> |<span data-ttu-id="6c7a0-196">백업 도메인 컨트롤러(BDC) 연결 및 검색 콘텐츠 원본과 같은 백 엔드 데이터 시스템에 대한 연결을 복제하는 것은 실용적이지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-196">It might not be practical to replicate connections to back-end data systems, such as backup domain controller (BDC) connections and search content sources.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-197">검색 복원 시나리오</span><span class="sxs-lookup"><span data-stu-id="6c7a0-197">Search restore scenarios</span></span>  <br/> |<span data-ttu-id="6c7a0-198">엔터프라이즈 검색 배포는 매우 고유하고 복잡하기 때문에 데이터베이스에서 검색을 복원하려면 더 많은 투자가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-198">Because enterprise search deployments tend to be fairly unique and complex, restoring search from databases requires a greater investment.</span></span> <span data-ttu-id="6c7a0-199">컨설턴트 또는 파트너와 협력하여 조직에 필요할 수 있는 검색 복원 시나리오를 식별하고 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-199">You can work with a consultant or partner to identify and implement search restore scenarios that your organization might require.</span></span>  <br/> |
   
<span data-ttu-id="6c7a0-200">이 문서에서 제공하는 지침에서는 사내 팜이 이미 설계 및 배포되어 있는 것으로 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-200">The guidance provided in this article assumes that the on-premises farm is already designed and deployed.</span></span>
  
## <a name="detailed-architecture"></a><span data-ttu-id="6c7a0-201">자세한 아키텍처</span><span class="sxs-lookup"><span data-stu-id="6c7a0-201">Detailed architecture</span></span>

<span data-ttu-id="6c7a0-202">Azure의 복구 팜 구성은 다음을 포함하여 프로덕션 팜의 사내와 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-202">Ideally, the recovery farm configuration in Azure is identical to the production farm on-premises, including the following:</span></span>
  
- <span data-ttu-id="6c7a0-203">서버 역할의 동일한 표현</span><span class="sxs-lookup"><span data-stu-id="6c7a0-203">The same representation of server roles</span></span>
    
- <span data-ttu-id="6c7a0-204">동일한 사용자 지정 구성</span><span class="sxs-lookup"><span data-stu-id="6c7a0-204">The same configuration of customizations</span></span>
    
- <span data-ttu-id="6c7a0-205">검색 구성 요소의 동일한 구성</span><span class="sxs-lookup"><span data-stu-id="6c7a0-205">The same configuration of search components</span></span>
    
<span data-ttu-id="6c7a0-206">Azure의 환경은 더 작은 버전의 프로덕션 팜일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-206">The environment in Azure can be a smaller version of the production farm.</span></span> <span data-ttu-id="6c7a0-207">장애 조치(failover) 후 복구 팜을 수립할 계획인 경우 각 서버 역할 유형을 처음에 나타내는 것이 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-207">If you plan to scale out the recovery farm after failover, it's important that each type of server role be initially represented.</span></span>
  
<span data-ttu-id="6c7a0-208">일부 구성은 장애 조치(failover) 환경에서 복제하는 것이 실용적이지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-208">Some configurations might not be practical to replicate in the failover environment.</span></span> <span data-ttu-id="6c7a0-209">장애 조치 팜에서 예상 서비스 수준을 제공하는지 확인하도록 장애 조치(failover) 절차 및 환경을 테스트해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-209">Be sure to test the failover procedures and environment to help ensure that the failover farm provides the expected service level.</span></span>
  
<span data-ttu-id="6c7a0-210">이 솔루션에서는 SharePoint 팜에 대한 특정 토폴로지가 지정되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-210">This solution doesn't prescribe a specific topology for a SharePoint farm.</span></span> <span data-ttu-id="6c7a0-211">이 솔루션의 초점은 장애 조치 팜에 Azure를 사용하여 두 환경 간에 로그 전달 및 DFSR을 구현하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-211">The focus of this solution is to use Azure for the failover farm and to implement log shipping and DFSR between the two environments.</span></span>
  
### <a name="warm-standby-environments"></a><span data-ttu-id="6c7a0-212">웜 대기 환경</span><span class="sxs-lookup"><span data-stu-id="6c7a0-212">Warm standby environments</span></span>

<span data-ttu-id="6c7a0-213">웜 대기 환경에서는 Azure 환경의 모든 가상 머신이 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-213">In a warm standby environment, all virtual machines in the Azure environment are running.</span></span> <span data-ttu-id="6c7a0-214">환경은 장애 조치(failover) 연습 또는 이벤트를 준비합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-214">The environment is ready for a failover exercise or event.</span></span>
  
<span data-ttu-id="6c7a0-215">다음 그림에서는 온-프레미스 SharePoint 팜에서 웜 대기 환경으로 구성된 Azure 기반 SharePoint 팜으로의 재해 복구 솔루션을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-215">The following figure illustrates a disaster recovery solution from an on-premises SharePoint farm to an Azure-based SharePoint farm that is configured as a warm standby environment.</span></span>
  
<span data-ttu-id="6c7a0-216">**그림: 프로덕션 팜 및 웜 대기 복구 팜의 토폴로지 및 주요 요소**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-216">**Figure: Topology and key elements of a production farm and a warm standby recovery farm**</span></span>

![SharePoint 팜 및 웜 대기 복구 팜의 토폴로지](../media/AZarch-AZWarmStndby.png)
  
<span data-ttu-id="6c7a0-218">다음은 이 다이어그램에 대한 설명입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-218">In this diagram:</span></span>
  
- <span data-ttu-id="6c7a0-219">두 환경, 즉 온-프레미스 SharePoint 팜과 Azure의 웜 대기 팜이 나란히 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-219">Two environments are illustrated side by side: the on-premises SharePoint farm and the warm standby farm in Azure.</span></span>
    
- <span data-ttu-id="6c7a0-220">각 환경에는 파일 공유가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-220">Each environment includes a file share.</span></span>
    
- <span data-ttu-id="6c7a0-221">각 팜에는 네 개의 계층이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-221">Each farm includes four tiers.</span></span> <span data-ttu-id="6c7a0-222">고가용성을 달성하기 위해 각 계층에는 프런트 엔드 서비스, 분산 캐시, 백 엔드 서비스 및 데이터베이스와 같은 특정 역할에 대해 동일하게 구성된 두 개의 서버 또는 가상 컴퓨터를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-222">To achieve high availability, each tier includes two servers or virtual machines that are configured identically for a specific role, such as front-end services, distributed cache, back-end services, and databases.</span></span> <span data-ttu-id="6c7a0-223">이 그림에서는 특정 구성 요소를 호출하는 것이 중요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-223">It isn't important in this illustration to call out specific components.</span></span> <span data-ttu-id="6c7a0-224">두 팜은 동일하게 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-224">The two farms are configured identically.</span></span>
    
- <span data-ttu-id="6c7a0-225">네 번째 계층은 데이터베이스 계층입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-225">The fourth tier is the database tier.</span></span> <span data-ttu-id="6c7a0-226">로그 전달은온-프레미스 환경의 보조 데이터베이스 서버에서 동일한 환경의 파일 공유로 로그를 복사하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-226">Log shipping is used to copy logs from the secondary database server in the on-premises environment to the file share in the same environment.</span></span>
    
- <span data-ttu-id="6c7a0-227">DFSR은 온-프레미스 환경의 파일 공유에서 Azure 환경의 파일 공유로 파일을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-227">DFSR copies files from the file share in the on-premises environment to the file share in the Azure environment.</span></span>
    
- <span data-ttu-id="6c7a0-228">로그 전달은 Azure 환경의 파일 공유에서 복구 환경의 SQL Server AlwaysOn 가용성 그룹에 있는 기본 복제본으로 로그를 재생합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-228">Log shipping replays the logs from the file share in the Azure environment to the primary replica in the SQL Server AlwaysOn availability group in the recovery environment.</span></span>
    
### <a name="cold-standby-environments"></a><span data-ttu-id="6c7a0-229">콜드 대기 환경</span><span class="sxs-lookup"><span data-stu-id="6c7a0-229">Cold standby environments</span></span>

<span data-ttu-id="6c7a0-230">콜드 대기 환경에서는 대부분의 SharePoint 팜 가상 컴퓨터를 종료할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-230">In a cold standby environment, most of the SharePoint farm virtual machines can be shut down.</span></span> <span data-ttu-id="6c7a0-231">각 가상 컴퓨터를 도메인과 동기화할 수 있도록 가끔씩 2주 또는 한 달에 한 번씩 가상 컴퓨터를 시작하는 것이 좋습니다. 로그 전달 및 DFSR의 연속 작업을 보장하려면 Azure 복구 환경의 다음 가상 컴퓨터를 계속 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-231">(We recommend occasionally starting the virtual machines, such as every two weeks or once a month, so that each virtual machine can sync with the domain.) The following virtual machines in the Azure recovery environment must remain running to help ensure continuous operations of log shipping and DFSR:</span></span>
  
- <span data-ttu-id="6c7a0-232">파일 공유</span><span class="sxs-lookup"><span data-stu-id="6c7a0-232">The file share</span></span>
    
- <span data-ttu-id="6c7a0-233">기본 데이터베이스 서버</span><span class="sxs-lookup"><span data-stu-id="6c7a0-233">The primary database server</span></span>
    
- <span data-ttu-id="6c7a0-234">Windows Server Active Directory 도메인 서비스 및 DNS를 실행하는 하나 이상의 가상 컴퓨터</span><span class="sxs-lookup"><span data-stu-id="6c7a0-234">At least one virtual machine running Windows Server Active Directory Domain Services and DNS</span></span>
    
<span data-ttu-id="6c7a0-235">다음 그림에서는 파일 공유 가상 컴퓨터 및 기본 SharePoint 데이터베이스 가상 머신이 실행되는 Azure 장애 조치(failover) 환경을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-235">The following figure shows an Azure failover environment in which the file share virtual machine and the primary SharePoint database virtual machine are running.</span></span> <span data-ttu-id="6c7a0-236">다른 모든 SharePoint 가상 컴퓨터는 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-236">All other SharePoint virtual machines are stopped.</span></span> <span data-ttu-id="6c7a0-237">Windows Server Active Directory 및 DNS를 실행하는 가상 컴퓨터는 표시되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-237">The virtual machine that is running Windows Server Active Directory and DNS is not shown.</span></span>
  
<span data-ttu-id="6c7a0-238">**그림: 가상 컴퓨터를 실행하는 콜드 대기 복구 팜**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-238">**Figure: Cold standby recovery farm with running virtual machines**</span></span>

![Azure의 SharePoint 콜드 대기 솔루션 요소](../media/AZarch-AZColdStndby.png)
  
<span data-ttu-id="6c7a0-240">콜드 대기 환경으로의 장애 조치(failover)가 시작된 후 모든 가상 컴퓨터를 시작하고 AlwaysOn 가용성 그룹과 같이 데이터베이스 서버의 고가용성을 SQL Server 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-240">After failover to a cold standby environment, all virtual machines are started, and the method to achieve high availability of the database servers must be configured, such as SQL Server AlwaysOn availability groups.</span></span>
  
<span data-ttu-id="6c7a0-241">여러 저장소 그룹을 구현하는 경우(데이터베이스가 두 개 이상의 SQL Server 고가용성 집합에 분산되어 있는 경우 저장소 그룹과 연결된 로그를 수락하기 위해 각 저장소 그룹의 기본 데이터베이스가 실행되고 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-241">If multiple storage groups are implemented (databases are spread across more than one SQL Server high availability set), the primary database for each storage group must be running to accept the logs associated with its storage group.</span></span>
  
### <a name="skills-and-experience"></a><span data-ttu-id="6c7a0-242">기술 및 환경</span><span class="sxs-lookup"><span data-stu-id="6c7a0-242">Skills and experience</span></span>

<span data-ttu-id="6c7a0-243">이 재해 복구 솔루션에는 여러 기술이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-243">Multiple technologies are used in this disaster recovery solution.</span></span> <span data-ttu-id="6c7a0-244">이러한 기술이 예상대로 상호 작용하도록 보장하려면 사내 및 Azure 환경의 각 구성 요소를 올바르게 설치 및 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-244">To help ensure that these technologies interact as expected, each component in the on-premises and Azure environment must be installed and configured correctly.</span></span> <span data-ttu-id="6c7a0-245">이 솔루션을 설정하는 사람 또는 팀이 다음 문서에 설명된 기술에 대한 강력한 실무 지식과 실무 지식을 습득하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-245">We recommend that the person or team who sets up this solution have a strong working knowledge of and hands-on skills with the technologies described in the following articles:</span></span>
  
- <span data-ttu-id="6c7a0-246">[DFS(분산 파일 시스템) 복제 서비스](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj127250(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="6c7a0-246">[Distributed File System (DFS) Replication Services](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj127250(v=ws.11))</span></span>
    
- [<span data-ttu-id="6c7a0-247">WSFC(Windows Server 장애 조치(failover) 클러스터링) SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c7a0-247">Windows Server Failover Clustering (WSFC) with SQL Server</span></span>](/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server)
    
- [<span data-ttu-id="6c7a0-248">AlwaysOn 가용성 그룹(SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-248">AlwaysOn Availability Groups (SQL Server)</span></span>](/sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server)
    
- [<span data-ttu-id="6c7a0-249">데이터베이스 백업 및 SQL Server 복원</span><span class="sxs-lookup"><span data-stu-id="6c7a0-249">Back Up and Restore of SQL Server Databases</span></span>](/sql/relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases)
    
- [<span data-ttu-id="6c7a0-250">SharePoint Server 2013 설치 및 팜 배포</span><span class="sxs-lookup"><span data-stu-id="6c7a0-250">SharePoint Server 2013 installation and farm deployment</span></span>](/SharePoint/install/installation-and-configuration-overview)
    
- [<span data-ttu-id="6c7a0-251">Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="6c7a0-251">Microsoft Azure</span></span>](/azure/)
    
<span data-ttu-id="6c7a0-252">마지막으로 이러한 기술과 관련된 작업을 자동화하는 데 사용할 수 있는 스크립팅 기술을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-252">Finally, we recommend scripting skills that you can use to automate tasks associated with these technologies.</span></span> <span data-ttu-id="6c7a0-253">사용 가능한 사용자 인터페이스를 사용하여 이 솔루션에 설명된 모든 작업을 완료할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-253">It's possible to use the available user interfaces to complete all the tasks described in this solution.</span></span> <span data-ttu-id="6c7a0-254">그러나 수동 방식은 시간이 오래 걸리고 오류가 발생하기 까다로우며 불일치한 결과를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-254">However, a manual approach can be time consuming and error prone and delivers inconsistent results.</span></span>
  
<span data-ttu-id="6c7a0-255">이 Windows PowerShell 외에도 Windows PowerShell, SharePoint Server 및 Azure용 SQL Server 라이브러리도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-255">In addition to Windows PowerShell, there are also Windows PowerShell libraries for SQL Server, SharePoint Server, and Azure.</span></span> <span data-ttu-id="6c7a0-256">재해 복구 환경을 구성하고 SQL 시간을 줄이는 데에도 도움이 될 수 있는 T-T-2를 잊지 마세요.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-256">Don't forget T-SQL, which can also help reduce the time to configure and maintain your disaster-recovery environment.</span></span>
  
## <a name="disaster-recovery-roadmap"></a><span data-ttu-id="6c7a0-257">재해 복구 로드맵</span><span class="sxs-lookup"><span data-stu-id="6c7a0-257">Disaster recovery roadmap</span></span>

![SharePoint 재해 복구 로드맵의 시각적 표현입니다.](../media/Azure-DRroadmap.png)
  
<span data-ttu-id="6c7a0-259">이 로드맵에서는 프로덕션에 SharePoint Server 2013 팜이 이미 배포되어 있는 것으로 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-259">This roadmap assumes that you already have a SharePoint Server 2013 farm deployed in production.</span></span>
  
<span data-ttu-id="6c7a0-260">**표: 재해 복구 로드맵**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-260">**Table: Roadmap for disaster recovery**</span></span>

|<span data-ttu-id="6c7a0-261">**작업 단계**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-261">**Phase**</span></span>|<span data-ttu-id="6c7a0-262">**설명**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-262">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c7a0-263">1단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-263">Phase 1</span></span>  <br/> |<span data-ttu-id="6c7a0-264">재해 복구 환경을 디자인합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-264">Design the disaster recovery environment.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-265">2단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-265">Phase 2</span></span>  <br/> |<span data-ttu-id="6c7a0-266">Azure Virtual Network 및 VPN 연결을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-266">Create the Azure virtual network and VPN connection.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-267">3단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-267">Phase 3</span></span>  <br/> |<span data-ttu-id="6c7a0-268">Azure Virtual Network에 Windows Active Directory 및 Domain Name Services를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-268">Deploy Windows Active Directory and Domain Name Services to the Azure virtual network.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-269">4단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-269">Phase 4</span></span>  <br/> |<span data-ttu-id="6c7a0-270">Azure에서 SharePoint 복구 팜을 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-270">Deploy the SharePoint recovery farm in Azure.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-271">5단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-271">Phase 5</span></span>  <br/> |<span data-ttu-id="6c7a0-272">팜 간에 DFSR을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-272">Set up DFSR between the farms.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-273">6단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-273">Phase 6</span></span>  <br/> |<span data-ttu-id="6c7a0-274">복구 팜에 대한 로그 전달을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-274">Set up log shipping to the recovery farm.</span></span>  <br/> |
|<span data-ttu-id="6c7a0-275">7단계</span><span class="sxs-lookup"><span data-stu-id="6c7a0-275">Phase 7</span></span>  <br/> | <span data-ttu-id="6c7a0-276">장애 조치 및 복구 솔루션의 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-276">Validate failover and recovery solutions.</span></span> <span data-ttu-id="6c7a0-277">여기에는 다음 절차 및 기술이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-277">This includes the following procedures and technologies:</span></span> <br/>  <span data-ttu-id="6c7a0-278">로그 전달을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-278">Stop log shipping.</span></span> <br/>  <span data-ttu-id="6c7a0-279">백업을 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-279">Restore the backups.</span></span> <br/>  <span data-ttu-id="6c7a0-280">콘텐츠를 크롤링합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-280">Crawl content.</span></span> <br/>  <span data-ttu-id="6c7a0-281">서비스를 복구합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-281">Recover services.</span></span> <br/>  <span data-ttu-id="6c7a0-282">DNS 레코드 관리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-282">Manage DNS records.</span></span> <br/> |
   
## <a name="phase-1-design-the-disaster-recovery-environment"></a><span data-ttu-id="6c7a0-283">1단계: 재해 복구 환경 디자인</span><span class="sxs-lookup"><span data-stu-id="6c7a0-283">Phase 1: Design the disaster recovery environment</span></span>

<span data-ttu-id="6c7a0-284">Microsoft Azure [Architectures for SharePoint 2013의](microsoft-azure-architectures-for-sharepoint-2013.md) 지침을 사용하여 SharePoint 복구 팜을 비롯한 재해 복구 환경을 디자인합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-284">Use the guidance in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) to design the disaster-recovery environment, including the SharePoint recovery farm.</span></span> <span data-ttu-id="6c7a0-285">Azure Visio 파일의 [SharePoint 재해](https://go.microsoft.com/fwlink/p/?LinkId=392554) 복구 솔루션에 있는 그래픽을 사용하여 디자인 프로세스를 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-285">You can use the graphics in the [SharePoint Disaster Recovery Solution in Azure](https://go.microsoft.com/fwlink/p/?LinkId=392554) Visio file to start the design process.</span></span> <span data-ttu-id="6c7a0-286">Azure 환경에서 작업을 시작하기 전에 전체 환경을 디자인하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-286">We recommend that you design the entire environment before beginning any work in the Azure environment.</span></span>
  
<span data-ttu-id="6c7a0-287">가상 네트워크, VPN 연결, Active Directory 및 SharePoint 팜을 디자인하기 위해 [Microsoft Azure Architectures for SharePoint 2013에](microsoft-azure-architectures-for-sharepoint-2013.md) 제공된 지침 외에도 Azure 환경에 파일 공유 역할을 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-287">In addition to the guidance provided in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) for designing the virtual network, VPN connection, Active Directory, and SharePoint farm, be sure to add a file share role to the Azure environment.</span></span>
  
<span data-ttu-id="6c7a0-288">재해 복구 솔루션에서 로그 전달을 지원하기 위해 파일 공유 가상 컴퓨터는 데이터베이스 역할이 있는 서브넷에 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-288">To support log shipping in a disaster-recovery solution, a file share virtual machine is added to the subnet where the database roles reside.</span></span> <span data-ttu-id="6c7a0-289">또한 파일 공유는 AlwaysOn 가용성 그룹에 대한 노드 SQL Server 노드 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-289">The file share also serves as the third node of a Node Majority for the SQL Server AlwaysOn availability group.</span></span> <span data-ttu-id="6c7a0-290">이 구성은 AlwaysOn 가용성 그룹을 사용하는 표준 SharePoint SQL Server 권장되는 구성입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-290">This is the recommended configuration for a standard SharePoint farm that uses SQL Server AlwaysOn availability groups.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="6c7a0-291">데이터베이스가 AlwaysOn 가용성 그룹에 참여하려면 데이터베이스의 SQL Server 검토해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-291">It is important to review the prerequisites for a database to participate in a SQL Server AlwaysOn availability group.</span></span> <span data-ttu-id="6c7a0-292">자세한 내용은 AlwaysOn 가용성 그룹에 대한 선행 사항, 제한 사항 및 [권장 사항을 참조하세요.](/sql/database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-292">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups](/sql/database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability).</span></span> 
  
<span data-ttu-id="6c7a0-293">**그림: 재해 복구 솔루션에 사용되는 파일 서버 배치**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-293">**Figure: Placement of a file server used for a disaster recovery solution**</span></span>

![SharePoint 데이터베이스 서버 역할이 포함된 동일한 클라우드 서비스에 추가된 파일 공유 VM을 보여줍니다.](../media/AZenv-FSforDFSRandWSFC.png)
  
<span data-ttu-id="6c7a0-295">이 다이어그램에서 파일 공유 가상 컴퓨터는 데이터베이스 서버 역할을 포함하는 Azure의 동일한 서브넷에 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-295">In this diagram, a file share virtual machine is added to the same subnet in Azure that contains the database server roles.</span></span> <span data-ttu-id="6c7a0-296">파일 공유 가상 컴퓨터는 파일 공유 역할과 같은 다른 서버 역할과 함께 가용성 집합에 SQL Server 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-296">Do not add the file share virtual machine to an availability set with other server roles, such as the SQL Server roles.</span></span>
  
<span data-ttu-id="6c7a0-297">로그의 고가용성이 우려되는 경우 [Azure Blob Storage Service에서](/sql/relational-databases/backup-restore/sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service)SQL Server 백업 및 복원을 사용하여 다른 방법을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-297">If you are concerned about the high availability of the logs, consider taking a different approach by using [SQL Server backup and restore with Azure Blob Storage Service](/sql/relational-databases/backup-restore/sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service).</span></span> <span data-ttu-id="6c7a0-298">이 기능은 Blob Storage URL에 직접 로그를 저장하는 Azure의 새로운 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-298">This is a new feature in Azure that saves logs directly to a blob storage URL.</span></span> <span data-ttu-id="6c7a0-299">이 솔루션에는 이 기능 사용에 대한 지침이 포함되어 있지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-299">This solution does not include guidance about using this feature.</span></span>
  
<span data-ttu-id="6c7a0-300">복구 팜을 디자인할 때 성공적인 재해 복구 환경은 복구하려는 프로덕션 팜을 정확하게 반영합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-300">When you design the recovery farm, keep in mind that a successful disaster recovery environment accurately reflects the production farm that you want to recover.</span></span> <span data-ttu-id="6c7a0-301">복구 팜의 디자인, 배포 및 테스트에서 복구 팜의 크기가 가장 중요한 것은 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-301">The size of the recovery farm is not the most important thing in the recovery farm's design, deployment, and testing.</span></span> <span data-ttu-id="6c7a0-302">팜 규모는 비즈니스 요구 사항에 따라 조직마다 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-302">Farm scale varies from organization to organization based on business requirements.</span></span> <span data-ttu-id="6c7a0-303">짧은 시간 동안 또는 성능 및 용량 요구에 따라 팜을 확장해야 할 때까지 축소된 팜을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-303">It might be possible to use a scaled-down farm for a short outage or until performance and capacity demands require you to scale the farm.</span></span>
  
<span data-ttu-id="6c7a0-304">복구 팜이 SLA(서비스 수준 계약) 요구 사항을 충족하고 비즈니스를 지원하는 데 필요한 기능을 제공하도록 프로덕션 팜과 최대한 동일하게 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-304">Configure the recovery farm as identically as possible to the production farm so that it meets your service level agreement (SLA) requirements and provides the functionality that you need to support your business.</span></span> <span data-ttu-id="6c7a0-305">재해 복구 환경을 디자인할 때 프로덕션 환경에 대한 변경 관리 프로세스도 살펴 봐야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-305">When you design the disaster recovery environment, also look at your change management process for your production environment.</span></span> <span data-ttu-id="6c7a0-306">변경 관리 프로세스를 프로덕션 환경과 같은 간격으로 복구 환경을 업데이트하여 복구 환경으로 확장하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-306">We recommend that you extend the change management process to the recovery environment by updating the recovery environment at the same interval as the production environment.</span></span> <span data-ttu-id="6c7a0-307">변경 관리 프로세스의 일부로 팜 구성, 응용 프로그램 및 사용자의 자세한 인벤토리를 유지 관리하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-307">As part of the change management process, we recommend maintaining a detailed inventory of your farm configuration, applications, and users.</span></span> 
  
## <a name="phase-2-create-the-azure-virtual-network-and-vpn-connection"></a><span data-ttu-id="6c7a0-308">2단계: Azure Virtual Network 및 VPN 연결 만들기</span><span class="sxs-lookup"><span data-stu-id="6c7a0-308">Phase 2: Create the Azure virtual network and VPN connection</span></span>

<span data-ttu-id="6c7a0-309">[Microsoft Azure Virtual Network에](connect-an-on-premises-network-to-a-microsoft-azure-virtual-network.md) 사내 네트워크를 연결하면 Azure에서 가상 네트워크를 계획 및 배포하는 방법과 VPN 연결을 만드는 방법을 보여 주게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-309">[Connect an on-premises network to a Microsoft Azure virtual network](connect-an-on-premises-network-to-a-microsoft-azure-virtual-network.md) shows you how to plan and deploy the virtual network in Azure and how to create the VPN connection.</span></span> <span data-ttu-id="6c7a0-310">항목의 지침에 따라 다음 절차를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-310">Follow the guidance in the topic to complete the following procedures:</span></span>
  
- <span data-ttu-id="6c7a0-311">가상 네트워크의 개인 IP 주소 공간을 계획합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-311">Plan the private IP address space of the Virtual Network.</span></span>
    
- <span data-ttu-id="6c7a0-312">가상 네트워크의 라우팅 인프라 변경 사항을 계획합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-312">Plan the routing infrastructure changes for the Virtual Network.</span></span>
    
- <span data-ttu-id="6c7a0-313">사내 VPN 장치와의 트래픽에 대한 방화벽 규칙을 계획합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-313">Plan firewall rules for traffic to and from the on-premises VPN device.</span></span>
    
- <span data-ttu-id="6c7a0-314">Azure에서 프레미스 간 가상 네트워크를 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-314">Create the cross-premises virtual network in Azure.</span></span>
    
- <span data-ttu-id="6c7a0-315">사내 네트워크와 가상 네트워크 간의 라우팅을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-315">Configure routing between your on-premises network and the Virtual Network.</span></span>
    
## <a name="phase-3-deploy-active-directory-and-domain-name-services-to-the-azure-virtual-network"></a><span data-ttu-id="6c7a0-316">3단계: Azure Virtual Network에 Active Directory 및 도메인 이름 서비스 배포</span><span class="sxs-lookup"><span data-stu-id="6c7a0-316">Phase 3: Deploy Active Directory and Domain Name Services to the Azure virtual network</span></span>

<span data-ttu-id="6c7a0-317">이 단계에서는 다음 그림에 설명된 바와 같이 [Microsoft Azure Architectures for SharePoint 2013에](microsoft-azure-architectures-for-sharepoint-2013.md) 설명된 하이브리드 시나리오에서 Windows Server Active Directory와 DNS를 모두 가상 네트워크에 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-317">This phase includes deploying both Windows Server Active Directory and DNS to the Virtual Network in a hybrid scenario as described in [Microsoft Azure Architectures for SharePoint 2013](microsoft-azure-architectures-for-sharepoint-2013.md) and as illustrated in the following figure.</span></span>
  
<span data-ttu-id="6c7a0-318">**그림: 하이브리드 Active Directory 도메인 구성**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-318">**Figure: Hybrid Active Directory domain configuration**</span></span>

![Azure Virtual Network 및 SharePoint 팜 서브넷에 배포된 두 개의 가상 컴퓨터는 복제본 도메인 컨트롤러 및 DNS 서버입니다.](../media/AZarch-HyADdomainConfig.png)
  
<span data-ttu-id="6c7a0-320">그림에서 두 가상 컴퓨터는 동일한 서브넷에 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-320">In the illustration, two virtual machines are deployed to the same subnet.</span></span> <span data-ttu-id="6c7a0-321">이러한 가상 컴퓨터는 각각 Active Directory 및 DNS의 두 역할을 호스팅합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-321">These virtual machines are each hosting two roles: Active Directory and DNS.</span></span>
  
<span data-ttu-id="6c7a0-322">Azure에서 Active Directory를 배포하기 전에 Azure 가상 [머신에 Windows Server Active Directory를](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100)배포하기 위한 지침을 읽어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-322">Before deploying Active Directory in Azure, read [Guidelines for Deploying Windows Server Active Directory on Azure Virtual Machines](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100).</span></span> <span data-ttu-id="6c7a0-323">이러한 지침은 솔루션에 다른 아키텍처 또는 다른 구성 설정이 필요한지 여부를 결정하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-323">These guidelines help you determine whether you need a different architecture or different configuration settings for your solution.</span></span>
  
<span data-ttu-id="6c7a0-324">Azure에서 도메인 컨트롤러를 설정하는 방법에 대한 자세한 지침은 [Azure Virtual Networks에서 복제본 Active Directory 도메인 컨트롤러 설치를 참조하세요.](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-324">For detailed guidance on setting up a domain controller in Azure, see [Install a Replica Active Directory Domain Controller in Azure Virtual Networks](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100).</span></span>
  
<span data-ttu-id="6c7a0-325">이 단계 전에는 가상 컴퓨터를 가상 네트워크에 배포하지 않은 경우</span><span class="sxs-lookup"><span data-stu-id="6c7a0-325">Before this phase, you didn't deploy virtual machines to the Virtual Network.</span></span> <span data-ttu-id="6c7a0-326">Active Directory 및 DNS를 호스팅하기 위한 가상 컴퓨터는 솔루션에 필요한 최대 가상 컴퓨터는 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-326">The virtual machines for hosting Active Directory and DNS are likely not the largest virtual machines you need for the solution.</span></span> <span data-ttu-id="6c7a0-327">이러한 가상 컴퓨터를 배포하기 전에 먼저 가상 네트워크에서 사용할 가장 큰 가상 컴퓨터를 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-327">Before you deploy these virtual machines, first create the largest virtual machine that you plan to use in your Virtual Network.</span></span> <span data-ttu-id="6c7a0-328">이렇게 하면 솔루션이 필요한 최대 크기를 허용하는 Azure의 태그에 착수할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-328">This helps ensure that your solution lands on a tag in Azure that allows the largest size you need.</span></span> <span data-ttu-id="6c7a0-329">현재 이 가상 컴퓨터는 구성할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-329">You do not need to configure this virtual machine at this time.</span></span> <span data-ttu-id="6c7a0-330">간단히 만들고 옆으로 설정하기만 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-330">Simply create it, and set it aside.</span></span> <span data-ttu-id="6c7a0-331">이렇게 하지 않는 경우 나중에 이 문서가 작성될 때 문제인 더 큰 가상 컴퓨터를 만들려고 할 때 제한이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-331">If you do not do this, you might run into a limitation when you try to create larger virtual machines later, which was an issue at the time this article was written.</span></span> 
  
## <a name="phase-4-deploy-the-sharepoint-recovery-farm-in-azure"></a><span data-ttu-id="6c7a0-332">4단계: Azure에 SharePoint 복구 팜 배포</span><span class="sxs-lookup"><span data-stu-id="6c7a0-332">Phase 4: Deploy the SharePoint recovery farm in Azure</span></span>

<span data-ttu-id="6c7a0-333">디자인 계획에 따라 가상 네트워크에 SharePoint 팜을 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-333">Deploy the SharePoint farm in your Virtual Network according to your design plans.</span></span> <span data-ttu-id="6c7a0-334">Azure에서 SharePoint 역할을 배포하기 전에 Azure 인프라 서비스에서 [SharePoint 2013](/previous-versions/azure/dn275958(v=azure.100)) 계획을 검토하는 것이 유용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-334">It might be helpful to review [Planning for SharePoint 2013 on Azure Infrastructure Services](/previous-versions/azure/dn275958(v=azure.100)) before you deploy SharePoint roles in Azure.</span></span>
  
<span data-ttu-id="6c7a0-335">개념 증명 환경을 구축하여 배운 다음 사례를 고려합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-335">Consider the following practices that we learned by building our proof of concept environment:</span></span>
  
- <span data-ttu-id="6c7a0-336">Azure Portal 또는 PowerShell을 사용하여 가상 컴퓨터를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-336">Create virtual machines by using the Azure portal or PowerShell.</span></span>
    
- <span data-ttu-id="6c7a0-337">Azure 및 Hyper-V 동적 메모리를 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-337">Azure and Hyper-V do not support dynamic memory.</span></span> <span data-ttu-id="6c7a0-338">성능 및 용량 계획에 이러한 요소를 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-338">Be sure this is factored into your performance and capacity plans.</span></span>
    
- <span data-ttu-id="6c7a0-339">가상 컴퓨터 자체가 아니라 Azure 인터페이스를 통해 가상 컴퓨터를 다시 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-339">Restart virtual machines through the Azure interface, not from the virtual machine logon itself.</span></span> <span data-ttu-id="6c7a0-340">Azure 인터페이스를 사용하면 더 잘 작동하고 예측이 더 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-340">Using the Azure interface works better and is more predictable.</span></span>
    
- <span data-ttu-id="6c7a0-341">비용을 절약하기 위해 가상 컴퓨터를 종료하려는 경우 Azure 인터페이스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-341">If you want to shut down a virtual machine to save costs, use the Azure interface.</span></span> <span data-ttu-id="6c7a0-342">가상 컴퓨터 로그온을 종료하면 요금이 계속 증가합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-342">If you shut down from the virtual machine logon, charges continue to accrue.</span></span>
    
- <span data-ttu-id="6c7a0-343">가상 컴퓨터의 이름 규칙 사용</span><span class="sxs-lookup"><span data-stu-id="6c7a0-343">Use a naming convention for the virtual machines.</span></span>
    
- <span data-ttu-id="6c7a0-344">가상 컴퓨터를 배포하는 데이터 센터 위치에 주의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-344">Pay attention to which datacenter location the virtual machines are being deployed.</span></span>
    
- <span data-ttu-id="6c7a0-345">Azure의 자동 크기 조정 기능은 SharePoint 역할에 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-345">The automatic scaling feature in Azure is not supported for SharePoint roles.</span></span>
    
- <span data-ttu-id="6c7a0-346">복원할 팜의 항목(예: 사이트 모음)을 구성하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-346">Do not configure items in the farm that will be restored, such as site collections.</span></span> 
    
## <a name="phase-5-set-up-dfsr-between-the-farms"></a><span data-ttu-id="6c7a0-347">5단계: 팜 간에 DFSR 설정</span><span class="sxs-lookup"><span data-stu-id="6c7a0-347">Phase 5: Set up DFSR between the farms</span></span>

<span data-ttu-id="6c7a0-348">DFSR을 사용하여 파일 복제를 설정하기 위해 DNS 관리 스냅인을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-348">To set up file replication by using DFSR, use the DNS Management snap-in.</span></span> <span data-ttu-id="6c7a0-349">그러나 DFSR을 설정하기 전에,온-프레미스 파일 서버 및 Azure 파일 서버에 로그온하고 Windows에서 서비스를 사용하도록 설정하십시오.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-349">However, before the DFSR setup, log on to your on-premises file server and Azure file server and enable the service in Windows.</span></span>
  
<span data-ttu-id="6c7a0-350">서버 관리자 대시보드에서 다음 단계를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-350">From the Server Manager Dashboard, complete the following steps:</span></span>
  
- <span data-ttu-id="6c7a0-351">로컬 서버를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-351">Configure the local server.</span></span>
    
- <span data-ttu-id="6c7a0-352">**역할 및 기능 추가 마법사** 를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-352">Start the **Add Roles and Features Wizard**.</span></span>
    
- <span data-ttu-id="6c7a0-353">파일 및 **저장소 서비스 노드를 니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-353">Open the **File and Storage Services** node.</span></span>
    
- <span data-ttu-id="6c7a0-354">**DFS 네임스페이스** 및 **DFS 복제 를 선택합니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-354">Select **DFS Namespaces** and **DFS replication**.</span></span>
    
- <span data-ttu-id="6c7a0-355">**다음을** 클릭하여 마법사 단계를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-355">Click **Next** to finish the wizard steps.</span></span>
    
<span data-ttu-id="6c7a0-356">다음 표에서는 DFSR 참조 문서 및 블로그 게시물에 대한 링크를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-356">The following table provides links to DFSR reference articles and blog posts.</span></span>
  
<span data-ttu-id="6c7a0-357">**표: DFSR에 대한 참조 문서**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-357">**Table: Reference articles for DFSR**</span></span>

|<span data-ttu-id="6c7a0-358">**제목**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-358">**Title**</span></span>|<span data-ttu-id="6c7a0-359">**설명**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-359">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c7a0-360">[복제](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770278(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="6c7a0-360">[Replication](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770278(v=ws.11))</span></span> <br/> |<span data-ttu-id="6c7a0-361">복제 링크가 있는 DFS 관리 TechNet 항목</span><span class="sxs-lookup"><span data-stu-id="6c7a0-361">DFS Management TechNet topic with links for replication</span></span>  <br/> |
|[<span data-ttu-id="6c7a0-362">DFS 복제: 서바이벌 가이드</span><span class="sxs-lookup"><span data-stu-id="6c7a0-362">DFS Replication: Survival Guide</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=392737) <br/> |<span data-ttu-id="6c7a0-363">DFS 정보에 대한 링크가 있는 Wiki</span><span class="sxs-lookup"><span data-stu-id="6c7a0-363">Wiki with links to DFS information</span></span>  <br/> |
|<span data-ttu-id="6c7a0-364">[DFS 복제: 질문과 대답](/previous-versions/windows/it-pro/windows-server-2003/cc773238(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="6c7a0-364">[DFS Replication: Frequently Asked Questions](/previous-versions/windows/it-pro/windows-server-2003/cc773238(v=ws.10))</span></span> <br/> |<span data-ttu-id="6c7a0-365">DFS 복제 TechNet 항목</span><span class="sxs-lookup"><span data-stu-id="6c7a0-365">DFS Replication TechNet topic</span></span>  <br/> |
|[<span data-ttu-id="6c7a0-366">Jose Barreto의 블로그</span><span class="sxs-lookup"><span data-stu-id="6c7a0-366">Jose Barreto's Blog</span></span>](/archive/blogs/josebda/) <br/> |<span data-ttu-id="6c7a0-367">Microsoft 파일 서버 팀의 보안 주체 프로그램 관리자가 작성한 블로그</span><span class="sxs-lookup"><span data-stu-id="6c7a0-367">Blog written by a Principal Program Manager on the File Server team at Microsoft</span></span>  <br/> |
|[<span data-ttu-id="6c7a0-368">Microsoft의 저장소 팀 - 파일 캐비닛 블로그</span><span class="sxs-lookup"><span data-stu-id="6c7a0-368">The Storage Team at Microsoft - File Cabinet Blog</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=392740) <br/> |<span data-ttu-id="6c7a0-369">Windows Server의 파일 서비스 및 저장소 기능에 대한 블로그</span><span class="sxs-lookup"><span data-stu-id="6c7a0-369">Blog about file services and storage features in Windows Server</span></span>  <br/> |
   
## <a name="phase-6-set-up-log-shipping-to-the-recovery-farm"></a><span data-ttu-id="6c7a0-370">6단계: 복구 팜에 대한 로그 전달 설정</span><span class="sxs-lookup"><span data-stu-id="6c7a0-370">Phase 6: Set up log shipping to the recovery farm</span></span>

<span data-ttu-id="6c7a0-371">로그 전달은 이 환경에서 재해 복구를 설정하는 데 중요한 구성 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-371">Log shipping is the critical component for setting up disaster recovery in this environment.</span></span> <span data-ttu-id="6c7a0-372">로그 전달을 사용하여 기본 데이터베이스 서버 인스턴스에서 보조 데이터베이스 서버 인스턴스로 데이터베이스에 대한 트랜잭션 로그 파일을 자동으로 보낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-372">You can use log shipping to automatically send transaction log files for databases from a primary database server instance to a secondary database server instance.</span></span> <span data-ttu-id="6c7a0-373">로그 전달을 설정하려면 [Configure log shipping in SharePoint 2013을 참조합니다.](/sharepoint/administration/configure-log-shipping)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-373">To set up log shipping, see [Configure log shipping in SharePoint 2013](/sharepoint/administration/configure-log-shipping).</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="6c7a0-374">SharePoint Server의 로그 전달 지원은 특정 데이터베이스로 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-374">Log shipping support in SharePoint Server is limited to certain databases.</span></span> <span data-ttu-id="6c7a0-375">자세한 내용은 [Supported high availability and disaster recovery options for SharePoint databases (SharePoint 2013)을 참조하십시오.](/SharePoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-375">For more information, see [Supported high availability and disaster recovery options for SharePoint databases (SharePoint 2013)](/SharePoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas).</span></span> 
  
## <a name="phase-7-validate-failover-and-recovery"></a><span data-ttu-id="6c7a0-376">7단계: 장애 조치 및 복구 유효성 검사</span><span class="sxs-lookup"><span data-stu-id="6c7a0-376">Phase 7: Validate failover and recovery</span></span>

<span data-ttu-id="6c7a0-377">이 최종 단계의 목표는 재해 복구 솔루션이 계획대로 작동하는지 확인하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-377">The goal of this final phase is to verify that the disaster recovery solution works as planned.</span></span> <span data-ttu-id="6c7a0-378">이렇게 하여 프로덕션 팜을 종료하고 대체 복구 팜을 시작하는 장애 조치(failover) 이벤트를 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-378">To do this, create a failover event that shuts down the production farm and starts up the recovery farm as a replacement.</span></span> <span data-ttu-id="6c7a0-379">수동으로 또는 스크립트를 사용하여 장애 조치 시나리오를 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-379">You can start a failover scenario manually or by using scripts.</span></span>
  
<span data-ttu-id="6c7a0-380">첫 번째 단계는 팜 서비스 또는 콘텐츠에 대한 들어오는 사용자 요청을 중지하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-380">The first step is to stop incoming user requests for farm services or content.</span></span> <span data-ttu-id="6c7a0-381">DNS 항목을 사용하지 못하게 설정하거나 프런트 엔드 웹 서버를 종료하여 이 작업을 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-381">You can do this by disabling DNS entries or by shutting down the front-end web servers.</span></span> <span data-ttu-id="6c7a0-382">팜이 "다운"된 후 복구 팜으로 장애 조치(fail over)할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-382">After the farm is "down," you can fail over to the recovery farm.</span></span>
  
### <a name="stop-log-shipping"></a><span data-ttu-id="6c7a0-383">로그 전달 중지</span><span class="sxs-lookup"><span data-stu-id="6c7a0-383">Stop log shipping</span></span>

<span data-ttu-id="6c7a0-384">팜 복구 전에 로그 전달을 중지해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-384">You must stop log shipping before farm recovery.</span></span> <span data-ttu-id="6c7a0-385">먼저 Azure의 보조 서버에서 로그 전달을 중지한 다음 기본 서버의 사내에서 로그 전달을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-385">Stop log shipping on the secondary server in Azure first, and then stop it on the primary server on-premises.</span></span> <span data-ttu-id="6c7a0-386">다음 스크립트를 사용하여 보조 서버에서 먼저 로그 전달을 중지한 다음 기본 서버에서 로그 전달을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-386">Use the following script to stop log shipping on the secondary server first and then on the primary server.</span></span> <span data-ttu-id="6c7a0-387">스크립트의 데이터베이스 이름은 환경에 따라 다를 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-387">The database names in the script might be different, depending on your environment.</span></span>
  
```
-- This script removes log shipping from the server.
-- Commands must be executed on the secondary server first and then on the primary server.

SET NOCOUNT ON
DECLARE  @PriDB nvarchar(max)
,@SecDB nvarchar(250)
,@PriSrv nvarchar(250)
,@SecSrv nvarchar(250)

Set @PriDB= ''
SET @PriDB = UPPER(@PriDB)
SET @PriDB = REPLACE(@PriDB, ' ', '')
SET @PriDB = '''' + REPLACE(@PriDB, ',', ''', ''') + ''''

Set @SecDB = @PriDB

Exec ( 'Select  ''exec master..sp_delete_log_shipping_secondary_database '' + '''''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_primary_secondary '' + '''''''' + prm.Primary_Database + '''''', '''''' + sec.Secondary_Server + '''''', '''''' + sec.Secondary_database + ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_primary_database '' + '''''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

Exec ( 'Select  ''exec master..sp_delete_log_shipping_secondary_primary '' + '''''''' + prm.primary_server + '''''', '''''' + prm.primary_database +  ''''''''   
from msdb.dbo.log_shipping_monitor_primary prm INNER JOIN msdb.dbo.log_shipping_primary_secondaries sec  ON  prm.primary_database=sec.secondary_database
where prm.primary_database in ( ' + @PriDB + ' )')

```

### <a name="restore-the-backups"></a><span data-ttu-id="6c7a0-388">백업 복원</span><span class="sxs-lookup"><span data-stu-id="6c7a0-388">Restore the backups</span></span>

<span data-ttu-id="6c7a0-389">백업을 만든 순서대로 복원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-389">Backups must be restored in the order in which they were created.</span></span> <span data-ttu-id="6c7a0-390">특정 트랜잭션 로그 백업을 복원하려면 먼저 커밋되지 않은 트랜잭션(즉, 을 사용하여)을 롤백하지 않고 다음 이전 백업을 복원해야  `WITH NORECOVERY` 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-390">Before you can restore a particular transaction log backup, you must first restore the following previous backups without rolling back uncommitted transactions (that is, by using  `WITH NORECOVERY`):</span></span>
  
- <span data-ttu-id="6c7a0-391">전체 데이터베이스 백업 및 마지막 차분 백업 - 이러한 백업(있는 경우)을 특정 트랜잭션 로그 백업 전에 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-391">The full database backup and the last differential backup - Restore these backups, if any exist, taken before the particular transaction log backup.</span></span> <span data-ttu-id="6c7a0-392">가장 최근의 전체 또는 차분 데이터베이스 백업을 만들기 전에 데이터베이스는 전체 복구 모델 또는 대량으로 기록된 복구 모델을 사용했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-392">Before the most recent full or differential database backup was created, the database was using the full recovery model or bulk-logged recovery model.</span></span>
    
- <span data-ttu-id="6c7a0-393">모든 트랜잭션 로그 백업 - 전체 데이터베이스 백업 또는 차분 백업(복원하는 경우)과 특정 트랜잭션 로그 백업 이전의 모든 트랜잭션 로그 백업을 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-393">All transaction log backups - Restore any transaction log backups taken after the full database backup or the differential backup (if you restore one) and before the particular transaction log backup.</span></span> <span data-ttu-id="6c7a0-394">로그 백업은 로그 체인의 간격 없이 백업을 만든 순서대로 적용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-394">Log backups must be applied in the sequence in which they were created, without any gaps in the log chain.</span></span>
    
<span data-ttu-id="6c7a0-395">사이트가 렌더링될 수 있도록 보조 서버의 콘텐츠 데이터베이스를 복구하려면 복구 전에 모든 데이터베이스 연결을 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-395">To recover the content database on the secondary server so that the sites render, remove all database connections before recovery.</span></span> <span data-ttu-id="6c7a0-396">데이터베이스를 복원하려면 다음 SQL 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-396">To restore the database, run the following SQL statement.</span></span>
  
```
restore database WSS_Content with recovery

```

> [!IMPORTANT]
> <span data-ttu-id="6c7a0-397">T-SQL 명시적으로 사용하는 경우 모호성을 없애기 위해 모든 RESTORE 문에 **WITH NORECOVERY** 또는 **WITH RECOVERY를** 지정합니다. 스크립트를 쓸 때 이 점은 매우 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-397">When you use T-SQL explicitly, specify either **WITH NORECOVERY** or **WITH RECOVERY** in every RESTORE statement to eliminate ambiguity—this is very important when writing scripts.</span></span> <span data-ttu-id="6c7a0-398">전체 및 차분 백업을 복원한 후 트랜잭션 로그를 복원할 수 SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-398">After the full and differential backups are restored, the transaction logs can be restored in SQL Server Management Studio.</span></span> <span data-ttu-id="6c7a0-399">또한 로그 전달이 이미 중지되어 있으므로 콘텐츠 데이터베이스는 대기 상태이기 때문에 상태를 모든 액세스로 변경해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-399">Also, because log shipping is already stopped, the content database is in a standby state, so you must change the state to full access.</span></span>
  
<span data-ttu-id="6c7a0-400">SQL Server Management Studio 데이터베이스를 마우스 오른쪽 단추로 **클릭하고** WSS_Content 복원을 클릭한 다음 트랜잭션 로그를 클릭합니다(전체 백업을 복원하지 않은 경우 사용할 수   >  없습니다). </span><span class="sxs-lookup"><span data-stu-id="6c7a0-400">In SQL Server Management Studio, right-click the **WSS_Content** database, point to **Tasks** > **Restore**, and then click **Transaction Log** (if you have not restored the full backup, this is not available).</span></span> <span data-ttu-id="6c7a0-401">자세한 내용은[Restore a Transaction Log Backup (SQL Server)을 참조하십시오.](/sql/relational-databases/backup-restore/restore-a-transaction-log-backup-sql-server)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-401">For more information, see[Restore a Transaction Log Backup (SQL Server)](/sql/relational-databases/backup-restore/restore-a-transaction-log-backup-sql-server).</span></span>
  
### <a name="crawl-the-content-source"></a><span data-ttu-id="6c7a0-402">콘텐츠 원본 크롤링</span><span class="sxs-lookup"><span data-stu-id="6c7a0-402">Crawl the content source</span></span>

<span data-ttu-id="6c7a0-403">Search Service를 복원하려면 각 콘텐츠 원본에 대해 전체 크롤링을 시작해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-403">You must start a full crawl for each content source to restore the Search Service.</span></span> <span data-ttu-id="6c7a0-404">검색 권장 사항과 같은 일부 분석 정보가 사내 팜에서 손실됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-404">Note that you lose some analytics information from the on-premises farm, such as search recommendations.</span></span> <span data-ttu-id="6c7a0-405">전체 크롤링을 시작하기 전에 **restore-Windows PowerShell spEnterpriseSearchServiceApplication cmdlet Restore-SPEnterpriseSearchServiceApplication** cmdlet을 사용하여 로그를 발송하고 복제된 검색 **관리 <GUID>** 데이터베이스(를 Search_Service__DB_.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-405">Before you start the full crawls, use the Windows PowerShell cmdlet **Restore-SPEnterpriseSearchServiceApplication** and specify the log-shipped and replicated Search Administration database, **Search_Service__DB_<GUID>**.</span></span> <span data-ttu-id="6c7a0-406">이 cmdlet은 검색 구성, schema, 관리 속성, 규칙 및 원본을 제공하며 다른 구성 요소의 기본 집합을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-406">This cmdlet gives the search configuration, schema, managed properties, rules, and sources and creates a default set of the other components.</span></span>
  
<span data-ttu-id="6c7a0-407">전체 크롤링을 시작하기 위해 다음 단계를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-407">To start a full crawl, complete the following steps:</span></span>
  
1. <span data-ttu-id="6c7a0-408">SharePoint 2013 중앙 관리에서 **응용** 프로그램 관리 서비스 응용 프로그램 관리 서비스 응용 프로그램으로 이동한 다음 크롤링할 Search Service 응용 프로그램을  >    >  클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-408">In the SharePoint 2013 Central Administration, go to **Application Management** > **Service Applications** > **Manage service applications**, and then click the Search Service application that you want to crawl.</span></span>
    
2. <span data-ttu-id="6c7a0-409">검색 **관리 페이지에서** 콘텐츠 **원본을** 클릭하고 원하는 콘텐츠 원본을 가리 클릭하고 화살표를 클릭한 다음 전체 크롤링 시작 **을 클릭합니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-409">On the **Search Administration** page, click **Content Sources**, point to the content source that you want, click the arrow, and then click **Start Full Crawl**.</span></span>
    
### <a name="recover-farm-services"></a><span data-ttu-id="6c7a0-410">팜 서비스 복구</span><span class="sxs-lookup"><span data-stu-id="6c7a0-410">Recover farm services</span></span>

<span data-ttu-id="6c7a0-411">다음 표에서는 로그 전달 데이터베이스가 있는 서비스, 데이터베이스가 있지만 로그 전달을 사용하여 복원하지 않는 서비스 및 데이터베이스가 없는 서비스를 복구하는 방법을 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-411">The following table shows how to recover services that have log-shipped databases, the services that have databases but are not recommended to restore with log shipping, and the services that do not have databases.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="6c7a0-412">Azure 환경으로 On-premises SharePoint 데이터베이스를 복원하면 아직 Azure에 설치하지 않은 SharePoint 서비스가 복구되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-412">Restoring an on-premises SharePoint database into the Azure environment will not recover any SharePoint services that you did not already install in Azure manually.</span></span> 
  
<span data-ttu-id="6c7a0-413">**표: 서비스 응용 프로그램 데이터베이스 참조**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-413">**Table: Service application database reference**</span></span>

|<span data-ttu-id="6c7a0-414">**로그 제공 데이터베이스에서 이러한 서비스 복원**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-414">**Restore these services from log-shipped databases**</span></span>|<span data-ttu-id="6c7a0-415">**이러한 서비스에는 데이터베이스가 있지만 데이터베이스를 복원하지 않고 이러한 서비스를 시작하는 것이 좋습니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-415">**These services have databases, but we recommend that you start these services without restoring their databases**</span></span>|<span data-ttu-id="6c7a0-416">**이러한 서비스는 데이터베이스에 데이터를 저장하지 않습니다. 장애 조치(failover) 후 이러한 서비스 시작**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-416">**These services do not store data in databases; start these services after failover**</span></span>|
|:-----|:-----|:-----|
| <span data-ttu-id="6c7a0-417">기계 번역 서비스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-417">Machine Translation Service</span></span> <br/>  <span data-ttu-id="6c7a0-418">Managed Metadata Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-418">Managed Metadata Service</span></span> <br/>  <span data-ttu-id="6c7a0-419">Secure Store Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-419">Secure Store Service</span></span> <br/>  <span data-ttu-id="6c7a0-420">사용자 프로필.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-420">User Profile.</span></span> <span data-ttu-id="6c7a0-421">프로필 및 공유 태그 지정 데이터베이스만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-421">(Only the Profile and Social Tagging databases are supported.</span></span> <span data-ttu-id="6c7a0-422">동기화 데이터베이스는 지원되지 않습니다.)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-422">The Synchronization database is not supported.)</span></span> <br/>  <span data-ttu-id="6c7a0-423">Microsoft SharePoint Foundation 가입 설정 서비스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-423">Microsoft SharePoint Foundation Subscription Settings Service</span></span> <br/> | <span data-ttu-id="6c7a0-424">Usage and Health Data Collection</span><span class="sxs-lookup"><span data-stu-id="6c7a0-424">Usage and Health Data Collection</span></span> <br/>  <span data-ttu-id="6c7a0-425">State Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-425">State service</span></span> <br/>  <span data-ttu-id="6c7a0-426">Word 자동화</span><span class="sxs-lookup"><span data-stu-id="6c7a0-426">Word automation</span></span> <br/> | <span data-ttu-id="6c7a0-427">Excel Services</span><span class="sxs-lookup"><span data-stu-id="6c7a0-427">Excel Services</span></span> <br/>  <span data-ttu-id="6c7a0-428">PerformancePoint Services</span><span class="sxs-lookup"><span data-stu-id="6c7a0-428">PerformancePoint Services</span></span> <br/>  <span data-ttu-id="6c7a0-429">PowerPoint Conversion</span><span class="sxs-lookup"><span data-stu-id="6c7a0-429">PowerPoint Conversion</span></span> <br/>  <span data-ttu-id="6c7a0-430">Visio Graphics Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-430">Visio Graphics Service</span></span> <br/>  <span data-ttu-id="6c7a0-431">작업 관리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-431">Work Management</span></span> <br/> |
   
<span data-ttu-id="6c7a0-432">다음 예제에서는 데이터베이스에서 Managed Metadata Service를 복원하는 방법을 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-432">The following example shows how to restore the Managed Metadata service from a database.</span></span>
  
<span data-ttu-id="6c7a0-433">이 경우 기존 데이터베이스 Managed_Metadata_DB 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-433">This uses the existing Managed_Metadata_DB database.</span></span> <span data-ttu-id="6c7a0-434">이 데이터베이스는 로그가 제공되지만 보조 팜에는 활성 서비스 응용 프로그램이 있으므로 서비스 응용 프로그램을 적용한 후에 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-434">This database is log shipped, but there is no active service application on the secondary farm, so it needs to be connected after the service application is in place.</span></span>
  
<span data-ttu-id="6c7a0-435">먼저 를 사용하여 복원된 데이터베이스의 이름으로  `New-SPMetadataServiceApplication`  `DatabaseName` 스위치를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-435">First, use  `New-SPMetadataServiceApplication`, and specify the  `DatabaseName` switch with the name of the restored database.</span></span>
  
<span data-ttu-id="6c7a0-436">다음으로 보조 서버에서 다음과 같이 새 Managed Metadata Service 응용 프로그램을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-436">Next, configure the new Managed Metadata Service Application on the secondary server, as follows:</span></span>
  
- <span data-ttu-id="6c7a0-437">이름: Managed Metadata Service</span><span class="sxs-lookup"><span data-stu-id="6c7a0-437">Name: Managed Metadata Service</span></span>
    
- <span data-ttu-id="6c7a0-438">데이터베이스 서버: 선적된 트랜잭션 로그의 데이터베이스 이름</span><span class="sxs-lookup"><span data-stu-id="6c7a0-438">Database server: The database name from the shipped transaction log</span></span>
    
- <span data-ttu-id="6c7a0-439">데이터베이스 이름: Managed_Metadata_DB</span><span class="sxs-lookup"><span data-stu-id="6c7a0-439">Database name: Managed_Metadata_DB</span></span>
    
- <span data-ttu-id="6c7a0-440">응용 프로그램 풀: SharePoint 서비스 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="6c7a0-440">Application pool: SharePoint Service Applications</span></span> 
    
### <a name="manage-dns-records"></a><span data-ttu-id="6c7a0-441">DNS 레코드 관리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-441">Manage DNS records</span></span>

<span data-ttu-id="6c7a0-442">SharePoint 팜을 설정하려면 DNS 레코드를 수동으로 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-442">You must manually create DNS records to point to your SharePoint farm.</span></span>
  
<span data-ttu-id="6c7a0-443">프런트 엔드 웹 서버가 여러 대인 대부분의 경우 팜의 웹 프런트 엔드 서버로 요청을 분산하기 위해 Windows Server 2012 또는 하드웨어 부하 분산 기능의 네트워크 부하 분산 기능을 활용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-443">In most cases where you have multiple front-end web servers, it makes sense to take advantage of the Network Load Balancing feature in Windows Server 2012 or a hardware load balancer to distribute requests among the web-front-end servers in your farm.</span></span> <span data-ttu-id="6c7a0-444">또한 웹 프런트 엔드 서버 중 하나에 오류가 발생하면 네트워크 부하 분산을 통해 요청을 다른 서버로 분산하여 위험을 줄일 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-444">Network load balancing can also help reduce risk by distributing requests to the other servers if one of your web-front-end servers fails.</span></span> 
  
<span data-ttu-id="6c7a0-445">일반적으로 네트워크 부하 분산을 설정할 때 클러스터에 단일 IP 주소가 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-445">Typically, when you set up network load balancing, your cluster is assigned a single IP address.</span></span> <span data-ttu-id="6c7a0-446">그런 다음 클러스터를 지점으로 하는 네트워크의 DNS 공급자에 DNS 호스트 레코드를 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-446">You then create a DNS host record in the DNS provider for your network that points to the cluster.</span></span> <span data-ttu-id="6c7a0-447">(이 프로젝트의 경우, Azure에 DNS 서버를 추가하여, 프레미스 데이터 센터 오류 시 복구를 위해 넣습니다.) 예를 들어 Active Directory의 DNS 관리자에서 부하가 균형이 조정된 클러스터의 IP 주소를 지점으로 하는 DNS 레코드(예: 를 만들  `https://sharepoint.contoso.com` 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-447">(For this project, we put a DNS server in Azure for resiliency in case of an on-premises datacenter failure.) For instance, you can create a DNS record, in DNS Manager in Active Directory, for example, called  `https://sharepoint.contoso.com`, that points to the IP address for your load-balanced cluster.</span></span>
  
<span data-ttu-id="6c7a0-448">SharePoint 팜에 대한 외부 액세스의 경우 클라이언트가 인트라넷에서 사용하는 URL(예: )을 사용하여 외부 DNS 서버에 방화벽의 외부 IP 주소를 지정하는 호스트 레코드를 만들 수 `https://sharepoint.contoso.com` 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-448">For external access to your SharePoint farm, you can create a host record on an external DNS server with the same URL that clients use on your intranet (for example, `https://sharepoint.contoso.com`) that points to an external IP address in your firewall.</span></span> <span data-ttu-id="6c7a0-449">이 예제를 사용하는 모범 사례는 내부 DNS 서버가 요청을 외부 DNS 서버로 라우팅하는 대신 내부 DNS 서버에 대한 권한을 가지고 요청을 SharePoint 팜 클러스터로 직접 라우팅할 수 있도록 분할된 DNS를 설정하는 `contoso.com` 것입니다. 그런 다음 클라이언트가 찾고 있는 리소스를 찾게 외부 IP 주소를 사내 클러스터의 내부 IP 주소에 매핑할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-449">(A best practice, using this example, is to set up split DNS so that the internal DNS server is authoritative for `contoso.com` and routes requests directly to the SharePoint farm cluster, rather than routing DNS requests to your external DNS server.) You can then map the external IP address to the internal IP address of your on-premises cluster so that clients find the resources they are looking for.</span></span>
  
<span data-ttu-id="6c7a0-450">여기서는 다음과 같은 몇 가지 재해 복구 시나리오가 실행될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-450">From here, you might run into a couple of different disaster-recovery scenarios:</span></span>
  
 <span data-ttu-id="6c7a0-451">**예제 시나리오: 사내 SharePoint 팜의 하드웨어 오류로 인한 사내 SharePoint 팜을 사용할 수 없습니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-451">**Example scenario: The on-premises SharePoint farm is unavailable because of hardware failure in the on-premises SharePoint farm.**</span></span> <span data-ttu-id="6c7a0-452">이 경우 Azure SharePoint 팜에 대한 장애 조치(failover) 단계를 완료한 후 복구 SharePoint 팜의 웹 프런트 엔드 서버에서와 같은 방법으로 네트워크 부하 분산을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-452">In this case, after you have completed the steps for failover to the Azure SharePoint farm, you can configure network load balancing on the recovery SharePoint farm's web-front-end servers, the same way you did with the on-premises farm.</span></span> <span data-ttu-id="6c7a0-453">그런 다음 내부 DNS 공급자의 호스트 레코드가 복구 팜의 클러스터 IP 주소를 지점으로 리디렉션할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-453">You can then redirect the host record in your internal DNS provider to point to the recovery farm's cluster IP address.</span></span> <span data-ttu-id="6c7a0-454">클라이언트의 캐시된 DNS 레코드를 새로 고치고 복구 팜을 설정하기까지 다소 시간이 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-454">Note that it can take some time before cached DNS records on clients are refreshed and point to the recovery farm.</span></span>
  
 <span data-ttu-id="6c7a0-455">**예제 시나리오: 사내 데이터 센터가 완전히 손실됩니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-455">**Example scenario: The on-premises datacenter is lost completely.**</span></span> <span data-ttu-id="6c7a0-456">이 시나리오는 화재나 홍수와 같은 자연 재해로 인해 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-456">This scenario might occur due to a natural disaster, such as a fire or flood.</span></span> <span data-ttu-id="6c7a0-457">이 경우 엔터프라이즈의 경우 자체 디렉터리 서비스와 DNS가 있는 Azure 서브넷뿐만 아니라 다른 지역에서 호스트되는 보조 데이터 센터가 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-457">In this case, for an enterprise, you would likely have a secondary datacenter hosted in another region as well as your Azure subnet that has its own directory services and DNS.</span></span> <span data-ttu-id="6c7a0-458">이전 재해 시나리오에서와 동일하게 Azure SharePoint 팜을 지점으로 내부 및 외부 DNS 레코드를 리디렉션할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-458">As in the previous disaster scenario, you can redirect your internal and external DNS records to point to the Azure SharePoint farm.</span></span> <span data-ttu-id="6c7a0-459">다시 DNS 레코드 전파에는 시간이 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-459">Again, take note that DNS-record propagation can take some time.</span></span>
  
<span data-ttu-id="6c7a0-460">[Host-named site collection architecture and deployment (SharePoint 2013)에서](/SharePoint/administration/host-named-site-collection-architecture-and-deployment)권장하는 호스트 이름으로 된 사이트 모음을 사용하는 경우 SharePoint 팜의 동일한 웹 응용 프로그램에서 호스트되는 여러 사이트 모음이 있으며 고유한 DNS 이름(예: 및 )이 있을 수 있습니다. `https://sales.contoso.com` `https://marketing.contoso.com`</span><span class="sxs-lookup"><span data-stu-id="6c7a0-460">If you are using host-named site collections, as recommended in [Host-named site collection architecture and deployment (SharePoint 2013)](/SharePoint/administration/host-named-site-collection-architecture-and-deployment), you might have several site collections hosted by the same web application in your SharePoint farm, with unique DNS names (for example, `https://sales.contoso.com` and `https://marketing.contoso.com`).</span></span> <span data-ttu-id="6c7a0-461">이 경우 클러스터 IP 주소를 지점하는 각 사이트 모음에 대한 DNS 레코드를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-461">In this case, you can create DNS records for each site collection that point to your cluster IP address.</span></span> <span data-ttu-id="6c7a0-462">요청이 SharePoint 웹 프런트 엔드 서버에 도달하면 각 요청을 적절한 사이트 모음으로 라우팅하는 작업을 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-462">After a request reaches your SharePoint web-front-end servers, they handle routing each request to the appropriate site collection.</span></span>
  
## <a name="microsoft-proof-of-concept-environment"></a><span data-ttu-id="6c7a0-463">Microsoft 개념 증명 환경</span><span class="sxs-lookup"><span data-stu-id="6c7a0-463">Microsoft proof-of-concept environment</span></span>

<span data-ttu-id="6c7a0-464">이 솔루션에 대한 개념 증명 환경을 설계하고 테스트했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-464">We designed and tested a proof-of-concept environment for this solution.</span></span> <span data-ttu-id="6c7a0-465">테스트 환경의 디자인 목표는 고객 환경에서 찾을 수 있는 SharePoint 팜을 배포하고 복구하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-465">The design goal for our test environment was to deploy and recover a SharePoint farm that we might find in a customer environment.</span></span> <span data-ttu-id="6c7a0-466">몇 가지 가정을 했지만 사용자 지정 없이 팜이 모든 바로 사용 기능을 제공하는 데 필요한 것으로 알고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-466">We made several assumptions, but we knew that the farm needed to provide all of the out-of-the-box functionality without any customizations.</span></span> <span data-ttu-id="6c7a0-467">토폴로지는 필드 및 제품 그룹의 모범 사례 지침을 사용하여 고가용성을 위해 디자인된 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-467">The topology was designed for high availability by using best practice guidance from the field and product group.</span></span>
  
<span data-ttu-id="6c7a0-468">다음 표에서는 Hyper-V 테스트 환경에 대해 만들어 구성한 가상 컴퓨터의 구성에 대해 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-468">The following table describes the Hyper-V virtual machines that we created and configured for the on-premises test environment.</span></span>
  
<span data-ttu-id="6c7a0-469">**표: 사내 테스트용 가상 컴퓨터**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-469">**Table: Virtual machines for on-premises test**</span></span>

|<span data-ttu-id="6c7a0-470">**서버 이름**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-470">**Server name**</span></span>|<span data-ttu-id="6c7a0-471">**역할**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-471">**Role**</span></span>|<span data-ttu-id="6c7a0-472">**구성**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-472">**Configuration**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="6c7a0-473">DC1</span><span class="sxs-lookup"><span data-stu-id="6c7a0-473">DC1</span></span>  <br/> |<span data-ttu-id="6c7a0-474">Active Directory가 있는 도메인 컨트롤러.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-474">Domain controller with Active Directory.</span></span>  <br/> |<span data-ttu-id="6c7a0-475">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-475">Two processors</span></span>  <br/> <span data-ttu-id="6c7a0-476">512MB에서 4GB RAM까지</span><span class="sxs-lookup"><span data-stu-id="6c7a0-476">From 512 MB through 4 GB of RAM</span></span>  <br/> <span data-ttu-id="6c7a0-477">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-477">1 x 127-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="6c7a0-478">RRAS</span><span class="sxs-lookup"><span data-stu-id="6c7a0-478">RRAS</span></span>  <br/> |<span data-ttu-id="6c7a0-479">RRAS(라우팅 및 원격 액세스 서비스) 역할로 구성된 서버입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-479">Server configured with the Routing and Remote Access Service (RRAS) role.</span></span>  <br/> |<span data-ttu-id="6c7a0-480">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-480">Two processors</span></span>  <br/> <span data-ttu-id="6c7a0-481">2-8GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-481">2-8 GB of RAM</span></span>  <br/> <span data-ttu-id="6c7a0-482">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-482">1 x 127-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="6c7a0-483">FS1</span><span class="sxs-lookup"><span data-stu-id="6c7a0-483">FS1</span></span>  <br/> |<span data-ttu-id="6c7a0-484">백업에 대한 공유가 있는 파일 서버 및 DFSR의 끝점입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-484">File server with shares for backups and an end point for DFSR.</span></span>  <br/> |<span data-ttu-id="6c7a0-485">프로세서 4개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-485">Four processors</span></span>  <br/> <span data-ttu-id="6c7a0-486">2-12GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-486">2-12 GB of RAM</span></span>  <br/> <span data-ttu-id="6c7a0-487">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-487">1 x 127-GB hard disk</span></span>  <br/> <span data-ttu-id="6c7a0-488">SAN(하드 디스크 1개) 1개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-488">1 x 1-TB hard disk (SAN)</span></span>  <br/> <span data-ttu-id="6c7a0-489">750GB 하드 디스크 1개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-489">1 x 750-GB hard disk</span></span>  <br/> |
|<span data-ttu-id="6c7a0-490">SP-WFE1, SP-WFE2</span><span class="sxs-lookup"><span data-stu-id="6c7a0-490">SP-WFE1, SP-WFE2</span></span>  <br/> |<span data-ttu-id="6c7a0-491">프런트 엔드 웹 서버.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-491">Front-end web servers.</span></span>  <br/> |<span data-ttu-id="6c7a0-492">프로세서 4개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-492">Four processors</span></span>  <br/> <span data-ttu-id="6c7a0-493">16GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-493">16 GB of RAM</span></span>  <br/> |
|<span data-ttu-id="6c7a0-494">SP-APP1, SP-APP2, SP-APP3</span><span class="sxs-lookup"><span data-stu-id="6c7a0-494">SP-APP1, SP-APP2, SP-APP3</span></span>  <br/> |<span data-ttu-id="6c7a0-495">응용 프로그램 서버.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-495">Application servers.</span></span>  <br/> |<span data-ttu-id="6c7a0-496">프로세서 4개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-496">Four processors</span></span>  <br/> <span data-ttu-id="6c7a0-497">2-16GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-497">2-16 GB of RAM</span></span>  <br/> |
|<span data-ttu-id="6c7a0-498">SP-SQL-HA1, SP-SQL-HA2</span><span class="sxs-lookup"><span data-stu-id="6c7a0-498">SP-SQL-HA1, SP-SQL-HA2</span></span>  <br/> |<span data-ttu-id="6c7a0-499">고가용성을 제공하기 위해 SQL Server 2012 AlwaysOn 가용성 그룹으로 구성된 데이터베이스 서버.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-499">Database servers, configured with SQL Server 2012 AlwaysOn availability groups to provide high availability.</span></span> <span data-ttu-id="6c7a0-500">이 구성에서는 SP-SQL-HA1 및 SP-SQL-HA2를 기본 및 보조 복제본으로 사용했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-500">This configuration uses SP-SQL-HA1 and SP-SQL-HA2 as the primary and secondary replicas.</span></span>  <br/> |<span data-ttu-id="6c7a0-501">프로세서 4개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-501">Four processors</span></span>  <br/> <span data-ttu-id="6c7a0-502">2-16GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-502">2-16 GB of RAM</span></span>  <br/> |
   
<span data-ttu-id="6c7a0-503">다음 표에서는 Hyper-V 테스트 환경의 프런트 엔드 웹 및 응용 프로그램 서버에 대해 만들어 구성한 Hyper-V 가상 컴퓨터의 드라이브 구성에 대해 설명하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-503">The following table describes drive configurations for the Hyper-V virtual machines that we created and configured for the front-end web and application servers for the on-premises test environment.</span></span>
  
<span data-ttu-id="6c7a0-504">**표: 프런트 엔드 웹 및 응용 프로그램 서버에 대한 가상 컴퓨터 드라이브 요구 사항**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-504">**Table: Virtual machine drive requirements for the Front End Web and Application servers for the on-premises test**</span></span>

|<span data-ttu-id="6c7a0-505">**드라이브 문자**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-505">**Drive letter**</span></span>|<span data-ttu-id="6c7a0-506">**크기**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-506">**Size**</span></span>|<span data-ttu-id="6c7a0-507">**디렉터리 이름**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-507">**Directory name**</span></span>|<span data-ttu-id="6c7a0-508">**Path**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-508">**Path**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="6c7a0-509">C</span><span class="sxs-lookup"><span data-stu-id="6c7a0-509">C</span></span>  <br/> |<span data-ttu-id="6c7a0-510">80</span><span class="sxs-lookup"><span data-stu-id="6c7a0-510">80</span></span>  <br/> |<span data-ttu-id="6c7a0-511">시스템 드라이브</span><span class="sxs-lookup"><span data-stu-id="6c7a0-511">System drive</span></span>  <br/> |<span data-ttu-id="6c7a0-512"><DriveLetter>: \\ Program Files \\ Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c7a0-512"><DriveLetter>:\\Program Files\\Microsoft SQL Server</span></span>\\  <br/> |
|<span data-ttu-id="6c7a0-513">E</span><span class="sxs-lookup"><span data-stu-id="6c7a0-513">E</span></span>  <br/> |<span data-ttu-id="6c7a0-514">80</span><span class="sxs-lookup"><span data-stu-id="6c7a0-514">80</span></span>  <br/> |<span data-ttu-id="6c7a0-515">로그 드라이브(40GB)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-515">Log drive (40 GB)</span></span>  <br/> |<span data-ttu-id="6c7a0-516"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="6c7a0-516"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="6c7a0-517">F</span><span class="sxs-lookup"><span data-stu-id="6c7a0-517">F</span></span>  <br/> |<span data-ttu-id="6c7a0-518">80</span><span class="sxs-lookup"><span data-stu-id="6c7a0-518">80</span></span>  <br/> |<span data-ttu-id="6c7a0-519">페이지(36GB)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-519">Page (36 GB)</span></span>  <br/> |<span data-ttu-id="6c7a0-520"><DriveLetter>: \\ \\ \\ MSSQL Microsoft SQL Server 프로그램 \\ 파일</span><span class="sxs-lookup"><span data-stu-id="6c7a0-520"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL\\DATA</span></span>  <br/> |
   
<span data-ttu-id="6c7a0-521">다음 표에서는 Hyper-V 데이터베이스 서버 역할을 하도록 구성된 가상 컴퓨터의 드라이브 구성에 대해 설명하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-521">The following table describes drive configurations for the Hyper-V virtual machines created and configured to serve as the on-premises database servers.</span></span> <span data-ttu-id="6c7a0-522">데이터베이스 엔진 **구성 페이지에서** 데이터 **Directories** 탭에 액세스하여 다음 표에 나와 있는 설정을 설정하고 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-522">On the **Database Engine Configuration** page, access the **Data Directories** tab to set and confirm the settings shown in the following table.</span></span>
  
<span data-ttu-id="6c7a0-523">**표: 사내 테스트용 데이터베이스 서버에 대한 가상 컴퓨터 드라이브 요구 사항**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-523">**Table: Virtual machine drive requirements for the database server for the on-premises test**</span></span>

|<span data-ttu-id="6c7a0-524">**드라이브 문자**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-524">**Drive letter**</span></span>|<span data-ttu-id="6c7a0-525">**크기**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-525">**Size**</span></span>|<span data-ttu-id="6c7a0-526">**디렉터리 이름**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-526">**Directory name**</span></span>|<span data-ttu-id="6c7a0-527">**Path**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-527">**Path**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="6c7a0-528">C</span><span class="sxs-lookup"><span data-stu-id="6c7a0-528">C</span></span>  <br/> |<span data-ttu-id="6c7a0-529">80</span><span class="sxs-lookup"><span data-stu-id="6c7a0-529">80</span></span>  <br/> |<span data-ttu-id="6c7a0-530">데이터 루트 디렉터리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-530">Data root directory</span></span>  <br/> |<span data-ttu-id="6c7a0-531"><DriveLetter>: \\ Program Files \\ Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c7a0-531"><DriveLetter>:\\Program Files\\Microsoft SQL Server</span></span>\\  <br/> |
|<span data-ttu-id="6c7a0-532">E</span><span class="sxs-lookup"><span data-stu-id="6c7a0-532">E</span></span>  <br/> |<span data-ttu-id="6c7a0-533">500</span><span class="sxs-lookup"><span data-stu-id="6c7a0-533">500</span></span>  <br/> |<span data-ttu-id="6c7a0-534">사용자 데이터베이스 디렉터리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-534">User database directory</span></span>  <br/> |<span data-ttu-id="6c7a0-535"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="6c7a0-535"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="6c7a0-536">F</span><span class="sxs-lookup"><span data-stu-id="6c7a0-536">F</span></span>  <br/> |<span data-ttu-id="6c7a0-537">500</span><span class="sxs-lookup"><span data-stu-id="6c7a0-537">500</span></span>  <br/> |<span data-ttu-id="6c7a0-538">사용자 데이터베이스 로그 디렉터리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-538">User database log directory</span></span>  <br/> |<span data-ttu-id="6c7a0-539"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="6c7a0-539"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="6c7a0-540">G</span><span class="sxs-lookup"><span data-stu-id="6c7a0-540">G</span></span>  <br/> |<span data-ttu-id="6c7a0-541">500</span><span class="sxs-lookup"><span data-stu-id="6c7a0-541">500</span></span>  <br/> |<span data-ttu-id="6c7a0-542">Temp DB 디렉터리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-542">Temp DB directory</span></span>  <br/> |<span data-ttu-id="6c7a0-543"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="6c7a0-543"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
|<span data-ttu-id="6c7a0-544">H</span><span class="sxs-lookup"><span data-stu-id="6c7a0-544">H</span></span>  <br/> |<span data-ttu-id="6c7a0-545">500</span><span class="sxs-lookup"><span data-stu-id="6c7a0-545">500</span></span>  <br/> |<span data-ttu-id="6c7a0-546">Temp DB 로그 디렉터리</span><span class="sxs-lookup"><span data-stu-id="6c7a0-546">Temp DB log directory</span></span>  <br/> |<span data-ttu-id="6c7a0-547"><DriveLetter>: \\ Program Files Microsoft SQL Server \\ \\ MSSQL10_50.MSSQLSERVER \\ MSSQL \\ DATA</span><span class="sxs-lookup"><span data-stu-id="6c7a0-547"><DriveLetter>:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA</span></span>  <br/> |
   
### <a name="setting-up-the-test-environment"></a><span data-ttu-id="6c7a0-548">테스트 환경 설정</span><span class="sxs-lookup"><span data-stu-id="6c7a0-548">Setting up the test environment</span></span>

<span data-ttu-id="6c7a0-549">여러 배포 단계 동안 테스트 팀은 일반적으로 먼저 사내 아키텍처를 먼저 작업한 다음 해당 Azure 환경에서 작업했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-549">During the different deployment phases, the test team typically worked on the on-premises architecture first and then on the corresponding Azure environment.</span></span> <span data-ttu-id="6c7a0-550">이는 사 내 프로덕션 팜이 이미 실행되고 있는 일반적인 실제 사례를 반영합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-550">This reflects the general real-world cases where in-house production farms are already running.</span></span> <span data-ttu-id="6c7a0-551">더욱 중요한 점은 현재 프로덕션 작업량, 용량 및 일반적인 성능을 알아야 한다는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-551">What is even more important is that you should know the current production workload, capacity, and typical performance.</span></span> <span data-ttu-id="6c7a0-552">비즈니스 요구 사항을 충족할 수 있는 재해 복구 모델을 구축하는 것 외에도 복구 팜 서버의 크기를 최소 수준의 서비스를 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-552">In addition to building a disaster recovery model that can meet business requirements, you should size the recovery farm servers to deliver a minimum level of service.</span></span> <span data-ttu-id="6c7a0-553">콜드 또는 웜 대기 환경에서 복구 팜은 일반적으로 프로덕션 팜보다 작습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-553">In a cold or warm standby environment, a recovery farm is typically smaller than a production farm.</span></span> <span data-ttu-id="6c7a0-554">복구 팜이 안정화되고 프로덕션에서 작업 요구 사항을 충족하기 위해 팜을 수리 및 수리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-554">After the recovery farm is stable and in production, the farm can be scaled up and out to meet workload requirements.</span></span>
  
<span data-ttu-id="6c7a0-555">다음 세 단계에 테스트 환경을 배포했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-555">We deployed our test environment in the following three phases:</span></span>
  
- <span data-ttu-id="6c7a0-556">하이브리드 인프라 설정</span><span class="sxs-lookup"><span data-stu-id="6c7a0-556">Set up the hybrid infrastructure</span></span>
    
- <span data-ttu-id="6c7a0-557">서버 프로비전</span><span class="sxs-lookup"><span data-stu-id="6c7a0-557">Provision the servers</span></span>
    
- <span data-ttu-id="6c7a0-558">SharePoint 팜 배포</span><span class="sxs-lookup"><span data-stu-id="6c7a0-558">Deploy the SharePoint farms</span></span>
    
#### <a name="set-up-the-hybrid-infrastructure"></a><span data-ttu-id="6c7a0-559">하이브리드 인프라 설정</span><span class="sxs-lookup"><span data-stu-id="6c7a0-559">Set up the hybrid infrastructure</span></span>

<span data-ttu-id="6c7a0-560">이 단계에서는 Azure의 복구 팜 및 사내 팜에 대한 도메인 환경을 설정하는 과정이 진행되었습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-560">This phase involved setting up a domain environment for the on-premises farm and for the recovery farm in Azure.</span></span> <span data-ttu-id="6c7a0-561">테스트 팀은 Active Directory 구성과 관련된 일반적인 작업 외에도 두 환경 간의 라우팅 솔루션 및 VPN 연결을 구현했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-561">In addition to the normal tasks associated with configuring Active Directory, the test team implemented a routing solution and a VPN connection between the two environments.</span></span>
  
#### <a name="provision-the-servers"></a><span data-ttu-id="6c7a0-562">서버 프로비전</span><span class="sxs-lookup"><span data-stu-id="6c7a0-562">Provision the servers</span></span>

<span data-ttu-id="6c7a0-563">팜 서버 외에도 도메인 컨트롤러용 서버를 프로비전하고 RRAS 및 사이트 대 사이트 VPN을 처리하도록 서버를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-563">In addition to the farm servers, it was necessary to provision servers for the domain controllers and configure a server to handle RRAS as well as the site-to-site VPN.</span></span> <span data-ttu-id="6c7a0-564">DFSR 서비스에 대해 두 개의 파일 서버가 프로비전되었습니다. 테스터를 위해 여러 클라이언트 컴퓨터가 프로비전되었습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-564">Two file servers were provisioned for the DFSR service, and several client computers were provisioned for testers.</span></span>
  
#### <a name="deploy-the-sharepoint-farms"></a><span data-ttu-id="6c7a0-565">SharePoint 팜 배포</span><span class="sxs-lookup"><span data-stu-id="6c7a0-565">Deploy the SharePoint farms</span></span>

<span data-ttu-id="6c7a0-566">SharePoint 팜은 필요한 경우 환경 손떨림 보정 및 문제 해결을 간소화하기 위해 두 단계로 배포되었습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-566">The SharePoint farms were deployed in two stages in order to simplify environment stabilization and troubleshooting, if required.</span></span> <span data-ttu-id="6c7a0-567">첫 번째 단계에서는 필요한 기능을 지원하기 위해 각 토폴로지의 각 계층에 대한 최소 서버 수에 각 팜을 배포했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-567">During the first stage, each farm was deployed on the minimum number of servers for each tier of the topology to support the required functionality.</span></span>
  
<span data-ttu-id="6c7a0-568">SharePoint 2013 서버를 만들기 전에 SQL Server 데이터베이스 서버를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-568">We created the database servers with SQL Server installed before creating the SharePoint 2013 servers.</span></span> <span data-ttu-id="6c7a0-569">이 배포는 새 배포이기 때문에 SharePoint를 배포하기 전에 가용성 그룹을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-569">Because this was a new deployment, we created the availability groups before deploying SharePoint.</span></span> <span data-ttu-id="6c7a0-570">MCS 모범 사례 지침을 기반으로 3개의 그룹을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-570">We created three groups based on MCS best practice guidance.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="6c7a0-571">SharePoint 설치 전에 가용성 그룹을 만들 수 있도록 자리를 비우는 데이터베이스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-571">Create placeholder databases so that you can create availability groups before the SharePoint installation.</span></span> <span data-ttu-id="6c7a0-572">자세한 내용은 [Configure SQL Server AlwaysOn Availability Groups for SharePoint 2013을 참조하세요.](/SharePoint/administration/configure-an-alwayson-availability-group)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-572">For more information, see [Configure SQL Server 2012 AlwaysOn Availability Groups for SharePoint 2013](/SharePoint/administration/configure-an-alwayson-availability-group)</span></span>
  
<span data-ttu-id="6c7a0-573">팜을 만들어 다음 순서로 추가 서버를 추가했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-573">We created the farm and joined additional servers in the following order:</span></span>
  
- <span data-ttu-id="6c7a0-574">SP-SQL-HA1 및 SP-SQL-HA2를 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-574">Provision SP-SQL-HA1 and SP-SQL-HA2.</span></span>
    
- <span data-ttu-id="6c7a0-575">AlwaysOn을 구성하고 팜에 대해 세 가지 가용성 그룹을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-575">Configure AlwaysOn and create the three availability groups for the farm.</span></span> 
    
- <span data-ttu-id="6c7a0-576">중앙 관리 호스트를 위해 SP-APP1을 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-576">Provision SP-APP1 to host Central Administration.</span></span>
    
- <span data-ttu-id="6c7a0-577">배포된 캐시를 호스트하기 위해 SP-WFE1 및 SP-WFE2를 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-577">Provision SP-WFE1 and SP-WFE2 to host the distributed cache.</span></span> 
    
<span data-ttu-id="6c7a0-578">명령줄에서psconfig.exe _skipRegisterAsDistributedCachehost_ 매개  변수를 사용했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-578">We used the  _skipRegisterAsDistributedCachehost_ parameter when we ran **psconfig.exe** at the command line.</span></span> <span data-ttu-id="6c7a0-579">자세한 내용은 [Plan for feeds and the Distributed Cache service in SharePoint Server 2013을 참조하세요.](/sharepoint/administration/plan-for-feeds-and-the-distributed-cache-service)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-579">For more information, see [Plan for feeds and the Distributed Cache service in SharePoint Server 2013](/sharepoint/administration/plan-for-feeds-and-the-distributed-cache-service).</span></span> 
  
<span data-ttu-id="6c7a0-580">복구 환경에서 다음 단계를 반복했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-580">We repeated the following steps in the recovery environment:</span></span>
  
- <span data-ttu-id="6c7a0-581">AZ-SQL-HA1 및 AZ-SQL-HA2를 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-581">Provision AZ-SQL-HA1 and AZ-SQL-HA2.</span></span>
    
- <span data-ttu-id="6c7a0-582">AlwaysOn을 구성하고 팜에 대해 세 가지 가용성 그룹을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-582">Configure AlwaysOn and create the three availability groups for the farm.</span></span>
    
- <span data-ttu-id="6c7a0-583">중앙 관리 호스트를 위해 AZ-APP1을 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-583">Provision AZ-APP1 to host Central Administration.</span></span>
    
- <span data-ttu-id="6c7a0-584">배포된 캐시를 호스트하기 위해 AZ-WFE1 및 AZ-WFE2를 프로비전합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-584">Provision AZ-WFE1 and AZ-WFE2 to host the distributed cache.</span></span>
    
<span data-ttu-id="6c7a0-585">배포된 캐시를 구성하고 테스트 사용자를 추가하고 테스트 콘텐츠를 추가한 후 배포의 2단계를 시작했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-585">After we configured the distributed cache and added test users and test content, we started stage two of the deployment.</span></span> <span data-ttu-id="6c7a0-586">이 경우 계층을 확장하고 팜 아키텍처에 설명된 고가용성 토폴로지 지원을 위해 팜 서버를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-586">This required scaling out the tiers and configuring the farm servers to support the high-availability topology described in the farm architecture.</span></span>
  
<span data-ttu-id="6c7a0-587">다음 표에서는 복구 팜에 대해 설정한 가상 컴퓨터, 서브넷 및 가용성 집합에 대해 설명하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-587">The following table describes the virtual machines, subnets, and availability sets we set up for our recovery farm.</span></span>
  
<span data-ttu-id="6c7a0-588">**표: 복구 팜 인프라**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-588">**Table: Recovery farm infrastructure**</span></span>

|<span data-ttu-id="6c7a0-589">**서버 이름**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-589">**Server name**</span></span>|<span data-ttu-id="6c7a0-590">**역할**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-590">**Role**</span></span>|<span data-ttu-id="6c7a0-591">**구성**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-591">**Configuration**</span></span>|<span data-ttu-id="6c7a0-592">**서브넷**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-592">**Subnet**</span></span>|<span data-ttu-id="6c7a0-593">**가용성 집합**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-593">**Availability set**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="6c7a0-594">spDRAD</span><span class="sxs-lookup"><span data-stu-id="6c7a0-594">spDRAD</span></span>  <br/> |<span data-ttu-id="6c7a0-595">Active Directory가 있는 도메인 컨트롤러</span><span class="sxs-lookup"><span data-stu-id="6c7a0-595">Domain controller with Active Directory</span></span>  <br/> |<span data-ttu-id="6c7a0-596">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-596">Two processors</span></span>  <br/> <span data-ttu-id="6c7a0-597">512MB에서 4GB RAM까지</span><span class="sxs-lookup"><span data-stu-id="6c7a0-597">From 512 MB through 4 GB of RAM</span></span>  <br/> <span data-ttu-id="6c7a0-598">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-598">1 x 127-GB hard disk</span></span>  <br/> |<span data-ttu-id="6c7a0-599">sp-ADservers</span><span class="sxs-lookup"><span data-stu-id="6c7a0-599">sp-ADservers</span></span>  <br/> ||
|<span data-ttu-id="6c7a0-600">AZ-SP-FS</span><span class="sxs-lookup"><span data-stu-id="6c7a0-600">AZ-SP-FS</span></span>  <br/> |<span data-ttu-id="6c7a0-601">백업을 위한 공유가 있는 파일 서버 및 DFSR의 끝점</span><span class="sxs-lookup"><span data-stu-id="6c7a0-601">File server with shares for backups and an endpoint for DFSR</span></span>  <br/> | <span data-ttu-id="6c7a0-602">A5 구성:</span><span class="sxs-lookup"><span data-stu-id="6c7a0-602">A5 configuration:</span></span> <br/>  <span data-ttu-id="6c7a0-603">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-603">Two processors</span></span> <br/>  <span data-ttu-id="6c7a0-604">14GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-604">14 GB of RAM</span></span> <br/>  <span data-ttu-id="6c7a0-605">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-605">1 x 127-GB hard disk</span></span> <br/>  <span data-ttu-id="6c7a0-606">1 x 135GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-606">1 x 135-GB hard disk</span></span> <br/>  <span data-ttu-id="6c7a0-607">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-607">1 x 127-GB hard disk</span></span> <br/>  <span data-ttu-id="6c7a0-608">1 x 150GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-608">1 x 150-GB hard disk</span></span> <br/> |<span data-ttu-id="6c7a0-609">sp-databaseservers</span><span class="sxs-lookup"><span data-stu-id="6c7a0-609">sp-databaseservers</span></span>  <br/> |<span data-ttu-id="6c7a0-610">DATA_SET</span><span class="sxs-lookup"><span data-stu-id="6c7a0-610">DATA_SET</span></span>  <br/> |
|<span data-ttu-id="6c7a0-611">AZ-WFE1, AZ -WFE2</span><span class="sxs-lookup"><span data-stu-id="6c7a0-611">AZ-WFE1, AZ -WFE2</span></span>  <br/> |<span data-ttu-id="6c7a0-612">프런트 엔드 웹 서버</span><span class="sxs-lookup"><span data-stu-id="6c7a0-612">Front End Web servers</span></span>  <br/> | <span data-ttu-id="6c7a0-613">A5 구성:</span><span class="sxs-lookup"><span data-stu-id="6c7a0-613">A5 configuration:</span></span> <br/>  <span data-ttu-id="6c7a0-614">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-614">Two processors</span></span> <br/>  <span data-ttu-id="6c7a0-615">14GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-615">14 GB of RAM</span></span> <br/>  <span data-ttu-id="6c7a0-616">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-616">1 x 127-GB hard disk</span></span> <br/> |<span data-ttu-id="6c7a0-617">sp-webservers</span><span class="sxs-lookup"><span data-stu-id="6c7a0-617">sp-webservers</span></span>  <br/> |<span data-ttu-id="6c7a0-618">WFE_SET</span><span class="sxs-lookup"><span data-stu-id="6c7a0-618">WFE_SET</span></span>  <br/> |
|<span data-ttu-id="6c7a0-619">AZ -APP1, AZ -APP2, AZ -APP3</span><span class="sxs-lookup"><span data-stu-id="6c7a0-619">AZ -APP1, AZ -APP2, AZ -APP3</span></span>  <br/> |<span data-ttu-id="6c7a0-620">응용 프로그램 서버</span><span class="sxs-lookup"><span data-stu-id="6c7a0-620">Application servers</span></span>  <br/> | <span data-ttu-id="6c7a0-621">A5 구성:</span><span class="sxs-lookup"><span data-stu-id="6c7a0-621">A5 configuration:</span></span> <br/>  <span data-ttu-id="6c7a0-622">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-622">Two processors</span></span> <br/>  <span data-ttu-id="6c7a0-623">14GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-623">14 GB of RAM</span></span> <br/>  <span data-ttu-id="6c7a0-624">1 x 127GB 하드 디스크</span><span class="sxs-lookup"><span data-stu-id="6c7a0-624">1 x 127-GB hard disk</span></span> <br/> |<span data-ttu-id="6c7a0-625">sp-applicationservers</span><span class="sxs-lookup"><span data-stu-id="6c7a0-625">sp-applicationservers</span></span>  <br/> |<span data-ttu-id="6c7a0-626">APP_SET</span><span class="sxs-lookup"><span data-stu-id="6c7a0-626">APP_SET</span></span>  <br/> |
|<span data-ttu-id="6c7a0-627">AZ -SQL-HA1, AZ -SQL-HA2</span><span class="sxs-lookup"><span data-stu-id="6c7a0-627">AZ -SQL-HA1, AZ -SQL-HA2</span></span>  <br/> |<span data-ttu-id="6c7a0-628">AlwaysOn 가용성 그룹에 대한 데이터베이스 서버 및 기본 및 보조 복제본</span><span class="sxs-lookup"><span data-stu-id="6c7a0-628">Database servers and primary and secondary replicas for AlwaysOn availability groups</span></span>  <br/> | <span data-ttu-id="6c7a0-629">A5 구성:</span><span class="sxs-lookup"><span data-stu-id="6c7a0-629">A5 configuration:</span></span> <br/>  <span data-ttu-id="6c7a0-630">프로세서 2개</span><span class="sxs-lookup"><span data-stu-id="6c7a0-630">Two processors</span></span> <br/>  <span data-ttu-id="6c7a0-631">14GB RAM</span><span class="sxs-lookup"><span data-stu-id="6c7a0-631">14 GB of RAM</span></span> <br/> |<span data-ttu-id="6c7a0-632">sp-databaseservers</span><span class="sxs-lookup"><span data-stu-id="6c7a0-632">sp-databaseservers</span></span>  <br/> |<span data-ttu-id="6c7a0-633">DATA_SET</span><span class="sxs-lookup"><span data-stu-id="6c7a0-633">DATA_SET</span></span>  <br/> |
   
### <a name="operations"></a><span data-ttu-id="6c7a0-634">작업</span><span class="sxs-lookup"><span data-stu-id="6c7a0-634">Operations</span></span>

<span data-ttu-id="6c7a0-635">테스트 팀은 팜 환경을 안정화하고 기능 테스트를 완료한 후, 다음과 같은 작업 작업을 시작하여 사내 복구 환경을 구성하는 데 필요한 작업을 시작했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-635">After the test team stabilized the farm environments and completed functional testing, they started the following operations tasks required to configure the on-premises recovery environment:</span></span>
  
- <span data-ttu-id="6c7a0-636">전체 및 차차 백업을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-636">Configure full and differential backups.</span></span>
    
- <span data-ttu-id="6c7a0-637">사내 환경과 Azure 환경 간에 트랜잭션 로그를 전송하는 파일 서버에서 DFSR을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-637">Configure DFSR on the file servers that transfer transaction logs between the on-premises environment and the Azure environment.</span></span>
    
- <span data-ttu-id="6c7a0-638">기본 데이터베이스 서버에서 로그 전달을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-638">Configure log shipping on the primary database server.</span></span>
    
- <span data-ttu-id="6c7a0-639">필요한 경우 로그 전달을 안정화, 유효성 검사 및 문제 해결합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-639">Stabilize, validate, and troubleshoot log shipping, as required.</span></span> <span data-ttu-id="6c7a0-640">여기에는 로그 전달 또는 DFSR 파일 동기화 오류가 발생할 수 있는 네트워크 대기 시간과 같은 문제를 일으킬 수 있는 동작을 식별하고 문서화하는 작업도 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-640">This included identifying and documenting any behavior that might cause issues, such as network latency, which would cause log shipping or DFSR file synchronization failures.</span></span>
    
### <a name="databases"></a><span data-ttu-id="6c7a0-641">데이터베이스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-641">Databases</span></span>

<span data-ttu-id="6c7a0-642">장애 조치(failover) 테스트에는 다음과 같은 데이터베이스가 포함되었습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-642">Our failover tests involved the following databases:</span></span> 
  
- <span data-ttu-id="6c7a0-643">WSS_Content</span><span class="sxs-lookup"><span data-stu-id="6c7a0-643">WSS_Content</span></span>
    
- <span data-ttu-id="6c7a0-644">ManagedMetadata</span><span class="sxs-lookup"><span data-stu-id="6c7a0-644">ManagedMetadata</span></span>
    
- <span data-ttu-id="6c7a0-645">프로필 DB</span><span class="sxs-lookup"><span data-stu-id="6c7a0-645">Profile DB</span></span>
    
- <span data-ttu-id="6c7a0-646">동기화 DB</span><span class="sxs-lookup"><span data-stu-id="6c7a0-646">Sync DB</span></span>
    
- <span data-ttu-id="6c7a0-647">Social DB</span><span class="sxs-lookup"><span data-stu-id="6c7a0-647">Social DB</span></span>
    
- <span data-ttu-id="6c7a0-648">콘텐츠 형식 허브(전용 콘텐츠 형식 Syndication 허브용 데이터베이스)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-648">Content Type Hub (a database for a dedicated Content Type Syndication Hub)</span></span>
    
## <a name="troubleshooting-tips"></a><span data-ttu-id="6c7a0-649">문제 해결 팁</span><span class="sxs-lookup"><span data-stu-id="6c7a0-649">Troubleshooting tips</span></span>

<span data-ttu-id="6c7a0-650">이 섹션에서는 테스트 중에 발생하는 문제 및 해결 방법 설명을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-650">The section explains the problems we encountered during our testing and their solutions.</span></span> 
  
### <a name="using-the-term-store-management-tool-caused-the-error-the-managed-metadata-store-or-connection-is-currently-not-available"></a><span data-ttu-id="6c7a0-651">용어 저장소 관리 도구를 사용하면 "관리되는 메타데이터 저장소 또는 연결을 현재 사용할 수 없습니다."라는 오류가 발생했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-651">Using the Term Store Management Tool caused the error, "The Managed Metadata Store or Connection is currently not available."</span></span>

<span data-ttu-id="6c7a0-652">웹 응용 프로그램에서 사용하는 응용 프로그램 풀 계정에 용어 저장소에 대한 읽기 권한이 있는지 확인</span><span class="sxs-lookup"><span data-stu-id="6c7a0-652">Ensure that the application pool account used by the web application has the Read Access to Term Store permission.</span></span>
  
### <a name="custom-term-sets-are-not-available-in-the-site-collection"></a><span data-ttu-id="6c7a0-653">사이트 모음에서 사용자 지정 용어 집합을 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-653">Custom term sets are not available in the site collection</span></span>

<span data-ttu-id="6c7a0-654">콘텐츠 사이트 모음과 콘텐츠 형식 허브 간에 누락된 서비스 응용 프로그램 연결 확인</span><span class="sxs-lookup"><span data-stu-id="6c7a0-654">Check for a missing service application association between your content site collection and your content type hub.</span></span> <span data-ttu-id="6c7a0-655">또한 **관리되는 <site collection name>** 메타데이터 - 연결 속성 화면에서 이 서비스 응용 프로그램이 열 특정 용어 집합의 기본 저장소 위치인 이 옵션을 사용하도록 설정되어 있는지 **확인합니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-655">In addition, under the **Managed Metadata - <site collection name> Connection** properties screen, make sure this option is enabled: **This service application is the default storage location for column specific term sets.**</span></span>
  
### <a name="the-get-adforest-windows-powershell-command-generates-the-error-the-term-get-adforest-is-not-recognized-as-the-name-of-a-cmdlet-function-script-file-or-operable-program"></a><span data-ttu-id="6c7a0-656">Get-ADForest Windows PowerShell 명령은 "'Get-ADForest'라는 용어는 cmdlet, 함수, 스크립트 파일 또는 작동할 수 있는 프로그램의 이름으로 인식되지 않습니다."라는 오류가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-656">The Get-ADForest Windows PowerShell command generates the error, "The term 'Get-ADForest' is not recognized as the name of a cmdlet, function, script file, or operable program."</span></span>

<span data-ttu-id="6c7a0-657">사용자 프로필을 설정할 때 Active Directory 포리스트 이름이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-657">When setting up user profiles, you need the Active Directory forest name.</span></span> <span data-ttu-id="6c7a0-658">역할 및 기능 추가 마법사에서 Ad Windows PowerShell DS 및 **AD LDS** 도구 섹션에서 원격 서버 관리 도구>역할 관리 도구>Active Directory 모듈을 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-658">In the Add Roles and Features Wizard, ensure that you have enabled the Active Directory Module for Windows PowerShell (under the **Remote Server Administration Tools>Role Administration Tools>AD DS and AD LDS Tools** section).</span></span> <span data-ttu-id="6c7a0-659">또한 **Get-ADForest를** 사용하기 전에 다음 명령을 실행하여 소프트웨어 종속성 로드를 보장합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-659">In addition, run the following commands before using **Get-ADForest** to help ensure that your software dependencies are loaded.</span></span>
  
```
Import-module servermanager
Import-module activedirectory

```

### <a name="availability-group-creation-fails-at-starting-the-alwayson_health-xevent-session-on-server-name"></a><span data-ttu-id="6c7a0-660">'에서 'AlwaysOn_health' XEvent 세션 시작 시 가용성 그룹 만들기가 <server name> 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-660">Availability group creation fails at Starting the 'AlwaysOn_health' XEvent session on '<server name>'</span></span>

<span data-ttu-id="6c7a0-661">장애 조치(failover) 클러스터의 두 노드가 모두 "일시 중지됨" 또는 "중지됨" 상태가 아닌 "위"에 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-661">Ensure that both nodes of your failover cluster are in the Status "Up" and not "Paused" or "Stopped".</span></span> 
  
### <a name="sql-server-log-shipping-job-fails-with-access-denied-error-trying-to-connect-to-the-file-share"></a><span data-ttu-id="6c7a0-662">SQL Server 공유에 연결하려고 하는 액세스 거부 오류로 로그 전달 작업이 실패했습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-662">SQL Server log shipping job fails with access denied error trying to connect to the file share</span></span>

<span data-ttu-id="6c7a0-663">기본 자격 SQL Server 대신 네트워크 자격 증명으로 에이전트가 실행되고 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-663">Ensure that your SQL Server Agent is running under network credentials, instead of the default credentials.</span></span>
  
### <a name="sql-server-log-shipping-job-indicates-success-but-no-files-are-copied"></a><span data-ttu-id="6c7a0-664">SQL Server 로그 전달 작업이 성공을 나타내지만 파일이 복사되는 것은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-664">SQL Server log shipping job indicates success, but no files are copied</span></span>

<span data-ttu-id="6c7a0-665">이 문제는 가용성 그룹의 기본 백업 기본 설정이 보조 **선호이기 때문에 발생합니다.**</span><span class="sxs-lookup"><span data-stu-id="6c7a0-665">This happens because the default backup preference for an availability group is **Prefer Secondary**.</span></span> <span data-ttu-id="6c7a0-666">기본 서버가 아닌 가용성 그룹의 보조 서버에서 로그 전달 작업을 실행해야 합니다. 그렇지 않으면 작업이 자동으로 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-666">Ensure that you run the log shipping job from the secondary server for the availability group instead of the primary; otherwise, the job will fail silently.</span></span> 
  
### <a name="managed-metadata-service-or-other-sharepoint-service-fails-to-start-automatically-after-installation"></a><span data-ttu-id="6c7a0-667">Managed Metadata Service(또는 기타 SharePoint 서비스)가 설치 후 자동으로 시작되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-667">Managed Metadata service (or other SharePoint service) fails to start automatically after installation</span></span>

<span data-ttu-id="6c7a0-668">SharePoint Server의 성능 및 현재 부하에 따라 서비스를 시작하는 데 몇 분 정도 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-668">Services might take several minutes to start, depending on the performance and current load of your SharePoint Server.</span></span> <span data-ttu-id="6c7a0-669">서비스에 **대한 시작을** 수동으로 클릭하고 때때로 서버 제공 서비스 화면을 새로 고쳐 상태를 모니터링하는 동안 적절한 시작 시간을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-669">Manually click **Start** for the service and provide adequate time for startup while occasionally refreshing the Services on Server screen to monitor its status.</span></span> <span data-ttu-id="6c7a0-670">서비스가 계속 중지된 상태로 유지되는 경우 SharePoint 진단 로깅을 사용하도록 설정하고 서비스를 다시 시작한 다음 로그에서 오류를 확인하려고 시도합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-670">In case the service remains stopped, enable SharePoint diagnostic logging, attempt to start the service again, and then check the log for errors.</span></span> <span data-ttu-id="6c7a0-671">자세한 내용은 [Configure diagnostic logging in SharePoint 2013을 참조하세요.](/sharepoint/administration/configure-diagnostic-logging)</span><span class="sxs-lookup"><span data-stu-id="6c7a0-671">For more information, see [Configure diagnostic logging in SharePoint 2013](/sharepoint/administration/configure-diagnostic-logging)</span></span>
  
### <a name="after-changing-dns-to-the-azure-failover-environment-client-browsers-continue-to-use-the-old-ip-address-for-the-sharepoint-site"></a><span data-ttu-id="6c7a0-672">DNS를 Azure 장애 조치(failover) 환경으로 변경한 후 클라이언트 브라우저는 SharePoint 사이트의 이전 IP 주소를 계속 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-672">After changing DNS to the Azure failover environment, client browsers continue to use the old IP address for the SharePoint site</span></span>

<span data-ttu-id="6c7a0-673">일부 클라이언트에는 DNS 변경이 즉시 표시되지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-673">Your DNS change might not be visible to all clients immediately.</span></span> <span data-ttu-id="6c7a0-674">테스트 클라이언트에서 상승된 명령 프롬프트에서 다음 명령을 수행하고 사이트에 다시 액세스를 시도합니다.</span><span class="sxs-lookup"><span data-stu-id="6c7a0-674">On a test client, perform the following command from an elevated command prompt and attempt to access the site again.</span></span>
  
```
Ipconfig /flushdns
```

## <a name="additional-resources"></a><span data-ttu-id="6c7a0-675">추가 리소스</span><span class="sxs-lookup"><span data-stu-id="6c7a0-675">Additional resources</span></span>

[<span data-ttu-id="6c7a0-676">SharePoint 데이터베이스에 대해 지원되는 고가용성 및 재해 복구 옵션</span><span class="sxs-lookup"><span data-stu-id="6c7a0-676">Supported high availability and disaster recovery options for SharePoint databases</span></span>](/sharepoint/administration/supported-high-availability-and-disaster-recovery-options-for-sharepoint-databas)
  
[<span data-ttu-id="6c7a0-677">SharePoint 2013에 SQL Server 2012 AlwaysOn 가용성 그룹 구성</span><span class="sxs-lookup"><span data-stu-id="6c7a0-677">Configure SQL Server 2012 AlwaysOn Availability Groups for SharePoint 2013</span></span>](/SharePoint/administration/configure-an-alwayson-availability-group)
  
## <a name="see-also"></a><span data-ttu-id="6c7a0-678">참고 항목</span><span class="sxs-lookup"><span data-stu-id="6c7a0-678">See Also</span></span>

[<span data-ttu-id="6c7a0-679">Microsoft 365 솔루션 및 아키텍처 센터</span><span class="sxs-lookup"><span data-stu-id="6c7a0-679">Microsoft 365 solution and architecture center</span></span>](../solutions/index.yml)