---
title: 이상 탐지 경고 조사
f1.keywords:
- NOCSH
ms.author: v-tophillips
author: v-tophillips
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.collection: m365-security-compliance
ms.localizationpriority: high
search.appverid:
- MOE150
- MET150
description: 이상 탐지 경고를 조사합니다.
ms.openlocfilehash: add90085634571608d0b7aceff85439898bb9fef
ms.sourcegitcommit: d4b867e37bf741528ded7fb289e4f6847228d2c5
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2021
ms.locfileid: "60204566"
---
# <a name="investigate-anomaly-detection-alerts"></a>이상 탐지 경고 조사

 Microsoft 앱 거버넌스는 악의적인 활동에 대한 보안 탐지 및 경고를 제공합니다. 이 가이드의 목적은 각 경고에 대한 일반적이고 실용적인 정보를 제공하여 조사 및 수정 작업에 도움이 되는 것입니다. 이 가이드에는 경고를 트리거하는 조건에 관한 일반적인 정보가 포함되어 있습니다. 이상 탐지는 본질적으로 결정론적이지 않으므로 일반적인 상황에서 벗어나는 동작이 있을 때만 트리거됩니다. 마지막으로 일부 경고는 미리 보기 상태일 수 있으므로 업데이트된 경고 상태에 관한 공식 설명서를 정기적으로 검토합니다.

## <a name="mitre-attck"></a>MITRE ATT&CK

앱 거버넌스 경고와 친숙한 MITRE ATT&CK 행렬 간의 관계를 더욱 쉽게 매핑할 수 있도록 해당 MITRE ATT&CK 전술별로 경고를 분류했습니다. 이 추가 참조를 사용하면 앱 경고가 트리거될 때 사용 중일 가능성이 있는 의심스러운 공격 기술을 더 쉽게 이해할 수 있습니다.

이 가이드에서는 다음 범주에서 앱 거버넌스 경고를 조사하고 수정하는 방법에 관한 정보를 제공합니다.

- 초기 액세스
- 실행
- 지속성
- 권한 상승
- 방어 회피
- 자격 증명 액세스
- 컬렉션
- 유출
- 영향

## <a name="security-alert-classifications"></a>보안 경고 분류

적절한 조사에 따라 모든 앱 거버넌스 경고를 다음 활동 유형 중 하나로 분류할 수 있습니다.

- TP(True Positive): 확인된 악성 활동에 대한 경고입니다.
- B-TP(Benign True Positive): 침투 테스트 또는 기타 권한이 있는 의심스러운 작업과 같이 의심스럽지만 악의적이지는 않은 활동에 대한 경고입니다.
- FP(False Positive): 악의적이 아닌 활동에 대한 경고입니다.

## <a name="general-investigation-steps"></a>일반적인 조사 단계

모든 유형의 경고를 조사할 때 다음 일반 지침을 사용하여 권장 조치를 적용하기 전에 잠재적 위협을 보다 명확하게 이해합니다.

- 앱 심각도 수준을 검토하고 테넌트의 나머지 앱과 비교합니다. 이 검토는 테넌트에서 더 큰 위험을 초래하는 앱을 식별하는 데 도움이 됩니다.
- TP를 식별하는 경우 모든 앱 활동을 검토하여 영향을 파악합니다. 예를 들어 다음 앱 정보를 검토합니다.

  - 액세스 권한이 부여된 범위
  - 평소와 다른 행동  
  - IP 주소 및 위치

## <a name="initial-access-alerts"></a>초기 액세스 경고

이 섹션에서는 악의적인 앱이 조직에서 기반을 유지하려고 할 수 있음을 나타내는 경고에 대해 설명합니다.  

### <a name="encoded-app-name-with-suspicious-consent-scopes"></a>의심스러운 동의 범위가 있는 인코딩된 앱 이름

**심각도:** 보통

**설명**: 이 탐지는 유니코드 또는 인코딩된 문자와 같이 문자가 있고, 의심스러운 동의 범위를 요청하며, Graph API를 통해 사용자 메일 폴더에 액세스하는 OAuth 앱을 식별합니다. 이 경고는 악의적 앱이 잘 알려지고 신뢰할 수 있는 앱으로 가장하여 사용자가 악의적 앱에 동의하게 하려는 악의적 사용자의 시도를 나타낼 수 있습니다.

**TP일까요, FP일까요?**

- **TP**: OAuth 앱이 알 수 없는 원본에서 전달된 의심스러운 범위를 가진 표시 이름을 인코딩했음을 확인할 수 있다면 TP(True Positive)를 표시합니다.  

  **권장 작업**: 이 앱에서 요청하고, 사용자가 액세스를 허용할 수 있는 권한 수준을 검토합니다. 조사 결과에 따라 이 앱에 대한 액세스를 금지하도록 선택할 수 있습니다.

  앱에 대한 액세스를 금지하려면 OAuth 앱 페이지에서 금지하려는 앱이 표시되는 행의 금지 아이콘을 선택합니다. 사용자에게 사용자가 설치하고 권한을 부여한 앱이 금지되었음을 알릴지 여부를 선택할 수 있습니다. 이 알림을 통해 사용자는 앱이 비활성화되고 연결된 앱에 액세스할 수 없음을 알 수 있습니다. 사용자에게 알리지 않으려면 대화 상자에서 이 금지된 앱에 액세스 권한을 부여한 사용자에게 알리기를 선택 취소합니다. 앱 사용자에게 앱이 사용 금지될 것임을 알리는 것이 좋습니다.

- **FP**: 앱에 인코딩된 이름이 있지만 조직에서 정당한 비즈니스 용도가 있음을 확인할 수 있는 경우.

  **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

[위험한 OAuth 앱을 조사](/cloud-app-security/investigate-risky-oauth)하는 방법에 관한 자습서를 따릅니다.

### <a name="oauth-app-with-read-scopes-have-suspicious-reply-url"></a>읽기 범위가 있는 OAuth 앱에 의심스러운 회신 URL이 있음

**심각도**: 보통

**설명**: 이 탐지는 User.Read, People.Read, Contacts.Read, Mail.Read, Contacts.Read.Shared 등 읽기 범위가 있고, Graph API를 통해 의심스러운 회신 URL로 리디렉션하는 OAuth 앱을 식별합니다. 이 활동은 읽기 범위 등 권한이 적은 악성 앱이 사용자 계정 정찰을 수행하는 데 악용될 수 있음을 나타냅니다.

**TP일까요, FP일까요?**

- **TP**: 읽기 범위가 있는 OAuth 앱이 알 수 없는 원본에서 전달되었고, 의심스러운 URL로 리디렉션된다는 사실을 확인할 수 있다면 TP(True Positive)를 표시합니다.

  **권장 작업**: 앱에서 요청한 회신 URL과 범위를 검토합니다. 조사 결과에 따라 이 앱에 대한 액세스를 금지하도록 선택할 수 있습니다. 이 앱에서 요청하고, 사용자가 액세스를 허용한 권한 수준을 검토합니다.

  앱에 대한 액세스를 금지하려면 OAuth 앱 페이지에서 금지하려는 앱이 표시되는 행의 금지 아이콘을 선택합니다. 사용자에게 사용자가 설치하고 권한을 부여한 앱이 금지되었음을 알릴지 여부를 선택할 수 있습니다. 이 알림을 통해 사용자는 앱이 비활성화되고 연결된 앱에 액세스할 수 없음을 알 수 있습니다. 사용자에게 알리지 않으려면 대화 상자에서 이 금지된 앱에 액세스 권한을 부여한 사용자에게 알리기를 선택 취소합니다. 앱 사용자에게 앱이 사용 금지될 것임을 알리는 것이 좋습니다.

- **B-TP**: 조사 후 앱에 조직 내 정당한 비즈니스 용도가 있음을 확인할 수 있는 경우.

  **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 앱에서 수행한 모든 활동을 검토합니다.
1. 앱이 의심스럽다고 생각되는 경우 다른 앱 스토어에서 앱의 이름 및 회신 URL을 조사하는 것이 좋습니다. 앱 스토어를 확인할 때 다음 앱 유형에 집중합니다.
   - 최근에 만든 앱
   - 의심스러운 회신 URL이 있는 앱
   - 최근에 업데이트되지 않은 앱. 업데이트가 없다는 건 앱이 더 이상 지원되지 않는다는 뜻일 수 있습니다.
1. 여전히 앱이 의심스럽다면 앱 이름과 게시자 이름, 회신 URL을 온라인에서 조사할 수 있습니다.  

### <a name="app-with-unusual-display-name-and-unusual-tld-inreply-domain"></a>회신 도메인에서 비정상적인 표시 이름 및 비정상적인 TLD가 있는 앱  

**심각도**: 보통  

**설명**

이 감지 기능은 비정상적인 표시 이름을 가진 앱을 식별하고 GraphAPI를 통해 비정상적인 최상위 도메인(TLD)이 있는 의심스러운 응답 도메인으로 리디렉션합니다. 이 기능은 악의적 앱이 잘 알려지고 신뢰할 수 있는 앱으로 가장하여 사용자가 악의적 또는 위험한 앱에 동의하게 하려는 악의적 또는 위험한 사용자의 시도를 나타낼 수 있습니다.  

**TP일까요, FP일까요?**

- **TP**: 알 수 없는 출처에서 이상한 표시 이름을 가진 앱이 전달되고 비정상적인 최상위 도메인을 가진 의심스러운 도메인으로 리디렉션되는 것을 확인할 수 있는 경우  

    **권장 작업**: 앱의 표시 이름 및 회신 도메인을 검토합니다. 조사 결과에 따라 이 앱에 대한 액세스를 금지하도록 선택할 수 있습니다. 이 앱에서 요청한 권한 수준과 액세스 권한을 부여한 사용자를 검토합니다.

- **FP**: 조사 후 앱에 조직 내 정당한 비즈니스 용도가 있음을 확인할 수 있는 경우입니다.

    **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

앱에서 수행한 모든 활동을 검토합니다. 앱이 의심스럽다고 생각되는 경우 다른 앱 스토어에서 앱의 이름 및 회신 도메인을 조사하는 것이 좋습니다. 앱 스토어를 확인할 때 다음 앱 유형에 집중합니다.

- 최근에 만든 앱
- 비정상적인 표시 이름을 가진 앱
- 의심스러운 회신 도메인이 있는 앱

앱이 여전히 의심스러운 경우 앱 표시 이름과 회신 도메인을 조사할 수 있습니다.

## <a name="persistence-alerts"></a>지속성 경고

이 섹션에서는 악의적인 행위자가 조직에서 기반을 유지하려고 할 수 있음을 나타내는 경고에 대해 설명합니다.

### <a name="app-with-suspicious-oauth-scope-made-graph-calls-to-read-email-and-created-inbox-rule"></a>의심스러운 OAuth 범위를 가진 앱이 전자 메일을 읽기 위해 그래프를 호출하고 받은 편지함 규칙을 생성함  

**심각도**: 보통

**MITRE ID**: T1137.005, T1114  

이 탐지는 의심스러운 범위에 동의하고, 의심스러운 받은 편지함 규칙을 만든 다음 Graph API를 통해 사용자 메일 폴더 및 메시지에 액세스하는 OAuth 앱을 식별합니다. 모든 전자 메일 또는 특정 전자 메일 다른 전자 메일 계정으로 전달과 같은 받은 편지함 규칙, 전자 메일에 액세스하고 다른 전자 메일 계정에 보내기 위한 그래프 호출은 조직의 정보를 유출하려는 시도일 수 있습니다.  

**TP일까요, FP일까요?**

- **TP**: 알 수 없는 원본에서 전달된 의심스러운 범위를 가진 OAuth 타사 앱이 받은 편지함 규칙을 만들었다는 사실을 확인할 수 있다면 TP(True Positive)를 표시합니다.

  **권장 작업**: 앱을 사용하지 않도록 설정 및 제거하고, 암호를 다시 설정하고, 받은 편지함 규칙을 제거합니다.

  Azure Active Directory를 사용하여 암호를 다시 설정하는 방법에 대한 자습서와 받은 편지함 규칙을 제거하는 방법에 대한 자습서 지침을 따르세요.

- **FP**: 앱이 정당한 이유로 새 또는 개인 외부 전자 메일 계정에 받은 편지함 규칙을 만들었음을 확인할 수 있는 경우.

  **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 앱에서 수행한 모든 활동을 검토합니다.
1. 앱에서 승인한 범위를 검토합니다.
1. 앱에서 만든 받은 편지함 규칙 작업과 조건을 검토합니다.

### <a name="app-accessed-from-unusual-location-post-certificate-update"></a>인증서 업데이트 후 비정상적인 위치에서 액세스된 앱

**심각도**: 낮음

**MITRE ID**: T1098

이 감지 기능은 LOB(기간 업무) 앱이 인증서/비밀을 업데이트하고 인증서 업데이트 후 며칠 이내에 최근에 본 적이 없거나 과거에 액세스한 적이 없는 비정상적인 위치에서 앱에 액세스할 때 경고를 트리거합니다.

**TP일까요, FP일까요?**

- **TP**: LOB 앱이 비정상적인 위치에서 접근하고 Graph API를 통해 비정상적인 활동을 수행한 것을 확인할 수 있는 경우입니다.

    **권장 작업**: 일시적으로 앱을 사용하지 않도록 설정하고 암호를 다시 설정한 다음 앱을 다시 사용하도록 설정합니다.

- **FP**: LOB 앱이 합법적인 목적을 위해 비정상적인 위치에서 액세스했으며 비정상적인 활동이 수행되지 않았음을 확인할 수 있습니다.

    **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 이 앱에서 수행하는 모든 활동을 검토합니다.
1. 앱에서 승인한 범위를 검토합니다.
1. 이 앱과 연결된 사용자 활동을 검토합니다.

### <a name="app-accessed-from-unusual-location-made-anomalous-graph-calls-post-certificate-update"></a>인증서 업데이트 후 비정상적인 위치에서 액세스된 앱이 비정상적인 Graph 호출을 생성함

**심각도**: 보통

**MITRE ID**: T1098

이 탐지는 LOB(기간 업무) 앱이 인증서/비밀을 업데이트하고 인증서 업데이트 후 며칠 이내에 최근에 본 적이 없거나 과거에 액세스한 적이 없고 비정상적인 활동이나 사용이 관찰된 비정상적인 위치에서 기계 학습 알고리즘을 사용하여 Graph API를 통해 앱에 액세스할 때 경고를 트리거합니다.

**TP일까요, FP일까요?**

- **TP**: 비정상적인 위치에서 Graph API를 통해 LOB 앱에 의해 비정상적인 활동/사용이 수행되었음을 확인할 수 있는 경우입니다.

    **권장 작업**: 일시적으로 앱을 사용하지 않도록 설정하고 암호를 다시 설정한 다음 앱을 다시 사용하도록 설정합니다.

- **FP**: LOB 앱이 합법적인 목적을 위해 비정상적인 위치에서 액세스했으며 비정상적인 활동이 수행되지 않았음을 확인할 수 있습니다.

    **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 이 앱에서 수행하는 모든 활동을 검토합니다.
1. 앱에서 승인한 범위를 검토합니다.
1. 이 앱과 연결된 사용자 활동을 검토합니다.

## <a name="collection-alerts"></a>컬렉션 경고

이 섹션에서는 악의적인 행위자가 조직에서 목적을 이루기 위한 관련 데이터를 수집하려는 시도를 나타내는 경고에 대해 설명합니다.

### <a name="app-made-anomalous-graph-calls-to-read-e-mail"></a>앱에서 전자 메일을 읽기 위해 비정상적인 그래프 호출을 수행함

**심각도**: 보통

**MITRE ID**: T1114

이 탐지는 LOB(Line of Business) OAuth 앱이 Graph API를 통해 비정상적이고 많은 양의 사용자 메일 폴더 및 메시지에 액세스하는 경우를 식별하며, 이는 조직의 보안 위반 시도를 나타낼 수 있습니다.

**TP일까요, FP일까요?**

- **TP**: LOB(Line of Business)가 비정상적인 그래프 활동을 수행했다는 사실을 확인할 수 있다면 TP(True Positive)를 표시합니다.

  **권장 작업**: 일시적으로 앱을 사용하지 않도록 설정하고 암호를 다시 설정한 다음 앱을 다시 사용하도록 설정합니다. Azure Active Directory를 사용하여 암호를 다시 설정하는 방법에 대한 자습서 지침을 따릅니다.

- **FP**: 앱이 비정상적으로 많은 양의 그래프 호출을 수행하는 게 정상이라는 사실을 확인할 수 있는 경우.

  **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 이 앱에서 수행한 이벤트에 대한 활동 로그를 검토하여 전자 메일을 읽고 사용자의 중요한 전자 메일 정보를 수집하려는 기타 그래프 활동을 이해합니다.
1. 앱에 추가되는 예기치 않은 자격 증명을 모니터링합니다.

### <a name="app-creates-inbox-rule-and-made-unusual-email-searches-activities"></a>앱이 받은 편지함 규칙을 만들고 비정상적인 전자 메일 검색 활동을 만들었습니다.

**심각도**: 보통

**MITRE ID**: T1137 , T1114  

이 감지 기능은 높은 권한 범위에 동의한 앱을 식별하고 의심스러운 받은 편지함 규칙을 생성하며 Graph API를 통해 사용자 메일 폴더에서 비정상적인 이메일 검색 활동을 수행합니다. 이는 Graph API를 통해 조직의 특정 이메일을 검색하고 수집하려는 공격자와 같은 조직의 위반 시도를 나타낼 수 있습니다.

**TP일까요, FP일까요?**

- **TP**: 권한 범위가 높은 OAuth 앱이 Graph API를 통해 수행한 특정 이메일 검색 및 수집을 확인할 수 있고 앱이 출처를 알 수 없는 경우입니다.

    **권장 작업**: 앱을 사용하지 않도록 설정 및 제거하고, 암호를 다시 설정하고, 받은 편지함 규칙을 제거합니다.

- **FP**: 앱이 Graph API를 통해 특정 이메일 검색 및 수집을 수행하고 합법적인 이유로 새 또는 개인 외부 이메일 계정에 대한 받은 편지함 규칙을 생성했음을 확인할 수 있는 경우입니다.

    **권장 작업**: 경고를 해제합니다.

**위반 범위 이해하기**

1. 앱에서 수행한 모든 활동을 검토합니다.
1. 앱에서 승인한 범위를 검토합니다.
1. 앱에서 만든 받은 편지함 규칙 작업을 검토합니다.
1. 앱에서 수행한 전자 메일 검색 활동을 검토합니다.

### <a name="appmade-onedrive--sharepoint-search-activities-and-created-inbox-rule"></a>앱에서 OneDrive/SharePoint 검색 활동을 만들고 받은 편지함 규칙을 생성함  

**심각도**: 보통

**MITRE ID:** T1137, T1213

이 감지 기능은 앱이 높은 권한 범위에 동의하고, 의심스러운 메일에 대해 받은 편지함 규칙을 만들며, Graph API를 통해 비정상적인 SharePoint 또는 OneDrive 검색 활동을 수행했음을 식별합니다. 이는 Graph API를 통해 조직의 SharePoint 또는 OneDrive에서 특정 데이터를 검색 및 수집하려는 공격자와 같은 조직의 침해 시도를 나타낼 수 있습니다.  

**TP일까요, FP일까요?**

- **TP**: 권한 범위가 높은 OAuth 앱이 Graph API를 통해 수행한 SharePoint 또는 OneDrive 검색 및 수집에서 특정 데이터를 확인할 수 있는 경우 및 알 수 없는 출처에서 앱이 제공되는 경우입니다.  

  **권장 작업**: 앱을 사용하지 않도록 설정하여 제거하고, 암호를 다시 설정하고, 받은 편지함 규칙을 제거합니다.  

- **FP**: 앱이 OAuth 앱을 통해 SharePoint 또는 OneDrive 검색 및 수집에서 특정 데이터를 수행하고, 적합한 이유로 새 전자 메일 또는 개인 외부 전자 메일 계정에 대한 받은 편지함 규칙을 생성했음을 확인할 수 있는 경우입니다.  

  **권장 작업**: 경고를 해제합니다.  

**위반 범위 이해하기**

1. 앱에서 수행한 모든 활동을 검토합니다.  
1. 앱에서 승인한 범위를 검토합니다.  
1. 앱에서 만든 받은 편지함 규칙 작업을 검토합니다.  
1. 앱에서 수행한 모든 SharePoint 또는 OneDrive 검색 활동을 검토합니다.

### <a name="app-made-high-volume-of-importance-mail-read-and-created-inbox-rule"></a>앱에서 많은 양의 중요도 메일을 읽고 받은 편지함 규칙을 만들었습니다.

**심각도**: 보통  

**MITRE ID**: T1137, T1114

이 탐지는 앱이 높은 권한 범위에 동의하고 의심스러운 받은 편지함 규칙을 만들고 Graph API를 통해 중요한 메일 읽기 작업을 대량으로 수행했음을 나타냅니다. 이는 공격자가 Graph API를 통해 조직의 중요도가 높은 전자 메일을 읽으려고 시도하는 것과 같은 조직 침해 시도가 있었음을 나타낼 수 있습니다.  

**TP일까요, FP일까요?**

- **TP**: 권한 범위가 높은 OAuth 앱에서 Graph API를 통해 읽은 중요한 전자 메일을 확인할 수 있고 해당 앱은 알 수 없는 소스로부터 배달됩니다.  

  **권장 작업**: 앱을 사용하지 않도록 설정하여 제거하고, 암호를 다시 설정하고, 받은 편지함 규칙을 제거합니다.  

- **FP**: 앱이 Graph API를 통해 중요한 전자 메일을 대량으로 읽고 합법적인 이유로 새 외부 전자 메일 계정 또는 개인 외부 전자 메일 계정에 대한 받은 편지함 규칙을 만든 것을 확인할 수 있는 경우입니다.  

  **권장 작업**: 경고를 해제합니다.  

**위반 범위 이해하기**

1. 앱에서 수행한 모든 활동을 검토합니다.  
1. 앱에서 승인한 범위를 검토합니다.  
1. 앱에서 만든 받은 편지함 규칙 작업을 검토합니다.  
1. 앱에서 수행하는 중요도가 높은 전자 메일 읽기 활동을 검토합니다.  
